/*
 1964js - JavaScript/HTML5 port of 1964 - N64 emulator
Copyright (C) 2012 Joel Middendorf

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
*/
(function(){("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsConstants=function(){this.MEMORY_START_PIF=532676608;this.MEMORY_START_PIF_RAM=532678592;this.MEMORY_SIZE_PIF=65536;this.INDEX=0;this.RANDOM=1;this.ENTRYLO0=2;this.ENTRYLO1=3;this.CONTEXT=4;this.PAGEMASK=5;this.WIRED=6;this.RESERVED0=7;this.BADVADDR=8;this.COUNT=9;this.ENTRYHI=10;this.COMPARE=11;this.STATUS=12;this.CAUSE=13;this.EPC=14;this.PREVID=15;this.CONFIG=16;this.LLADDR=17;this.WATCHLO=18;this.WATCHHI=19;this.XCONTEXT=
20;this.RESERVED1=21;this.RESERVED2=22;this.RESERVED3=23;this.RESERVED4=24;this.RESERVED5=25;this.PERR=26;this.CACHEERR=27;this.TAGLO=28;this.TAGHI=29;this.ERROREPC=30;this.RESERVED6=31;this.SP_DMEM_TASK=4032;this.SP_MEM_ADDR_REG=0;this.SP_DRAM_ADDR_REG=4;this.SP_RD_LEN_REG=8;this.SP_WR_LEN_REG=12;this.SP_STATUS_REG=16;this.SP_DMA_FULL_REG=20;this.SP_DMA_BUSY_REG=24;this.SP_SEMAPHORE_REG=28;this.SP_PC_REG=0;this.SP_IBIST_REG=4;this.VI_STATUS_REG=0;this.VI_ORIGIN_REG=4;this.VI_WIDTH_REG=8;this.VI_INTR_REG=
12;this.VI_CURRENT_REG=16;this.VI_BURST_REG=20;this.VI_V_SYNC_REG=24;this.VI_H_SYNC_REG=28;this.VI_LEAP_REG=32;this.VI_H_START_REG=36;this.VI_V_START_REG=40;this.VI_V_BURST_REG=44;this.VI_X_SCALE_REG=48;this.VI_Y_SCALE_REG=52;this.AI_DRAM_ADDR_REG=0;this.AI_LEN_REG=4;this.AI_CONTROL_REG=8;this.AI_STATUS_REG=12;this.AI_DACRATE_REG=16;this.AI_BITRATE_REG=20;this.PI_DRAM_ADDR_REG=0;this.PI_CART_ADDR_REG=4;this.PI_RD_LEN_REG=8;this.PI_WR_LEN_REG=12;this.PI_STATUS_REG=16;this.PI_BSD_DOM1_LAT_REG=20;this.PI_BSD_DOM1_PWD_REG=
24;this.PI_BSD_DOM1_PGS_REG=28;this.PI_BSD_DOM1_RLS_REG=32;this.PI_BSD_DOM2_LAT_REG=36;this.PI_BSD_DOM2_PWD_REG=40;this.PI_BSD_DOM2_PGS_REG=44;this.PI_BSD_DOM2_RLS_REG=48;this.RI_MODE_REG=0;this.RI_CONFIG_REG=4;this.RI_CURRENT_LOAD_REG=8;this.RI_SELECT_REG=12;this.RI_REFRESH_REG=16;this.RI_LATENCY_REG=20;this.RI_RERROR_REG=24;this.RI_WERROR_REG=28;this.MI_INIT_MODE_REG=0;this.MI_VERSION_REG=4;this.MI_INTR_REG=8;this.MI_INTR_MASK_REG=12;this.SI_DRAM_ADDR_REG=0;this.SI_PIF_ADDR_RD64B_REG=4;this.SI_PIF_ADDR_WR64B_REG=
16;this.SI_STATUS_REG=24;this.SI_STATUS_DMA_BUSY=1;this.SI_STATUS_RD_BUSY=2;this.SI_STATUS_DMA_ERROR=8;this.SI_STATUS_INTERRUPT=4096;this.AI_STATUS_FIFO_FULL=2147483648;this.AI_STATUS_DMA_BUSY=1073741824;this.PI_STATUS_RESET=1;this.PI_STATUS_CLR_INTR=2;this.PI_STATUS_ERROR=4;this.PI_STATUS_IO_BUSY=2;this.MI_INTR_SP=this.PI_STATUS_DMA_BUSY=1;this.MI_INTR_SI=2;this.MI_INTR_AI=4;this.MI_INTR_VI=8;this.MI_INTR_PI=16;this.MI_INTR_DP=32;this.MI_INTR_MASK_SP=1;this.MI_INTR_MASK_SI=2;this.MI_INTR_MASK_AI=
4;this.MI_INTR_MASK_VI=8;this.MI_INTR_MASK_PI=16;this.MI_INTR_MASK_DP=32;this.MI_INTR_MASK_SP_CLR=1;this.MI_INTR_MASK_SP_SET=2;this.MI_INTR_MASK_SI_CLR=4;this.MI_INTR_MASK_SI_SET=8;this.MI_INTR_MASK_AI_CLR=16;this.MI_INTR_MASK_AI_SET=32;this.MI_INTR_MASK_VI_CLR=64;this.MI_INTR_MASK_VI_SET=128;this.MI_INTR_MASK_PI_CLR=256;this.MI_INTR_MASK_PI_SET=512;this.MI_INTR_MASK_DP_CLR=1024;this.MI_INTR_MASK_DP_SET=2048;this.MI_MODE_INIT=128;this.MI_MODE_EBUS=256;this.MI_MODE_RDRAM=512;this.MI_CLR_INIT=128;this.MI_SET_INIT=
256;this.MI_CLR_EBUS=512;this.MI_SET_EBUS=1024;this.MI_CLR_DP_INTR=2048;this.MI_CLR_RDRAM=4096;this.MI_SET_RDRAM=8192;this.DPC_START_REG=0;this.DPC_END_REG=4;this.DPC_CURRENT_REG=8;this.DPC_STATUS_REG=12;this.DPC_CLOCK_REG=16;this.DPC_BUFBUSY_REG=20;this.DPC_PIPEBUSY_REG=24;this.DPC_TMEM_REG=28;this.SP_STATUS_HALT=1;this.SP_STATUS_BROKE=2;this.SP_STATUS_DMA_BUSY=4;this.SP_STATUS_DMA_FULL=8;this.SP_STATUS_IO_FULL=16;this.SP_STATUS_SSTEP=32;this.SP_STATUS_INTR_BREAK=64;this.SP_STATUS_YIELD=128;this.SP_STATUS_YIELDED=
256;this.SP_STATUS_TASKDONE=512;this.SP_STATUS_SIG3=1024;this.SP_STATUS_SIG4=2048;this.SP_STATUS_SIG5=4096;this.SP_STATUS_SIG6=8192;this.SP_STATUS_SIG7=16384;this.DPC_STATUS_XBUS_DMEM_DMA=1;this.DPC_STATUS_FREEZE=2;this.DPC_STATUS_FLUSH=4;this.DPC_STATUS_START_GCLK=8;this.DPC_STATUS_TMEM_BUSY=16;this.DPC_STATUS_PIPE_BUSY=32;this.DPC_STATUS_CMD_BUSY=64;this.DPC_STATUS_CBUF_READY=128;this.DPC_STATUS_DMA_BUSY=256;this.DPC_STATUS_END_VALID=512;this.DPC_STATUS_START_VALID=1024;this.DPC_CLR_XBUS_DMEM_DMA=
1;this.DPC_SET_XBUS_DMEM_DMA=2;this.DPC_CLR_FREEZE=4;this.DPC_SET_FREEZE=8;this.DPC_CLR_FLUSH=16;this.DPC_SET_FLUSH=32;this.DPC_CLR_TMEM_REG=64;this.DPC_CLR_PIPEBUSY_REG=128;this.DPC_CLR_BUFBUSY_REG=256;this.DPC_CLR_CLOCK_REG=512;this.IE=1;this.EXL=2;this.ERL=4;this.BD=2147483648;this.BEV=4194304;this.EXC_INT=0;this.EXC_MOD=4;this.TLBL_Miss=this.EXC_RMISS=8;this.TLBS_Miss=this.EXC_WMISS=12;this.EXC_RADE=16;this.EXC_WADE=20;this.EXC_IBE=24;this.EXC_DBE=28;this.EXC_SYSCALL=32;this.EXC_BREAK=36;this.EXC_II=
40;this.EXC_CPU=44;this.EXC_OV=48;this.EXC_TRAP=52;this.EXC_VCEI=56;this.EXC_FPE=60;this.EXC_WATCH=92;this.EXC_VCED=124;this.CAUSE_IP8=32768;this.CAUSE_IP7=16384;this.CAUSE_IP6=8192;this.CAUSE_IP5=4096;this.CAUSE_IP4=2048;this.CAUSE_IP3=1024;this.CAUSE_SW2=512;this.CAUSE_SW1=256;this.CAUSE_BD=2147483648;this.COP1_CONDITION_BIT=8388608;this.NTLBENTRIES=31;this.TLBHI_VPN2MASK=4294959104;this.TLBHI_VPN2SHIFT=13;this.TLBHI_PIDMASK=255;this.TLBHI_PIDSHIFT=0;this.TLBHI_NPID=255;this.TLBLO_PFNMASK=1073741760;
this.TLBLO_PFNSHIFT=6;this.TLBLO_CACHMASK=56;this.TLBLO_CACHSHIFT=3;this.TLBLO_UNCACHED=16;this.TLBLO_NONCOHRNT=24;this.TLBLO_EXLWR=40;this.TLBLO_D=4;this.TLBLO_V=2;this.TLBLO_G=1;this.TLBINX_PROBE=2147483648;this.TLBINX_INXMASK=63;this.TLBINX_INXSHIFT=0;this.TLBRAND_RANDMASK=63;this.TLBRAND_RANDSHIFT=0;this.TLBWIRED_WIREDMASK=63;this.TLBCTXT_BASEMASK=4286578688;this.TLBCTXT_BASESHIFT=23;this.TLBCTXT_BASEBITS=9;this.TLBCTXT_VPNMASK=8388592;this.TLBCTXT_VPNSHIFT=4;this.TLBPGMASK_4K=0;this.TLBPGMASK_16K=
24576;this.TLBPGMASK_64K=122880;this.BAD_TASK=0;this.GFX_TASK=1;this.SND_TASK=2;this.JPG_TASK=4;this.TASK_TYPE=4032;this.TASK_FLAGS=4036;this.TASK_MICROCODE_BOOT=4040;this.TASK_MICROCODE_BOOT_SIZE=4044;this.TASK_MICROCODE=4048;this.TASK_MICROCODE_SIZE=4052;this.TASK_MICROCODE_DATA=4056;this.TASK_MICROCODE_DATA_SIZE=4060;this.TASK_DRAM_STACK=4064;this.TASK_DRAM_STACK_SIZE=4068;this.TASK_OUTPUT_BUFF=4072;this.TASK_OUTPUT_BUFF_SIZE=4076;this.TASK_DATA_PTR=4080;this.TASK_DATA_SIZE=4084;this.TASK_YIELD_DATA_PTR=
4088;this.TASK_YIELD_DATA_SIZE=4092;this.MAX_DL_STACK_SIZE=32;this.MAX_DL_COUNT=1E6;this.MAX_VERTS=80;this.RSP_SPNOOP=0;this.RSP_MTX=1;this.RSP_RESERVED0=2;this.RSP_MOVEMEM=3;this.RSP_VTX=4;this.RSP_RESERVED1=5;this.RSP_DL=6;this.RSP_RESERVED2=7;this.RSP_RESERVED3=8;this.RSP_SPRITE2D_BASE=this.RSP_SPRITE2D=9;this.RSP_TRI1=this.RSP_1ST=191;this.RSP_CULLDL=this.RSP_1ST-1;this.RSP_POPMTX=this.RSP_1ST-2;this.RSP_MOVEWORD=this.RSP_1ST-3;this.RSP_TEXTURE=this.RSP_1ST-4;this.RSP_SETOTHERMODE_H=this.RSP_1ST-
5;this.RSP_SETOTHERMODE_L=this.RSP_1ST-6;this.RSP_ENDDL=this.RSP_1ST-7;this.RSP_SETGEOMETRYMODE=this.RSP_1ST-8;this.RSP_CLEARGEOMETRYMODE=this.RSP_1ST-9;this.RSP_LINE3D=this.RSP_1ST-10;this.RSP_RDPHALF_1=this.RSP_1ST-11;this.RSP_RDPHALF_2=this.RSP_1ST-12;this.RSP_RDPHALF_CONT=this.RSP_1ST-13;this.RSP_MODIFYVTX=this.RSP_1ST-13;this.RSP_TRI2=this.RSP_1ST-14;this.RSP_BRANCH_Z=this.RSP_1ST-15;this.RSP_LOAD_UCODE=this.RSP_1ST-16;this.RSP_SPRITE2D_SCALEFLIP=this.RSP_1ST-1;this.RSP_SPRITE2D_DRAW=this.RSP_1ST-
2;this.RSP_ZELDAVTX=1;this.RSP_ZELDAMODIFYVTX=2;this.RSP_ZELDACULLDL=3;this.RSP_ZELDABRANCHZ=4;this.RSP_ZELDATRI1=5;this.RSP_ZELDATRI2=6;this.RSP_ZELDALINE3D=7;this.RSP_ZELDARDPHALF_2=241;this.RSP_ZELDASETOTHERMODE_H=227;this.RSP_ZELDASETOTHERMODE_L=226;this.RSP_ZELDARDPHALF_1=225;this.RSP_ZELDASPNOOP=224;this.RSP_ZELDAENDDL=223;this.RSP_ZELDADL=222;this.RSP_ZELDALOAD_UCODE=221;this.RSP_ZELDAMOVEMEM=220;this.RSP_ZELDAMOVEWORD=219;this.RSP_ZELDAMTX=218;this.RSP_ZELDAGEOMETRYMODE=217;this.RSP_ZELDAPOPMTX=
216;this.RSP_ZELDATEXTURE=215;this.RSP_ZELDASUBMODULE=214;this.RSP_DMATRI=5;this.G_DLINMEM=7;this.RDP_NOOP=192;this.RDP_SETCIMG=255;this.RDP_SETZIMG=254;this.RDP_SETTIMG=253;this.RDP_SETCOMBINE=252;this.RDP_SETENVCOLOR=251;this.RDP_SETPRIMCOLOR=250;this.RDP_SETBLENDCOLOR=249;this.RDP_SETFOGCOLOR=248;this.RDP_SETFILLCOLOR=247;this.RDP_FILLRECT=246;this.RDP_SETTILE=245;this.RDP_LOADTILE=244;this.RDP_LOADBLOCK=243;this.RDP_SETTILESIZE=242;this.RDP_LOADTLUT=240;this.RDP_RDPSETOTHERMODE=239;this.RDP_SETPRIMDEPTH=
238;this.RDP_SETSCISSOR=237;this.RDP_SETCONVERT=236;this.RDP_SETKEYR=235;this.RDP_SETKEYGB=234;this.RDP_FULLSYNC=233;this.RDP_TILESYNC=232;this.RDP_PIPESYNC=231;this.RDP_LOADSYNC=230;this.RDP_TEXRECT_FLIP=229;this.RDP_TEXRECT=228;this.RSP_ZELDA_MTX_MODELVIEW=0;this.RSP_ZELDA_MTX_PROJECTION=4;this.RSP_ZELDA_MTX_MUL=0;this.RSP_ZELDA_MTX_LOAD=2;this.RSP_ZELDA_MTX_PUSH=0;this.RSP_ZELDA_MTX_NOPUSH=1;this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE=0;this.RSP_SETOTHERMODE_SHIFT_ZSRCSEL=2;this.RSP_SETOTHERMODE_SHIFT_RENDERMODE=
3;this.RSP_SETOTHERMODE_SHIFT_BLENDER=16;this.RSP_SETOTHERMODE_SHIFT_BLENDMASK=0;this.RSP_SETOTHERMODE_SHIFT_ALPHADITHER=4;this.RSP_SETOTHERMODE_SHIFT_RGBDITHER=6;this.RSP_SETOTHERMODE_SHIFT_COMBKEY=8;this.RSP_SETOTHERMODE_SHIFT_TEXTCONV=9;this.RSP_SETOTHERMODE_SHIFT_TEXTFILT=12;this.RSP_SETOTHERMODE_SHIFT_TEXTLUT=14;this.RSP_SETOTHERMODE_SHIFT_TEXTLOD=16;this.RSP_SETOTHERMODE_SHIFT_TEXTDETAIL=17;this.RSP_SETOTHERMODE_SHIFT_TEXTPERSP=19;this.RSP_SETOTHERMODE_SHIFT_CYCLETYPE=20;this.RSP_SETOTHERMODE_SHIFT_COLORDITHER=
22;this.RSP_SETOTHERMODE_SHIFT_PIPELINE=23;this.RSP_PIPELINE_MODE_1PRIMITIVE=1<<this.RSP_SETOTHERMODE_SHIFT_PIPELINE;this.RSP_PIPELINE_MODE_NPRIMITIVE=0<<this.RSP_SETOTHERMODE_SHIFT_PIPELINE;this.CYCLE_TYPE_1=0;this.CYCLE_TYPE_2=1;this.CYCLE_TYPE_COPY=2;this.CYCLE_TYPE_FILL=3;this.TLUT_FMT_NONE=0<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;this.TLUT_FMT_UNKNOWN=1<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;this.TLUT_FMT_RGBA16=2<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;this.TLUT_FMT_IA16=3<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;
this.RDP_TFILTER_POINT=0<<this.RSP_SETOTHERMODE_SHIFT_TEXTFILT;this.RDP_TFILTER_AVERAGE=3<<this.RSP_SETOTHERMODE_SHIFT_TEXTFILT;this.RDP_TFILTER_BILERP=2<<this.RSP_SETOTHERMODE_SHIFT_TEXTFILT;this.RDP_ALPHA_COMPARE_NONE=0<<this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE;this.RDP_ALPHA_COMPARE_THRESHOLD=1<<this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE;this.RDP_ALPHA_COMPARE_DITHER=3<<this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE;this.Z_COMPARE=16;this.Z_UPDATE=32;this.ZMODE_DEC=3072;this.G_ZBUFFER=1;this.G_TEXTURE_ENABLE=
2;this.G_SHADE=4;this.G_SHADING_SMOOTH=512;this.G_CULL_FRONT=4096;this.G_CULL_BACK=8192;this.G_CULL_BOTH=12288;this.G_FOG=65536;this.G_LIGHTING=131072;this.G_TEXTURE_GEN=262144;this.G_TEXTURE_GEN_LINEAR=524288;this.G_LOD=1048576;this.TXT_FMT_RGBA=0;this.TXT_FMT_YUV=1;this.TXT_FMT_CI=2;this.TXT_FMT_IA=3;this.TXT_FMT_I=4;this.TXT_SIZE_4b=0;this.TXT_SIZE_8b=1;this.TXT_SIZE_16b=2;this.TXT_SIZE_32b=3;this.RDP_TXT_LOADTILE=7;this.RDP_TXT_WRAP=this.RDP_TXT_NOMIRROR=this.RDP_TXT_RENDERTILE=0;this.RDP_TXT_MIRROR=
1;this.RDP_TXT_CLAMP=2;this.RDP_TXT_NOLOD=this.RDP_TXT_NOMASK=0;this.RSP_GBI1_MV_MEM_VIEWPORT=128;this.RSP_GBI1_MV_MEM_LOOKATY=130;this.RSP_GBI1_MV_MEM_LOOKATX=132;this.RSP_GBI1_MV_MEM_L0=134;this.RSP_GBI1_MV_MEM_L1=136;this.RSP_GBI1_MV_MEM_L2=138;this.RSP_GBI1_MV_MEM_L3=140;this.RSP_GBI1_MV_MEM_L4=142;this.RSP_GBI1_MV_MEM_L5=144;this.RSP_GBI1_MV_MEM_L6=146;this.RSP_GBI1_MV_MEM_L7=148;this.RSP_GBI1_MV_MEM_TXTATT=150;this.RSP_GBI1_MV_MEM_MATRIX_1=158;this.RSP_GBI1_MV_MEM_MATRIX_2=152;this.RSP_GBI1_MV_MEM_MATRIX_3=
154;this.RSP_GBI1_MV_MEM_MATRIX_4=156;this.RSP_GBI2_MV_MEM__VIEWPORT=8;this.RSP_GBI2_MV_MEM__LIGHT=10;this.RSP_GBI2_MV_MEM__POINT=12;this.RSP_GBI2_MV_MEM__MATRIX=14;this.RSP_GBI2_MV_MEM_O_LOOKATX=0;this.RSP_GBI2_MV_MEM_O_LOOKATY=24;this.RSP_GBI2_MV_MEM_O_L0=48;this.RSP_GBI2_MV_MEM_O_L1=72;this.RSP_GBI2_MV_MEM_O_L2=96;this.RSP_GBI2_MV_MEM_O_L3=120;this.RSP_GBI2_MV_MEM_O_L4=144;this.RSP_GBI2_MV_MEM_O_L5=168;this.RSP_GBI2_MV_MEM_O_L6=192;this.RSP_GBI2_MV_MEM_O_L7=216;this.RSP_MOVE_WORD_MATRIX=0;this.RSP_MOVE_WORD_NUMLIGHT=
2;this.RSP_MOVE_WORD_CLIP=4;this.RSP_MOVE_WORD_SEGMENT=6;this.RSP_MOVE_WORD_FOG=8;this.RSP_MOVE_WORD_LIGHTCOL=10;this.RSP_MOVE_WORD_POINTS=12;this.RSP_MOVE_WORD_PERSPNORM=14;this.RSP_MV_WORD_OFFSET_NUMLIGHT=0;this.RSP_MV_WORD_OFFSET_CLIP_RNX=4;this.RSP_MV_WORD_OFFSET_CLIP_RNY=12;this.RSP_MV_WORD_OFFSET_CLIP_RPX=20;this.RSP_MV_WORD_OFFSET_CLIP_RPY=28;this.RSP_MV_WORD_OFFSET_FOG=0;this.RSP_MV_WORD_OFFSET_POINT_RGBA=16;this.RSP_MV_WORD_OFFSET_POINT_ST=20;this.RSP_MV_WORD_OFFSET_POINT_XYSCREEN=24;this.RSP_MV_WORD_OFFSET_POINT_ZSCREEN=
28;this.RSP_DLIST_PUSH=0;this.RSP_DLIST_NOPUSH=1}}).call(this);function _BigInt_toString(){return this.toStringBase(10)}
function _BigInt_toStringBase(a){var b,d,c,e,g;b=this.len;if(0==b||1==b&&!this.digits[0])return"0";switch(a){default:case 10:d=Math.floor(3856*b/800)+2;c=1E4;break;case 16:d=Math.floor(16*b/4)+2;c=65536;break;case 8:d=16*b+2;c=4096;break;case 2:d=16*b+2,c=16}e=this.clone().digits;for(s="";b&&d;){for(var f=b,h=0;f--;)h=(h<<16)+e[f],0>h&&(h+=4294967296),e[f]=Math.floor(h/c),h%=c;0==e[b-1]&&b--;for(f=4;f--&&!(g=h%a,s="0123456789abcdef".charAt(g)+s,--d,h=Math.floor(h/a),0==b&&0==h););}for(b=0;b<s.length&&
"0"==s.charAt(b);)b++;b&&(s=s.substring(b,s.length));this.sign||(s="-"+s);return s}function _BigInt_clone(){var a,b;a=new BigInt(this.len,this.sign);for(b=0;b<this.len;b++)a.digits[b]=this.digits[b];return a}
function BigInt(a,b){var d;this.toString=_BigInt_toString;this.toStringBase=_BigInt_toStringBase;this.clone=_BigInt_clone;0==BigInt.arguments.length?(this.sign=!0,this.len=a=1,this.digits=Array(1),d=!0):1==BigInt.arguments.length?(d=bigint_from_any(BigInt.arguments[0]),d==BigInt.arguments[0]&&(d=d.clone()),this.sign=d.sign,this.len=d.len,this.digits=d.digits,d=!1):(this.sign=b?!0:!1,this.len=a,this.digits=Array(a),d=!0);if(d)for(d=0;d<a;d++)this.digits[d]=0}
function bigint_norm(a){for(var b=a.len,d=a.digits;b--&&!d[b];);a.len=++b;return a}function bigint_from_int(a){var b;0>a&&(a=-a);a&=2147483647;65535>=a?(b=new BigInt(1,1),b.digits[0]=a):(b=new BigInt(2,1),b.digits[0]=a&65535,b.digits[1]=a>>16&65535);return b}
function bigint_from_string(a,b){var d,c=!0,e,g,f,h=1,a=a+"@";d=0;"+"==a.charAt(d)?d++:"-"==a.charAt(d)&&(d++,c=!1);if("@"==a.charAt(d))return null;b||("0"==a.charAt(d)?(e=a.charAt(d+1),b="x"==e||"X"==e?16:"b"==e||"B"==e?2:8):b=10);if(8==b){for(;"0"==a.charAt(d);)d++;e=3*(a.length-d)}else{if(16==b&&"0"==a.charAt(d)&&("x"==a.charAt(d+1)||"X"==a.charAt(d+1)))d+=2;if(2==b&&"0"==a.charAt(d)&&("b"==a.charAt(d+1)||"B"==a.charAt(d+1)))d+=2;for(;"0"==a.charAt(d);)d++;"@"==a.charAt(d)&&d--;e=4*(a.length-d)}c=
new BigInt((e>>4)+1,c);for(g=c.digits;;){e=a.charAt(d++);if("@"==e)break;switch(e){case "0":e=0;break;case "1":e=1;break;case "2":e=2;break;case "3":e=3;break;case "4":e=4;break;case "5":e=5;break;case "6":e=6;break;case "7":e=7;break;case "8":e=8;break;case "9":e=9;break;case "a":case "A":e=10;break;case "b":case "B":e=11;break;case "c":case "C":e=12;break;case "d":case "D":e=13;break;case "e":case "E":e=14;break;case "f":case "F":e=15;break;default:e=b}if(e>=b)break;for(f=0;;){for(;f<h;)e+=g[f]*
b,g[f++]=e&65535,e>>>=16;if(e)h++;else break}}return bigint_norm(c)}
function bigint_from_any(a){if("object"==typeof a)return a.constructor==BigInt?a:BigInt(1,1);if("string"==typeof a)return bigint_from_string(a);if("number"==typeof a){var b,d,c;if(-2147483647<=a&&2147483647>=a)return bigint_from_int(a);a+="";b=a.indexOf("e",0);if(-1==b)return bigint_from_string(a);d=a.substr(0,b);a=a.substr(b+2,a.length-(b+2));b=d.indexOf(".",0);-1!=b?(c=d.length-(b+1),d=d.substr(0,b)+d.substr(b+1,c),a=parseInt(a)-c):a=parseInt(a);for(;0<a--;)d+="0";return bigint_from_string(d)}return BigInt(1,
1)}function bigint_uminus(a){a=a.clone();a.sign=!a.sign;return bigint_norm(a)}function bigint_add_internal(a,b,d){var c,e,g,d=d==b.sign;if(a.sign!=d)return d?bigint_sub_internal(b,a):bigint_sub_internal(a,b);a.len>b.len?(g=a.len+1,c=a,a=b,b=c):g=b.len+1;c=new BigInt(g,d);g=a.len;for(d=e=0;e<g;e++)d+=a.digits[e]+b.digits[e],c.digits[e]=d&65535,d>>>=16;for(g=b.len;d&&e<g;)d+=b.digits[e],c.digits[e++]=d&65535,d>>>=16;for(;e<g;)c.digits[e]=b.digits[e],e++;c.digits[e]=d&65535;return bigint_norm(c)}
function bigint_sub_internal(a,b){var d=0,c,e,g;g=a.len;if(a.len<b.len)d=a,a=b,b=d;else if(a.len==b.len)for(;0<g;){g--;if(a.digits[g]>b.digits[g])break;if(a.digits[g]<b.digits[g]){d=a;a=b;b=d;break}}d=new BigInt(a.len,0==d?1:0);c=d.digits;for(e=g=0;g<b.len;g++)e+=a.digits[g]-b.digits[g],c[g]=e&65535,e>>>=16;for(;e&&g<a.len;)e+=a.digits[g],c[g++]=e&65535,e>>>=16;for(;g<a.len;)c[g]=a.digits[g],g++;return bigint_norm(d)}
function bigint_plus(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_add_internal(a,b,1)}function bigint_minus(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_add_internal(a,b,0)}
function bigint_mul(a,b){var d,c,e=0,g,f,h,i,k,j,l,a=bigint_from_any(a),b=bigint_from_any(b);c=a.len+b.len+1;g=new BigInt(c,a.sign==b.sign);h=a.digits;i=b.digits;f=g.digits;for(l=b.len;c--;)f[c]=0;for(d=0;d<a.len;d++)if(k=h[d],0!=k){for(c=e=0;c<l;c++)j=e+k*i[c],e=f[d+c]+j,j&&(f[d+c]=e&65535),e>>>=16;e&&(f[d+c]=e)}return bigint_norm(g)}
function bigint_divmod(a,b,d){var c=a.len,e=b.len,g,f,h,i,k,j,l,m,n,p;i=b.digits;if(0==e&&0==i[0])return null;if(c<e||c==e&&a.digits[c-1]<b.digits[e-1])return d?bigint_norm(a):BigInt(1,1);g=a.digits;if(1==e){m=i[0];h=a.clone();k=h.digits;j=0;for(g=c;g--;)j=65536*j+k[g],k[g]=j/m&65535,j%=m;h.sign=a.sign==b.sign;return d?(a.sign||(j=-j),a.sign!=b.sign&&(j+=i[0]*(b.sign?1:-1)),bigint_from_int(j)):bigint_norm(h)}h=new BigInt(c==e?c+2:c+1,a.sign==b.sign);k=h.digits;for(c==e&&(k[c+1]=0);!i[e-1];)e--;if(1!=
(m=65536/(i[e-1]+1)&65535)){f=b.clone();j=f.digits;for(l=f=0;f<e;)l+=i[f]*m,j[f++]=l&65535,l>>=16;i=j;for(l=f=0;f<c;)l+=g[f]*m,k[f++]=l&65535,l>>=16;k[f]=l&65535}else{k[c]=0;for(f=c;f--;)k[f]=g[f]}f=c==e?c+1:c;do{if(n=k[f]==i[e-1]?65535:(65536*k[f]+k[f-1])/i[e-1]&65535){j=l=g=0;do j+=i[g]*n,p=l-(j&65535),l=k[f-e+g]+p,p&&(k[f-e+g]=l&65535),l>>=16,j>>>=16;while(++g<e);for(l+=k[f-e+g]-j;l;){l=g=0;n--;do p=l+i[g],l=k[f-e+g]+p,p&&(k[f-e+g]=l&65535),l>>=16;while(++g<e);l--}}k[f]=n}while(--f>=e);if(d){c=
h.clone();if(m){k=c.digits;j=0;for(g=e;g--;)j=65536*j+k[g],k[g]=j/m&65535,j%=m}c.len=e;c.sign=a.sign;return a.sign!=b.sign?bigint_add_internal(c,b,1):bigint_norm(c)}a=h.clone();k=a.digits;f=(c==e?c+2:c+1)-e;for(g=0;g<f;g++)k[g]=k[g+e];a.len=g;return bigint_norm(a)}function bigint_div(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_divmod(a,b,0)}function bigint_mod(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_divmod(a,b,1)}
function bigint_cmp(a,b){var d;if(a==b)return 0;a=bigint_from_any(a);b=bigint_from_any(b);d=a.len;if(a.sign!=b.sign)return a.sign?1:-1;if(d<b.len)return a.sign?-1:1;if(d>b.len)return a.sign?1:-1;for(;d--&&a.digits[d]==b.digits[d];);return-1==d?0:a.digits[d]>b.digits[d]?a.sign?1:-1:a.sign?-1:1}function bigint_number(a){for(var b=0,d=a.len,c=a.digits;d--;)b=c[d]+65536*b;a.sign||(b=-b);return b};var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,b,d){a=a.split(".");d=d||goog.global;!(a[0]in d)&&d.execScript&&d.execScript("var "+a[0]);for(var c;a.length&&(c=a.shift());)!a.length&&goog.isDef(b)?d[c]=b:d=d[c]?d[c]:d[c]={}};goog.getObjectByName=function(a,b){for(var d=a.split("."),c=b||goog.global,e;e=d.shift();)if(goog.isDefAndNotNull(c[e]))c=c[e];else return null;return c};
goog.globalize=function(a,b){var d=b||goog.global,c;for(c in a)d[c]=a[c]};goog.addDependency=function(a,b,d){if(!COMPILED){for(var c,a=a.replace(/\\/g,"/"),e=goog.dependencies_,g=0;c=b[g];g++)e.nameToPath[c]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][c]=!0;for(c=0;b=d[c];c++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var d=a[b].src,c=d.lastIndexOf("?"),c=
-1==c?d.length:c;if("base.js"==d.substr(c-7,7)){goog.basePath=d.substr(0,c-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){return goog.inHtmlDocument_()?(goog.global.document.write('<script type="text/javascript" src="'+a+'"><\/script>'),!0):!1},goog.writeScripts_=function(){function a(g){if(!(g in c.written)){if(!(g in c.visited)&&(c.visited[g]=
!0,g in c.requires))for(var e in c.requires[g])if(!goog.isProvided_(e))if(e in c.nameToPath)a(c.nameToPath[e]);else throw Error("Undefined nameToPath for "+e);g in d||(d[g]=!0,b.push(g))}}var b=[],d={},c=goog.dependencies_,e;for(e in goog.included_)c.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),
goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var d=Object.prototype.toString.call(a);if("[object Window]"==d)return"object";if("[object Array]"==d||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==d||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},d;for(d in a)b[d]=goog.cloneObject(a[d]);return b}return a};goog.bindNative_=function(a,b,d){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,d){if(!a)throw Error();if(2<arguments.length){var c=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(d,c);return a.apply(b,d)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,d){goog.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bindNative_:goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var d=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,d);return a.apply(this,b)}};goog.mixin=function(a,b){for(var d in b)a[d]=b[d]};goog.now=Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,d=b.createElement("script");d.type="text/javascript";d.defer=!1;d.appendChild(b.createTextNode(a));b.body.appendChild(d);
b.body.removeChild(d)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var d=function(b){return goog.cssNameMapping_[b]||b},c=function(b){for(var b=b.split("-"),a=[],c=0;c<b.length;c++)a.push(d(b[c]));return a.join("-")},c=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?d:c:function(b){return b};return b?a+"-"+c(b):c(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var d=b||{},c;for(c in d)var e=(""+d[c]).replace(/\$/g,"$$$$"),a=a.replace(RegExp("\\{\\$"+c+"\\}","gi"),e);return a};goog.exportSymbol=function(a,b,d){goog.exportPath_(a,b,d)};goog.exportProperty=function(a,b,d){a[b]=d};goog.inherits=function(a,b){function d(){}d.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new d;a.prototype.constructor=a};
goog.base=function(a,b,d){var c=arguments.callee.caller;if(c.superClass_)return c.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),g=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===c)g=!0;else if(g)return f.prototype[b].apply(a,e);if(a[b]===c)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};
goog.scope=function(a){a.call(goog.global)};(function(){var a,b,d,c;b=new C1964jsConstants;d=void 0;a=function(){function a(b){this.settings=b;this.request=void 0;this.debug=!1;this.writeToDom=!0;this.code=!0===this.writeToDom?window:{};this.vAddr=new Int32Array(1);this.cp0=new Int32Array(32);this.cp1Buffer=new ArrayBuffer(128);this.cp1_i=new Int32Array(this.cp1Buffer);this.cp1_f=new Float32Array(this.cp1Buffer);this.cp1_f64=new Float64Array(this.cp1Buffer);this.cp1Con=new Int32Array(32);this.LLbit=0;this.terminate=!1;this.NUM_CHANNELS=1;this.SAMPLE_RATE=
this.NUM_SAMPLES=4E4;this.interval=this.isBigEndian=this.isLittleEndian=0;this.m=-125E3;this.forceRepaint=!1;this.kk=this.doOnce=0;this.TV_SYSTEM_NTSC=1;this.currentHack=this.TV_SYSTEM_PAL=0;this.kfi=32E5;this.cnt=0;this.r=new Int32Array([0,0,3513981929,3513981929,7145,4099027429,2751471372,2751471368,112,0,64,2751463488,3509783491,3509783491,627128870,782254871,0,0,0,0,0,0,0,6,0,3611240851,0,0,0,2751471600,0,2751468884,0,0,0]);this.h=new Int32Array(35);this.memory=new C1964jsMemory(this);this.interrupts=
new C1964jsInterrupts(this,this.cp0);this.pif=new C1964jsPif(this.memory.pifUint8Array);this.dma=new C1964jsDMA(this.memory,this.interrupts,this.pif);this.webGL=new C1964jsWebGL(this,b.wireframe);this.log=function(b){return console.log(b)}}a.prototype.callBind=function(b,a){return function(){return b.call(a)}};a.prototype.init=function(a){var c,d;this.endianTest();this.helpers=new C1964jsHelpers(this,this.isLittleEndian);this.initTLB();cancelAnimFrame(this.request);this.currentHack=0;this.dma.startTime=
0;this.kfi=512;this.interval=this.doOnce=0;this.m=-125E3;this.flushDynaCache();this.showFB=!0;this.webGL.hide3D();this.memory.rom=a;this.memory.romUint8Array=a;this.docElement=document.getElementById("screen");this.errorElement=document.getElementById("error");this.c=document.getElementById("Canvas");this.ctx=this.c.getContext("2d");this.ImDat=this.ctx.createImageData(320,240);a=3;for(d=0;240>d;){for(c=0;320>c;)this.ImDat.data[a]=255,a+=4,c+=1;d+=1}this.stopCompiling=!1;this.byteSwap(this.memory.rom);
for(a=0;4096>a;)this.memory.spMemUint8Array[a]=this.memory.rom[a],a+=1;this.r[20]=this.getTVSystem(this.memory.romUint8Array[61]);this.r[22]=this.getCIC();this.cp0[b.STATUS]=1883242500;this.cp0[b.RANDOM]=31;this.cp0[b.CONFIG]=451683;this.cp0[b.PREVID]=2816;this.cp1Con[0]=1297;this.p=2751463488;this.memory.setInt32(this.memory.miUint8Array,b.MI_VERSION_REG,16843009);this.memory.setInt32(this.memory.riUint8Array,b.RI_CONFIG_REG,1);this.memory.setInt32(this.memory.viUint8Array,b.VI_INTR_REG,1023);this.memory.setInt32(this.memory.viUint8Array,
b.VI_V_SYNC_REG,209);this.memory.setInt32(this.memory.viUint8Array,b.VI_H_SYNC_REG,860231);for(a=0;35>a;)this.h[a]=this.r[a]>>31,a+=1;this.startEmulator()};a.prototype.byteSwap=function(b){var a,c;console.log("byte swapping...");a=this.memory.getUint32(b,0);switch(a>>>0){case 931151890:0!==b.byteLength%2&&alert("help: support odd byte lengths for this swap");for(a=0;a<b.byteLength;)c=b[a],b[a]=b[a+1],b[a+1]=c,a+=2;break;case 2151092800:break;default:this.log("Unhandled byte order: 0x"+dec2hex(a))}console.log("swap done")};
a.prototype.endianTest=function(){var b,a;b=new ArrayBuffer(2);a=new Uint8Array(b);b=new Uint16Array(b);a[0]=255;a[1]=17;4607===b[0]?(this.log("You are on a little-endian system"),this.isLittleEndian=1,this.isBigEndian=0):(this.log("You are on a big-endian system"),this.isLittleEndian=0,this.isBigEndian=1)};a.prototype.repaint=function(b,a,c){var d,e,j,l,m;e=c;d=0;if(this.showFB){l=a.data;for(m=-76800;0!==m;)c=this.memory.rdramUint8Array[e],j=this.memory.rdramUint8Array[e+1],l[d]=c&248,l[d+1]=(c<<
5|j>>>3)&248,l[d+2]=j<<2&248,c=this.memory.rdramUint8Array[e+2],j=this.memory.rdramUint8Array[e+3],l[d+4]=c&248,l[d+5]=(c<<5|j>>>3)&248,l[d+6]=j<<2&248,e+=4,d+=8,m+=2;b.putImageData(a,0,0)}};a.prototype.initTLB=function(){var b;this.tlb=Array(32);for(b=0;32>b;)this.tlb[b]={valid:!1,entryHi:new Int32Array(1),entryLo1:new Int32Array(1),entryLo0:new Int32Array(1),pageMask:new Int32Array(1),loCompare:new Int32Array(1),myHiMask:new Int32Array(1)},b+=1;this.memory.initPhysRegions()};a.prototype.runLoop=
function(){var a=this;this.mySetInterval=setInterval(function(){var c,d,e;!0===a.terminate&&clearInterval(mySetInterval);a.interrupts.checkInterrupts();for(e=[];;)if(0<=a.m)if(a.interval+=1,a.m=-62500,4===a.interval){a.interval=0;a.repaintWrapper();a.cp0[b.COUNT]+=625E3;a.interrupts.triggerCompareInterrupt(0,!1);a.interrupts.triggerVIInterrupt(0,!1);a.interrupts.processException(a.p);break}else e.push(void 0);else{a.interrupts.processException(a.p);d=a.p>>>2;d="_"+d;try{c=a.code[d],e.push(a.run(c,
a.r,a.h))}catch(k){c=a.decompileBlock(a.p),e.push(c=c(a.r,a.h,a.memory,a))}}return e},8);return this};a.prototype.run=function(b,a,c){for(;0>this.m;)b=b(a,c,this.memory,this)};a.prototype.repaintWrapper=function(){this.repaint(this.ctx,this.ImDat,this.memory.getInt32(this.memory.viUint8Array,this.memory.viUint8Array,b.VI_ORIGIN_REG)&16777215)};a.prototype.startEmulator=function(){this.terminate=!1;this.log("startEmulator");this.runLoop()};a.prototype.stopEmulatorAndCleanup=function(){this.terminate=
this.stopCompiling=!0;this.log("stopEmulatorAndCleanup");this.flushDynaCache()};a.prototype.getFnName=function(b){return"_"+(b>>>2)};a.prototype.decompileBlock=function(b){var a,c,e;this.cnt=d=0;a="_"+(b>>>2);for(e=!0===this.writeToDom?"function "+a+"(r, h, m, t){":"i1964js.code."+a+"=function(r, h, m, t){";!this.stopCompiling;)if(c=this.memory.lw(b+d),e+=this[this.CPU_instruction[c>>26&63]](c),this.cnt+=1,d+=4,1E4<d)throw Error("too many instructions! bailing.");this.stopCompiling=!1;e+="t.m+="+
this.cnt+";";e+="t.p="+(b+d>>0);e+=";return t.code."+this.getFnName(b+d>>0)+"}";!0===this.writeToDom?(b=document.createElement("script"),c=document.getElementsByTagName("script")[this.kk],this.kk+=1,c.parentNode.insertBefore(b,c),b.text=e):wrapEval(e);return this.code[a]};a.prototype.wrapEval=function(b){return eval(b)};a.prototype.r4300i_add=function(b){return this.helpers.sLogic(b,"+")};a.prototype.r4300i_addu=function(b){return this.helpers.sLogic(b,"+")};a.prototype.r4300i_sub=function(b){return this.helpers.sLogic(b,
"-")};a.prototype.r4300i_subu=function(b){return this.helpers.sLogic(b,"-")};a.prototype.r4300i_or=function(b){return this.helpers.dLogic(b,"|")};a.prototype.r4300i_xor=function(b){return this.helpers.dLogic(b,"^")};a.prototype.r4300i_nor=function(b){return"{"+this.helpers.tRD(b)+"=~("+this.helpers.RS(b)+"|"+this.helpers.RT(b)+");"+this.helpers.tRDH(b)+"=~("+this.helpers.RSH(b)+"|"+this.helpers.RTH(b)+")}"};a.prototype.r4300i_and=function(b){return this.helpers.dLogic(b,"&")};a.prototype.r4300i_lui=
function(b){var a;a=(b&65535)<<16;return"{"+this.helpers.tRT(b)+"="+a+";"+this.helpers.tRTH(b)+"="+(a>>31)+"}"};a.prototype.r4300i_lw=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+"=m.lw(vAddr);"+this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_lwu=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+"=m.lw(vAddr);"+this.helpers.tRTH(b)+"=0}"};a.prototype.r4300i_sw=function(b,a){var c,e;e="{"+this.helpers.setVAddr(b)+"m.sw("+this.helpers.RT(b)+
",vAddr";!0===a?(c=this.p+d+4|0,e+=", "+c+", true)}"):(c=this.p+d|0,e+=", "+c+")}");return e};a.prototype.delaySlot=function(b,a){var c,e;e=this.p+d+4+(this.helpers.soffset_imm(b)<<2)|0;c=this.memory.lw(this.p+d+4|0);c=this[this.CPU_instruction[c>>26&63]](c,!0);e=c+"t.m+="+(this.cnt+1)+";t.p="+e+";return t.code."+this.getFnName(e)+"}";!1===a&&(e+=c+"t.m++;");d+=4;return e};a.prototype.r4300i_bne=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RS(b)+"!=="+this.helpers.RT(b)+")||("+this.helpers.RSH(b)+
"!=="+this.helpers.RTH(b)+")){"+this.delaySlot(b,!1)};a.prototype.r4300i_beq=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RS(b)+"==="+this.helpers.RT(b)+")&&("+this.helpers.RSH(b)+"==="+this.helpers.RTH(b)+")){"+this.delaySlot(b,!1)};a.prototype.r4300i_bnel=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RS(b)+"!=="+this.helpers.RT(b)+")||("+this.helpers.RSH(b)+"!=="+this.helpers.RTH(b)+")){"+this.delaySlot(b,!0)};a.prototype.r4300i_blez=function(b){this.stopCompiling=
!0;return"if (("+this.helpers.RSH(b)+"<0)||(("+this.helpers.RSH(b)+"===0)&&("+this.helpers.RS(b)+"===0))){"+this.delaySlot(b,!1)};a.prototype.r4300i_blezl=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RSH(b)+"<0)||(("+this.helpers.RSH(b)+"===0)&&("+this.helpers.RS(b)+"===0))){"+this.delaySlot(b,!0)};a.prototype.r4300i_bgez=function(b){this.stopCompiling=!0;return"if ("+this.helpers.RSH(b)+">=0){"+this.delaySlot(b,!1)};a.prototype.r4300i_bgezl=function(b){this.stopCompiling=!0;return"if ("+
this.helpers.RSH(b)+">=0){"+this.delaySlot(b,!0)};a.prototype.r4300i_bgtzl=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RSH(b)+">0)||(("+this.helpers.RSH(b)+"===0)&&("+this.helpers.RS(b)+"!==0))){"+this.delaySlot(b,!0)};a.prototype.r4300i_bltzl=function(b){this.stopCompiling=!0;return"if ("+this.helpers.RSH(b)+"<0){"+this.delaySlot(b,!0)};a.prototype.r4300i_bgezal=function(b){var a;this.stopCompiling=!0;a=this.p+d+8>>0;return"if ("+this.helpers.RSH(b)+">=0){r[31]="+a+";h[31]="+(a>>
31)+";"+this.delaySlot(b,!1)};a.prototype.r4300i_bgezall=function(b){var a;this.stopCompiling=!0;a=this.p+d+8>>0;return"if ("+this.helpers.RSH(b)+">=0){r[31]="+a+";h[31]="+(a>>31)+";"+this.delaySlot(b,!0)};a.prototype.r4300i_bltz=function(b){this.stopCompiling=!0;return"if ("+this.helpers.RSH(b)+"<0){"+this.delaySlot(b,!1)};a.prototype.r4300i_bgtz=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RSH(b)+">0)||(("+this.helpers.RSH(b)+"===0)&&("+this.helpers.RS(b)+"!==0))){"+this.delaySlot(b,
!1)};a.prototype.r4300i_beql=function(b){this.stopCompiling=!0;return"if (("+this.helpers.RS(b)+"==="+this.helpers.RT(b)+")&&("+this.helpers.RSH(b)+"==="+this.helpers.RTH(b)+")){"+this.delaySlot(b,!0)};a.prototype.r4300i_COP1_bc1f=function(b){this.stopCompiling=!0;return"if((t.cp1Con[31]&0x00800000)===0){"+this.delaySlot(b,!1)};a.prototype.r4300i_COP1_bc1t=function(b){this.stopCompiling=!0;return"if((t.cp1Con[31]&0x00800000)!==0){"+this.delaySlot(b,!1)};a.prototype.r4300i_COP1_bc1tl=function(b){this.stopCompiling=
!0;return"if((t.cp1Con[31]&0x00800000)!==0){"+this.delaySlot(b,!0)};a.prototype.r4300i_COP1_bc1fl=function(b){this.stopCompiling=!0;return"if((t.cp1Con[31]&0x00800000)===0){"+this.delaySlot(b,!0)};a.prototype.r4300i_j=function(b){var a,c;this.stopCompiling=!0;c="{";b=this.p+d+4&4026531840|(b&67108863)<<2|0;a=this.memory.lw(this.p+d+4|0);c=b>>0===this.p+d>>0&&0===a?c+"t.m=0;":c+"t.m+=1;";c+=this[this.CPU_instruction[a>>26&63]](a,!0);return c+("t.p="+b+";return t.code."+this.getFnName(b)+"}")};a.prototype.r4300i_jal=
function(b){var a,c;this.stopCompiling=!0;c="{";b=this.p+d+4&4026531840|(b&67108863)<<2|0;a=this.memory.lw(this.p+d+4|0);c+=this[this.CPU_instruction[a>>26&63]](a,!0);a=this.p+d+8|0;return c+"t.m+=1;"+("t.p="+b+";r[31]="+a+";h[31]="+(a>>31)+";return t.code."+this.getFnName(b)+"}")};a.prototype.r4300i_jalr=function(b){var a,c;this.stopCompiling=!0;c="{var temp="+this.helpers.RS(b)+";";a=this.p+d+8>>0;c+=this.helpers.tRD(b)+"="+a+";"+this.helpers.tRDH(b)+"="+(a>>31)+";";b=this.memory.lw(this.p+d+4|
0);b=this[this.CPU_instruction[b>>26&63]](b,!0);c=c+b+"t.m+=1;";return c+="t.p=temp;return t.code[t.getFnName(temp)]}"};a.prototype.r4300i_jr=function(b){var a;this.stopCompiling=!0;b="{var temp="+this.helpers.RS(b)+";";a=this.memory.lw(this.p+d+4|0);a=this[this.CPU_instruction[a>>26&63]](a,!0);b=b+a+"t.m+=1;";return b+"t.p=temp;return t.code[t.getFnName(temp)]}"};a.prototype.UNUSED=function(){this.log("warning: UNUSED");return""};a.prototype.r4300i_COP0_eret=function(){var a;this.stopCompiling=!0;
a="{if((t.cp0["+b.STATUS+"]&"+b.ERL+')!==0){alert("error epc");t.p=t.cp0['+b.ERROREPC+"];";a+="t.cp0["+b.STATUS+"]&=~"+b.ERL+"}else{t.p=t.cp0["+b.EPC+"];t.cp0["+b.STATUS+"]&=~"+b.EXL+"}";return a+"t.LLbit=0;return t.code[t.getFnName(t.p)]}"};a.prototype.r4300i_COP0_mtc0=function(b,a){var c,e;!0===a?(e=this.p+d+4|0,c="true"):(e=this.p+d|0,c="false");return"t.helpers.inter_mtc0(r,"+this.helpers.fs(b)+","+this.helpers.rt(b)+","+c+","+e+",t.cp0,t.interrupts);"};a.prototype.r4300i_sll=function(b){return 0===
(b&2097151)?"":"{"+this.helpers.tRD(b)+"="+this.helpers.RT(b)+"<<"+this.helpers.sa(b)+";"+this.helpers.tRDH(b)+"="+this.helpers.RD(b)+">>31}"};a.prototype.r4300i_srl=function(b){return"{"+this.helpers.tRD(b)+"="+this.helpers.RT(b)+">>>"+this.helpers.sa(b)+";"+this.helpers.tRDH(b)+"="+this.helpers.RD(b)+">>31}"};a.prototype.r4300i_ori=function(b){return"{"+this.helpers.tRT(b)+"="+this.helpers.RS(b)+"|"+this.helpers.offset_imm(b)+";"+this.helpers.tRTH(b)+"="+this.helpers.RSH(b)+"}"};a.prototype.r4300i_xori=
function(b){return"{"+this.helpers.tRT(b)+"="+this.helpers.RS(b)+"^"+this.helpers.offset_imm(b)+";"+this.helpers.tRTH(b)+"="+this.helpers.RSH(b)+"^0}"};a.prototype.r4300i_andi=function(b){return"{"+this.helpers.tRT(b)+"="+this.helpers.RS(b)+"&"+this.helpers.offset_imm(b)+";"+this.helpers.tRTH(b)+"=0}"};a.prototype.r4300i_addi=function(b){return"{"+this.helpers.tRT(b)+"="+this.helpers.RS(b)+"+"+this.helpers.soffset_imm(b)+";"+this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_addiu=
function(b){return"{"+this.helpers.tRT(b)+"="+this.helpers.RS(b)+"+"+this.helpers.soffset_imm(b)+";"+this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_slt=function(b){return"{if("+this.helpers.RSH(b)+">"+this.helpers.RTH(b)+")"+this.helpers.tRD(b)+"=0;else if("+this.helpers.RSH(b)+"<"+this.helpers.RTH(b)+")"+this.helpers.tRD(b)+"=1;else if("+this.helpers.uRS(b)+"<"+this.helpers.uRT(b)+")"+this.helpers.tRD(b)+"=1;else "+this.helpers.tRD(b)+"=0;"+this.helpers.tRDH(b)+"=0}"};a.prototype.r4300i_sltu=
function(b){return"{if("+this.helpers.uRSH(b)+">"+this.helpers.uRTH(b)+")"+this.helpers.tRD(b)+"=0;else if("+this.helpers.uRSH(b)+"<"+this.helpers.uRTH(b)+")"+this.helpers.tRD(b)+"=1;else if("+this.helpers.uRS(b)+"<"+this.helpers.uRT(b)+")"+this.helpers.tRD(b)+"=1;else "+this.helpers.tRD(b)+"=0;"+this.helpers.tRDH(b)+"=0}"};a.prototype.r4300i_slti=function(b){var a,c;a=this.helpers.soffset_imm(b)>>31;c=this.helpers.soffset_imm(b)>>>0;return"{if("+this.helpers.RSH(b)+">"+a+")"+this.helpers.tRT(b)+
"=0;else if("+this.helpers.RSH(b)+"<"+a+")"+this.helpers.tRT(b)+"=1;else if("+this.helpers.uRS(b)+"<"+c+")"+this.helpers.tRT(b)+"=1;else "+this.helpers.tRT(b)+"=0;"+this.helpers.tRTH(b)+"=0}"};a.prototype.r4300i_sltiu=function(b){var a,c;a=this.helpers.soffset_imm(b)>>31>>>0;c=this.helpers.soffset_imm(b)>>>0;return"{if("+this.helpers.uRSH(b)+">"+a+")"+this.helpers.tRT(b)+"=0;else if("+this.helpers.uRSH(b)+"<"+a+")"+this.helpers.tRT(b)+"=1;else if("+this.helpers.uRS(b)+"<"+c+")"+this.helpers.tRT(b)+
"=1;else "+this.helpers.tRT(b)+"=0;"+this.helpers.tRTH(b)+"=0}"};a.prototype.r4300i_cache=function(){this.log("todo: r4300i_cache");return""};a.prototype.r4300i_multu=function(b){return"t.helpers.inter_multu(r,h,"+b+");"};a.prototype.r4300i_mult=function(b){return"t.helpers.inter_mult(r,h,"+b+");"};a.prototype.r4300i_mflo=function(b){return"{"+this.helpers.tRD(b)+"=r[32];"+this.helpers.tRDH(b)+"=h[32]}"};a.prototype.r4300i_mfhi=function(b){return"{"+this.helpers.tRD(b)+"=r[33];"+this.helpers.tRDH(b)+
"=h[33]}"};a.prototype.r4300i_mtlo=function(b){return"{r[32]="+this.helpers.RS(b)+";h[32]="+this.helpers.RSH(b)+"}"};a.prototype.r4300i_mthi=function(b){return"{r[33]="+this.helpers.RS(b)+";h[33]="+this.helpers.RSH(b)+"}"};a.prototype.r4300i_COP0_mfc0=function(a){switch(this.helpers.fs(a)){case b.RANDOM:alert("RANDOM")}return"{"+(this.helpers.tRT(a)+"=t.cp0["+this.helpers.fs(a)+"];"+this.helpers.tRTH(a)+"=t.cp0["+this.helpers.fs(a)+"]>>31}")};a.prototype.r4300i_lb=function(b){return"{"+this.helpers.setVAddr(b)+
this.helpers.tRT(b)+"=(m.lb(vAddr)<<24)>>24;"+this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_lbu=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+"=(m.lb(vAddr))&0x000000ff;"+this.helpers.tRTH(b)+"=0}"};a.prototype.r4300i_lh=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+"=(m.lh(vAddr)<<16)>>16;"+this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_lhu=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+
"=(m.lh(vAddr))&0x0000ffff;"+this.helpers.tRTH(b)+"=0}"};a.prototype.r4300i_sb=function(b){return"{"+this.helpers.setVAddr(b)+"m.sb("+this.helpers.RT(b)+",vAddr)}"};a.prototype.r4300i_sh=function(b){return"{"+this.helpers.setVAddr(b)+"m.sh("+this.helpers.RT(b)+",vAddr)}"};a.prototype.r4300i_srlv=function(b){return"{"+this.helpers.tRD(b)+"="+this.helpers.RT(b)+">>>("+this.helpers.RS(b)+"&0x1f);"+this.helpers.tRDH(b)+"="+this.helpers.RD(b)+">>31}"};a.prototype.r4300i_sllv=function(b){return"{"+this.helpers.tRD(b)+
"="+this.helpers.RT(b)+"<<("+this.helpers.RS(b)+"&0x1f);"+this.helpers.tRDH(b)+"="+this.helpers.RD(b)+">>31}"};a.prototype.r4300i_srav=function(b){return"{"+this.helpers.tRD(b)+"="+this.helpers.RT(b)+">>("+this.helpers.RS(b)+"&0x1f);"+this.helpers.tRDH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_COP1_cfc1=function(b){if(0===this.helpers.fs(b)||31===this.helpers.fs(b))return"{"+this.helpers.tRT(b)+"=t.cp1Con["+this.helpers.fs(b)+"];"+this.helpers.tRTH(b)+"=t.cp1Con["+this.helpers.fs(b)+"]>>31}"};
a.prototype.r4300i_COP1_ctc1=function(b){if(31===this.helpers.fs(b))return"t.cp1Con[31]="+this.helpers.RT(b)+";"};a.prototype.r4300i_ld=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+"=m.lw((vAddr+4)|0);"+this.helpers.tRTH(b)+"=m.lw(vAddr)}"};a.prototype.r4300i_lld=function(b){return"{"+this.helpers.setVAddr(b)+this.helpers.tRT(b)+"=m.lw((vAddr+4)|0);"+this.helpers.tRTH(b)+"=m.lw(vAddr);t.LLbit=1}"};a.prototype.r4300i_sd=function(b,a){var c,e;e="{"+this.helpers.setVAddr(b)+"m.sw("+
this.helpers.RT(b)+",(vAddr+4)|0";!0===a?(c=this.p+d+4|0,e+=", "+c+", true);"):(c=this.p+d|0,e+=", "+c+");");e+="m.sw("+this.helpers.RTH(b)+",vAddr";!0===a?(c=this.p+d+4|0,e+=", "+c+", true)}"):(c=this.p+d|0,e+=", "+c+")}");return e};a.prototype.r4300i_dmultu=function(b){return"t.helpers.inter_dmultu(r,h,"+b+");"};a.prototype.r4300i_dsll32=function(b){return"{"+this.helpers.tRDH(b)+"="+this.helpers.RT(b)+"<<"+this.helpers.sa(b)+";"+this.helpers.tRD(b)+"=0}"};a.prototype.r4300i_dsra32=function(b){return"{"+
this.helpers.tRD(b)+"="+this.helpers.RTH(b)+">>"+this.helpers.sa(b)+";"+this.helpers.tRDH(b)+"="+this.helpers.RTH(b)+">>31}"};a.prototype.r4300i_ddivu=function(b){return"t.helpers.inter_ddivu(r,h,"+b+");"};a.prototype.r4300i_ddiv=function(b){return"t.helpers.inter_ddiv(r,h,"+b+");"};a.prototype.r4300i_dadd=function(){this.log("todo: dadd");return""};a.prototype.r4300i_break=function(){this.log("todo: break");return""};a.prototype.r4300i_div=function(b){return"t.helpers.inter_div(r,h,"+b+");"};a.prototype.r4300i_divu=
function(b){return"t.helpers.inter_divu(r,h,"+b+");"};a.prototype.r4300i_sra=function(b){return"{"+this.helpers.tRD(b)+"="+this.helpers.RT(b)+">>"+this.helpers.sa(b)+";"+this.helpers.tRDH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_COP0_tlbwi=function(){return"t.helpers.inter_tlbwi(t.cp0["+b.INDEX+"], t.tlb, t.cp0);"};a.prototype.r4300i_COP0_tlbp=function(){return"t.helpers.inter_tlbp(t.tlb, t.cp0);"};a.prototype.r4300i_COP0_tlbr=function(){return"t.helpers.inter_tlbr(t.tlb, t.cp0);"};a.prototype.r4300i_lwl=
function(b){var a;a="{"+this.helpers.setVAddr(b);a=a+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 0:"+this.helpers.tRT(b)+"=value;break;");a+="case 1:"+this.helpers.tRT(b)+"=("+this.helpers.RT(b)+"&0x000000ff)|((value<<8)>>>0);break;";a+="case 2:"+this.helpers.tRT(b)+"=("+this.helpers.RT(b)+"&0x0000ffff)|((value<<16)>>>0);break;";a+="case 3:"+this.helpers.tRT(b)+"=("+this.helpers.RT(b)+"&0x00ffffff)|((value<<24)>>>0);break;}";return a+(this.helpers.tRTH(b)+
"="+this.helpers.RT(b)+">>31}")};a.prototype.r4300i_lwr=function(b){var a;a="{"+this.helpers.setVAddr(b);a=a+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 3:"+this.helpers.tRT(b)+"=value;break;");a+="case 2:"+this.helpers.tRT(b)+"=("+this.helpers.RT(b)+"&0xff000000)|(value>>>8);break;";a+="case 1:"+this.helpers.tRT(b)+"=("+this.helpers.RT(b)+"&0xffff0000)|(value>>>16);break;";a+="case 0:"+this.helpers.tRT(b)+"=("+this.helpers.RT(b)+"&0xffffff00)|(value>>>24);break;}";
return a+(this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}")};a.prototype.r4300i_swl=function(b){var a;a="{"+this.helpers.setVAddr(b);a=a+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 0:value="+this.helpers.RT(b)+";break;");a+="case 1:value=((value&0xff000000)|("+this.helpers.RT(b)+">>>8));break;";a+="case 2:value=((value&0xffff0000)|("+this.helpers.RT(b)+">>>16));break;";a+="case 3:value=((value&0xffffff00)|("+this.helpers.RT(b)+">>>24));break;}";
return a+"m.sw(value,vAddrAligned,false)}"};a.prototype.r4300i_swr=function(b){var a;a="{"+this.helpers.setVAddr(b);a=a+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 3:value="+this.helpers.RT(b)+";break;");a+="case 2:value=((value & 0x000000FF)|(("+this.helpers.RT(b)+"<<8)>>>0));break;";a+="case 1:value=((value & 0x0000FFFF)|(("+this.helpers.RT(b)+"<<16)>>>0));break;";a+="case 0:value=((value & 0x00FFFFFF)|(("+this.helpers.RT(b)+"<<24)>>>0));break;}";
return a+"m.sw(value,vAddrAligned,false)}"};a.prototype.r4300i_lwc1=function(b){return"{"+this.helpers.setVAddr(b)+"t.cp1_i["+this.helpers.FT32ArrayView(b)+"]=m.lw(vAddr)}"};a.prototype.r4300i_ldc1=function(b){return"{"+this.helpers.setVAddr(b)+"t.cp1_i["+this.helpers.FT32ArrayView(b)+"]=m.lw((vAddr+4)|0);"+("t.cp1_i["+this.helpers.FT32HIArrayView(b)+"]=m.lw((vAddr)|0)}")};a.prototype.r4300i_swc1=function(b,a){var c,e;e="{"+this.helpers.setVAddr(b)+"m.sw(t.cp1_i["+this.helpers.FT32ArrayView(b)+"],vAddr";
!0===a?(c=this.p+d+4|0,e+=", "+c+", true)}"):(c=this.p+d|0,e+=", "+c+")}");return e};a.prototype.r4300i_sdc1=function(b,a){var c,e;e="{"+this.helpers.setVAddr(b)+"m.sw(t.cp1_i["+this.helpers.FT32ArrayView(b)+"],(vAddr+4)|0";!0===a?(c=this.p+d+4|0,e+=", "+c+", true);"):(c=this.p+d|0,e+=", "+c+");");e+="m.sw(t.cp1_i["+this.helpers.FT32HIArrayView(b)+"],(vAddr)|0";!0===a?(c=this.p+d+4|0,e+=", "+c+", true)}"):(c=this.p+d|0,e+=", "+c+")}");return e};a.prototype.r4300i_COP1_mtc1=function(b){return"t.cp1_i["+
this.helpers.FS32ArrayView(b)+"]="+this.helpers.RT(b)+";"};a.prototype.r4300i_COP1_mfc1=function(b){return"{"+this.helpers.tRT(b)+"=t.cp1_i["+this.helpers.FS32ArrayView(b)+"];"+this.helpers.tRTH(b)+"="+this.helpers.RT(b)+">>31}"};a.prototype.r4300i_COP1_cvts_w=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=t.cp1_i["+this.helpers.FS32ArrayView(b)+"];"};a.prototype.r4300i_COP1_cvtw_s=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+
"];"};a.prototype.r4300i_COP1_div_s=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+"]/t.cp1_f["+this.helpers.FT32ArrayView(b)+"];"};a.prototype.r4300i_COP1_div_d=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"]/t.cp1_f64["+this.helpers.FT64ArrayView(b)+"];"};a.prototype.r4300i_COP1_mul_s=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+
"]*t.cp1_f["+this.helpers.FT32ArrayView(b)+"];"};a.prototype.r4300i_COP1_mul_d=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"]*t.cp1_f64["+this.helpers.FT64ArrayView(b)+"];"};a.prototype.r4300i_COP1_mov_s=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+"]=t.cp1_i["+this.helpers.FS32ArrayView(b)+"];"};a.prototype.r4300i_COP1_mov_d=function(b){return"t.cp1_f64["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS32ArrayView(b)+
"];"};a.prototype.r4300i_COP1_add_s=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+"]+t.cp1_f["+this.helpers.FT32ArrayView(b)+"];"};a.prototype.r4300i_COP1_sub_s=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+"]-t.cp1_f["+this.helpers.FT32ArrayView(b)+"];"};a.prototype.r4300i_COP1_cvtd_s=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+
"];"};a.prototype.r4300i_COP1_cvtd_w=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+"]=t.cp1_i["+this.helpers.FS32ArrayView(b)+"];"};a.prototype.r4300i_COP1_cvts_d=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"];"};a.prototype.r4300i_COP1_cvtw_d=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"];"};a.prototype.r4300i_COP1_add_d=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+
"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"]+t.cp1_f64["+this.helpers.FT64ArrayView(b)+"];"};a.prototype.r4300i_COP1_sub_d=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"]-t.cp1_f64["+this.helpers.FT64ArrayView(b)+"];"};a.prototype.r4300i_COP1_truncw_d=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(b)+"];"};a.prototype.r4300i_COP1_truncw_s=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+
"]=t.cp1_f["+this.helpers.FS32ArrayView(b)+"];"};a.prototype.r4300i_COP1_neg_s=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+"]=t.cp1_i["+this.helpers.FS32ArrayView(b)+"]^0x80000000;"};a.prototype.r4300i_COP1_neg_d=function(b){return"t.cp1_i["+this.helpers.FD32HIArrayView(b)+"]=t.cp1_i["+this.helpers.FS32HIArrayView(b)+"]^0x80000000;"};a.prototype.r4300i_COP1_abs_s=function(b){return"t.cp1_i["+this.helpers.FD32ArrayView(b)+"]=t.cp1_i["+this.helpers.FS32ArrayView(b)+"]&0x7fffffff;"};a.prototype.r4300i_COP1_abs_d=
function(b){return"t.cp1_i["+this.helpers.FD32HIArrayView(b)+"]=t.cp1_i["+this.helpers.FS32HIArrayView(b)+"]&0x7fffffff;"};a.prototype.r4300i_COP1_sqrt_s=function(b){return"t.cp1_f["+this.helpers.FD32ArrayView(b)+"]=Math.sqrt(t.cp1_f["+this.helpers.FS32ArrayView(b)+"]);"};a.prototype.r4300i_COP1_sqrt_d=function(b){return"t.cp1_f64["+this.helpers.FD64ArrayView(b)+"]=Math.sqrt(t.cp1_f64["+this.helpers.FS64ArrayView(b)+"]);"};a.prototype.r4300i_sync=function(){this.log("todo: sync");return""};a.prototype.r4300i_sdr=
function(){this.log("todo: sdr");return""};a.prototype.r4300i_ldr=function(){this.log("todo: ldr");return""};a.prototype.r4300i_sdl=function(){this.log("todo: sdl");return""};a.prototype.r4300i_ldl=function(){this.log("todo: ldl");return""};a.prototype.r4300i_sc=function(){this.log("todo: sc");return""};a.prototype.r4300i_scd=function(){this.log("todo: scd");return""};a.prototype.r4300i_daddi=function(b){return"t.helpers.inter_daddi(r,h,"+b+");"};a.prototype.r4300i_teq=function(){this.log("todo: r4300i_teq");
return""};a.prototype.r4300i_tgeu=function(){this.log("todo: r4300i_tgeu");return""};a.prototype.r4300i_tlt=function(){this.log("todo: r4300i_tlt");return""};a.prototype.r4300i_tltu=function(){this.log("todo: r4300i_tltu");return""};a.prototype.r4300i_tne=function(){this.log("todo: r4300i_tne");return""};a.prototype.r4300i_daddiu=function(b){return"t.helpers.inter_daddiu(r,h,"+b+");"};a.prototype.r4300i_daddu=function(b){return"t.helpers.inter_daddu(r,h,"+b+");"};a.prototype.r4300i_C_F_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_UN_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_EQ_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_UEQ_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_OLT_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_ULT_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_OLE_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_ULE_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_SF_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGLE_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_SEQ_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGL_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_LT_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGE_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_LE_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGT_S=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
b+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_F_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_UN_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_EQ_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_UEQ_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_OLT_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+
b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_ULT_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_OLE_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_ULE_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_SF_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGLE_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+
b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_SEQ_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGL_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_LT_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGE_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_LE_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+
b+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGT_D=function(b){return"t.helpers.inter_r4300i_C_cond_fmt_d("+b+",t.cp1Con,t.cp1_f64);"};return a}();c="undefined"!==typeof exports&&null!==exports?exports:this;c.C1964jsEmulator=a;c.consts=b}).call(this);(function(){var a;a="undefined"!==typeof exports&&null!==exports?exports:this;a.C1964jsHelpers=function(b,a){this.core=b;this.isLittleEndian=a;this.isBigEndian=!1===a;this.fs=function(b){return b>>11&31};this.ft=function(b){return b>>16&31};this.FS32ArrayView=function(b){return b>>11&31^this.isBigEndian};this.FS32HIArrayView=function(b){return b>>11&31^this.isLittleEndian};this.FT32ArrayView=function(b){return b>>16&31^this.isBigEndian};this.FT32HIArrayView=function(b){return b>>16&31^this.isLittleEndian};
this.FD32ArrayView=function(b){return b>>6&31^this.isBigEndian};this.FD32HIArrayView=function(b){return b>>6&31^this.isLittleEndian};this.FS64ArrayView=function(b){return(b>>11&31)>>1};this.FT64ArrayView=function(b){return(b>>16&31)>>1};this.FD64ArrayView=function(b){return(b>>6&31)>>1};this.rd=function(b){return b>>11&31};this.rs=function(b){return b>>21&31};this.RS=function(b){b=b>>21&31;return 0===b?"0":"r["+b+"]"};this.RSH=function(b){b=b>>21&31;return 0===b?"0":"h["+b+"]"};this.uRS=function(b){b=
b>>21&31;return 0===b?"0":"(r["+b+"]>>>0)"};this.uRSH=function(b){b=b>>21&31;return 0===b?"0":"(h["+b+"]>>>0)"};this.tRS=function(b){b=b>>21&31;return 0===b?"r[34]":"r["+b+"]"};this.tRSH=function(b){b=b>>21&31;return 0===b?"h[34]":"h["+b+"]"};this.tRD=function(b){b=b>>11&31;return 0===b?"r[34]":"r["+b+"]"};this.tRDH=function(b){b=b>>11&31;return 0===b?"h[34]":"h["+b+"]"};this.tRT=function(b){b=b>>16&31;return 0===b?"r[34]":"r["+b+"]"};this.tRTH=function(b){b=b>>16&31;return 0===b?"h[34]":"h["+b+"]"};
this.RD=function(b){b=b>>11&31;return 0===b?"0":"r["+b+"]"};this.RDH=function(b){b=b>>11&31;return 0===b?"0":"h["+b+"]"};this.uRD=function(b){b=b>>11&31;return 0===b?"0":"(r["+b+"]>>>0)"};this.uRDH=function(b){b=b>>11&31;return 0===b?"0":"(h["+b+"]>>>0)"};this.RT=function(b){b=b>>16&31;return 0===b?"0":"r["+b+"]"};this.RTH=function(b){b=b>>16&31;return 0===b?"0":"h["+b+"]"};this.uRT=function(b){b=b>>16&31;return 0===b?"0":"(r["+b+"]>>>0)"};this.uRTH=function(b){b=b>>16&31;return 0===b?"0":"(h["+b+
"]>>>0)"};this.rt=function(b){return b>>16&31};this.offset_imm=function(b){return b&65535};this.soffset_imm=function(b){return(b&65535)<<16>>16};this.setVAddr=function(b){return"var vAddr=("+this.RS(b)+"+"+this.soffset_imm(b)+")>>0;"};this.fn=function(b){return b&63};this.sa=function(b){return b>>6&31};this.fd=function(b){return b>>6&31};this.sLogic=function(b,a){return"{"+this.tRD(b)+"="+this.RS(b)+a+this.RT(b)+";"+this.tRDH(b)+"="+this.RD(b)+">>31;}"};this.dLogic=function(b,a){return"{"+this.tRD(b)+
"="+this.RS(b)+a+this.RT(b)+";"+this.tRDH(b)+"="+this.RSH(b)+a+this.RTH(b)+";}"};this.inter_mtc0=function(b,a,d,f,h,i,k){switch(a){case consts.CAUSE:i[a]&=-769;i[a]|=b[d]&768;b[d]&768&&0!==(i[consts.CAUSE]&i[consts.STATUS]&65280)&&k.setException(consts.EXC_INT,0,h,f);break;case consts.COUNT:i[a]=b[d];break;case consts.COMPARE:i[consts.CAUSE]&=~consts.CAUSE_IP8;i[a]=b[d];break;case consts.STATUS:if(0===(b[d]&consts.EXL)&&1===(i[a]&consts.EXL)&&0!==(i[consts.CAUSE]&i[consts.STATUS]&65280)){i[a]=b[d];
k.setException(consts.EXC_INT,0,h,f);break}if(1===(b[d]&consts.IE)&&0===(i[a]&consts.IE)&&0!==(i[consts.CAUSE]&i[consts.STATUS]&65280)){i[a]=b[d];k.setException(consts.EXC_INT,0,h,f);break}i[a]=b[d];break;case consts.BADVADDR:case consts.PREVID:case consts.RANDOM:break;case consts.INDEX:i[a]=b[d]&2147483711;break;case consts.ENTRYLO0:i[a]=b[d]&1073741823;break;case consts.ENTRYLO1:i[a]=b[d]&1073741823;break;case consts.ENTRYHI:i[a]=b[d]&4294959359;break;case consts.PAGEMASK:i[a]=b[d]&33546240;break;
case consts.WIRED:i[a]=b[d]&31;i[consts.RANDOM]=31;break;default:i[a]=b[d]}};this.inter_mult=function(b,a,d){var f;f=b[this.rs(d)];d=b[this.rt(d)];f=goog.math.Long.fromBits(f,f>>31);d=goog.math.Long.fromBits(d,d>>31);f=f.multiply(d);b[32]=f.getLowBits();a[32]=b[32]>>31;b[33]=f.getHighBits();a[33]=b[33]>>31};this.inter_multu=function(b,a,d){var f;f=b[this.rs(d)];d=b[this.rt(d)];f=goog.math.Long.fromBits(f,0);d=goog.math.Long.fromBits(d,0);f=f.multiply(d);b[32]=f.getLowBits();a[32]=b[32]>>31;b[33]=
f.getHighBits();a[33]=b[33]>>31};this.inter_daddi=function(b,a,d){var f,h;h=goog.math.Long.fromBits(b[this.rs(d)],a[this.rs(d)]);f=goog.math.Long.fromBits(this.soffset_imm(d),this.soffset_imm(d)>>31);f=h.add(f);b[this.rt(d)]=f.getLowBits();a[this.rt(d)]=f.getHighBits()};this.inter_daddiu=function(b,a,d){var f,h;h=goog.math.Long.fromBits(b[this.rs(d)],a[this.rs(d)]);f=goog.math.Long.fromBits(this.soffset_imm(d),this.soffset_imm(d)>>31);f=h.add(f);b[this.rt(d)]=f.getLowBits();a[this.rt(d)]=f.getHighBits()};
this.inter_dadd=function(b,a,d){var f,h;f=goog.math.Long.fromBits(b[this.rs(d)],a[this.rs(d)]);h=goog.math.Long.fromBits(b[this.rt(d)],a[this.rt(d)]);f=f.add(h);b[this.rd(d)]=f.getLowBits();a[this.rd(d)]=f.getHighBits()};this.inter_daddu=function(b,a,d){var f,h;f=goog.math.Long.fromBits(b[this.rs(d)],a[this.rs(d)]);h=goog.math.Long.fromBits(b[this.rt(d)],a[this.rt(d)]);f=f.add(h);b[this.rd(d)]=f.getLowBits();a[this.rd(d)]=f.getHighBits()};this.inter_div=function(b,a,d){0===b[this.rt(d)]?alert("divide by zero"):
(b[32]=b[this.rs(d)]/b[this.rt(d)],a[32]=b[32]>>31,b[33]=b[this.rs(d)]%b[this.rt(d)],a[33]=b[33]>>31)};this.inter_ddiv=function(b,a,d){var f,h,i;f=b[this.rs(d)];i=b[this.rt(d)];h=a[this.rs(d)];d=a[this.rt(d)];f=goog.math.Long.fromBits(f,h);h=goog.math.Long.fromBits(i,d);0===h?alert("divide by zero"):(i=f.div(h),f=f.modulo(h),b[32]=i.getLowBits(),a[32]=i.getHighBits(),b[33]=f.getLowBits(),a[33]=f.getHighBits())};this.inter_divu=function(b,a,d){0===b[this.rt(d)]?alert("divide by zero"):(b[32]=(b[this.rs(d)]>>>
0)/(b[this.rt(d)]>>>0),a[32]=0,b[33]=(b[this.rs(d)]>>>0)%(b[this.rt(d)]>>>0),a[33]=0)};this.inter_dmult=function(b,a,d){var f;f="0x"+String(dec2hex(a[this.rs(d)]))+String(dec2hex(b[this.rs(d)]));d="0x"+String(dec2hex(a[this.rt(d)]))+String(dec2hex(b[this.rt(d)]));f=new BigInt(f);d=new BigInt(d);d=bigint_mul(f,d).toStringBase(16);"-"===d[0]&&alert("dmult:"+d);24<d.length?(f=d.length-24,a[33]="0x"+d.substr(0,f)>>>0,b[33]="0x"+d.substr(f,8)>>>0,a[32]="0x"+d.substr(f+8,8)>>>0,b[32]="0x"+d.substr(f+16,
8)>>>0):16<d.length?(f=d.length-16,a[33]=0,b[33]="0x"+d.substr(0,f)>>>0,a[32]="0x"+d.substr(f,8)>>>0,b[32]="0x"+d.substr(f+8,8)>>>0):8<d.length?(f=d.length-8,a[33]=0,b[33]=0,a[32]="0x"+d.substr(0,f)>>>0,b[32]="0x"+d.substr(f,8)>>>0):(f=d.length,a[33]=0,b[33]=0,a[32]=0,b[32]="0x"+d.substr(0,f)>>>0)};this.inter_dmultu=function(b,a,d){var f;f="0x0"+String(dec2hex(a[this.rs(d)]))+String(dec2hex(b[this.rs(d)]));d="0x0"+String(dec2hex(a[this.rt(d)]))+String(dec2hex(b[this.rt(d)]));f=new BigInt(f);d=new BigInt(d);
d=bigint_mul(f,d).toStringBase(16);"-"===d[0]&&alert("dmultu:"+d);24<d.length?(f=d.length-24,a[33]="0x"+d.substr(0,f)>>>0,b[33]="0x"+d.substr(f,8)>>>0,a[32]="0x"+d.substr(f+8,8)>>>0,b[32]="0x"+d.substr(f+16,8)>>>0):16<d.length?(f=d.length-16,a[33]=0,b[33]="0x"+d.substr(0,f)>>>0,a[32]="0x"+d.substr(f,8)>>>0,b[32]="0x"+d.substr(f+8,8)>>>0):8<d.length?(f=d.length-8,a[33]=0,b[33]=0,a[32]="0x"+d.substr(0,f)>>>0,b[32]="0x"+d.substr(f,8)>>>0):(f=d.length,a[33]=0,b[33]=0,a[32]=0,b[32]="0x"+d.substr(0,f)>>>
0)};this.inter_ddivu=function(b,a,d){var f,h,i;i="0x0"+String(dec2hex(a[this.rs(d)]))+String(dec2hex(b[this.rs(d)]));d="0x0"+String(dec2hex(a[this.rt(d)]))+String(dec2hex(b[this.rt(d)]));i=new BigInt(i);d=new BigInt(d);(f=bigint_div(i,d))?(h=f.toStringBase(16),"-"===h[0]&&alert("ddivu:"+h),8<h.length?(f=h.length-8,a[32]="0x"+h.substr(0,f)>>>0,b[32]="0x"+h.substr(f,8)>>>0):(f=h.length,a[32]=0,b[32]="0x"+h.substr(0,f)>>>0)):(b[32]=0,a[32]=0);f=bigint_mod(i,d);h=f.toStringBase(16);8<h.length?(f=h.length-
8,a[33]="0x"+h.substr(0,f)>>>0,b[33]="0x"+h.substr(f,8)>>>0):(f=h.length,a[33]=0,b[33]="0x"+h.substr(0,f)>>>0)};this.inter_r4300i_C_cond_fmt_s=function(b,a,d){var f,h,i,k,j;f=b&1;h=b>>1&1;i=b>>2&1;k=b>>3&1;j=d[this.FS32ArrayView(b)];d=d[this.FT32ArrayView(b)];if(isNaN(j)||isNaN(d)){if(j=b=!1,d=!0,0!==k)return}else b=j<d,j=j===d,d=!1;a[31]&=~consts.COP1_CONDITION_BIT;(f&&d||h&&j||i&&b)&&(a[31]|=consts.COP1_CONDITION_BIT)};this.inter_r4300i_C_cond_fmt_d=function(b,a,d){var f,h,i,k,j;f=b&1;h=b>>1&1;
i=b>>2&1;k=b>>3&1;j=d[this.FS64ArrayView(b)];d=d[this.FT64ArrayView(b)];if(isNaN(j)||isNaN(d)){if(j=b=!1,d=!0,0!==k)return}else b=j<d,j=j===d,d=!1;a[31]&=~consts.COP1_CONDITION_BIT;(f&&d||h&&j||i&&b)&&(a[31]|=consts.COP1_CONDITION_BIT)};this.writeTLBEntry=function(b,a){var d;d=a[consts.ENTRYLO0]&a[consts.ENTRYLO1]&consts.TLBLO_G;b.pageMask=a[consts.PAGEMASK]>>>0;b.entryLo1=(a[consts.ENTRYLO1]|d)>>>0;b.entryLo0=(a[consts.ENTRYLO0]|d)>>>0;b.myHiMask=(~b.pageMask>>>0&consts.TLBHI_VPN2MASK)>>>0;b.entryHi=
(a[consts.ENTRYHI]>>>0&~a[consts.PAGEMASK]>>>0)>>>0;switch(b.pageMask){case 0:b.loCompare=4096;break;case 24576:b.loCompare=16384;break;case 122880:b.loCompare=65536;break;case 516096:b.loCompare=262144;break;case 2088960:b.loCompare=1048576;break;case 8380416:b.loCompare=4194304;break;case 33546240:b.loCompare=16777216;break;default:console.log("ERROR: tlbwi - invalid page size"+b.pageMask)}this.newtlb=!0};this.buildTLBHelper=function(b,a,d,f,h){var i;i=b>>>12;a>>>=12;if(!0===h)for(;i<a;)this.core.memory.physRegion[i]=
(i&131071)>>>4,i++;else for(f=(2147483648|d<<6>>>0&f>>>1)>>>0;i<a;)d=f+(i<<12)-b&536870911,this.core.memory.physRegion[i]=d>>>16,i++};this.buildTLB=function(b,a){var d,f,h;f=(b.entryHi&4294967040)>>>0;h=f+b.loCompare>>>0;d=f+2*b.loCompare>>>0;this.buildTLBHelper(f,h,b.entryLo0,b.myHiMask,a);this.buildTLBHelper(h,d,b.entryLo1,b.myHiMask,a)};this.refreshTLB=function(b,a){1===b.valid&&this.buildTLB(b,!0);this.writeTLBEntry(b,a);b.valid=0;if(a[consts.ENTRYLO1]&consts.TLBLO_V||a[consts.ENTRYLO0]&consts.TLBLO_V)b.valid=
1;1===b.valid&&this.buildTLB(b)};this.inter_tlbwi=function(b,a,d){0>b||31<b?console.log("ERROR: tlbwi received an invalid index=%08X",b):this.refreshTLB(a[b],d)};this.inter_tlbp=function(b,a){var d;a[consts.INDEX]|=2147483648;for(d=0;31>d;){if((b[d].entryHi&b[d].myHiMask)===(a[consts.ENTRYHI]&b[d].myHiMask)&&(b[d].entryLo0&consts.TLBLO_G&b[d].entryLo1||(b[d].entryHi&consts.TLBHI_PIDMASK)===(a[consts.ENTRYHI]&consts.TLBHI_PIDMASK))){a[consts.INDEX]=d;break}d++}};this.inter_tlbr=function(b,a){var d;
d=a[consts.INDEX]&2147483647;0>d||31<d?console.log("ERROR: tlbr received an invalid index=%08X",d):(a[consts.PAGEMASK]=b[d].pageMask,a[consts.ENTRYHI]=b[d].entryHi,a[consts.ENTRYHI]&=~b[d].pageMask>>>0,a[consts.ENTRYLO1]=b[d].entryLo1,a[consts.ENTRYLO0]=b[d].entryLo0)};return this};a.dec2hex=function(b){var a;for(a="0123456789ABCDEF".substr(b&15,1);!(b>>=4,b&=268435455,a="0123456789ABCDEF".substr(b&15,1)+a,!(15<b)););return a}}).call(this);(function(){C1964jsEmulator.prototype.CPU_instruction="instr REGIMM_instr r4300i_j r4300i_jal r4300i_beq r4300i_bne r4300i_blez r4300i_bgtz r4300i_addi r4300i_addiu r4300i_slti r4300i_sltiu r4300i_andi r4300i_ori r4300i_xori r4300i_lui COP0_instr COP1_instr UNUSED UNUSED r4300i_beql r4300i_bnel r4300i_blezl r4300i_bgtzl r4300i_daddi r4300i_daddiu r4300i_ldl r4300i_ldr UNUSED UNUSED UNUSED UNUSED r4300i_lb r4300i_lh r4300i_lwl r4300i_lw r4300i_lbu r4300i_lhu r4300i_lwr r4300i_lwu r4300i_sb r4300i_sh r4300i_swl r4300i_sw r4300i_sdl r4300i_sdr r4300i_swr r4300i_cache r4300i_ll r4300i_lwc1 UNUSED UNUSED r4300i_lld r4300i_ldc1 UNUSED r4300i_ld r4300i_sc r4300i_swc1 UNUSED UNUSED r4300i_scd r4300i_sdc1 UNUSED r4300i_sd".split(" ");
C1964jsEmulator.prototype.r4300i_Instruction="r4300i_sll UNUSED r4300i_srl r4300i_sra r4300i_sllv UNUSED r4300i_srlv r4300i_srav r4300i_jr r4300i_jalr UNUSED UNUSED r4300i_syscall r4300i_break UNUSED r4300i_sync r4300i_mfhi r4300i_mthi r4300i_mflo r4300i_mtlo r4300i_dsllv UNUSED r4300i_dsrlv r4300i_dsrav r4300i_mult r4300i_multu r4300i_div r4300i_divu r4300i_dmult r4300i_dmultu r4300i_ddiv r4300i_ddivu r4300i_add r4300i_addu r4300i_sub r4300i_subu r4300i_and r4300i_or r4300i_xor r4300i_nor UNUSED UNUSED r4300i_slt r4300i_sltu r4300i_dadd r4300i_daddu r4300i_dsub r4300i_dsubu r4300i_tge r4300i_tgeu r4300i_tlt r4300i_tltu r4300i_teq UNUSED r4300i_tne UNUSED r4300i_dsll UNUSED r4300i_dsrl r4300i_dsra r4300i_dsll32 UNUSED r4300i_dsrl32 r4300i_dsra32".split(" ");
C1964jsEmulator.prototype.REGIMM_Instruction="r4300i_bltz r4300i_bgez r4300i_bltzl r4300i_bgezl UNUSED UNUSED UNUSED UNUSED r4300i_tgei r4300i_tgeiu r4300i_tlti r4300i_tltiu r4300i_teqi UNUSED r4300i_tnei UNUSED r4300i_bltzal r4300i_bgezal r4300i_bltzall r4300i_bgezall UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");C1964jsEmulator.prototype.COP0_Instruction="r4300i_COP0_mfc0 UNUSED UNUSED UNUSED r4300i_COP0_mtc0 UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED TLB_instr UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.TLB_Instruction="UNUSED r4300i_COP0_tlbr r4300i_COP0_tlbwi UNUSED UNUSED UNUSED r4300i_COP0_tlbwr UNUSED r4300i_COP0_tlbp UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP0_eret UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.COP1_Instruction="r4300i_COP1_mfc1 r4300i_COP1_dmfc1 r4300i_COP1_cfc1 UNUSED r4300i_COP1_mtc1 r4300i_COP1_dmtc1 r4300i_COP1_ctc1 UNUSED COP1_BC_instr UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED COP1_S_instr COP1_D_instr UNUSED UNUSED COP1_W_instr COP1_L_instr UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");C1964jsEmulator.prototype.COP1_BC_Instruction="r4300i_COP1_bc1f r4300i_COP1_bc1t r4300i_COP1_bc1fl r4300i_COP1_bc1tl UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.COP1_S_Instruction="r4300i_COP1_add_s r4300i_COP1_sub_s r4300i_COP1_mul_s r4300i_COP1_div_s r4300i_COP1_sqrt_s r4300i_COP1_abs_s r4300i_COP1_mov_s r4300i_COP1_neg_s r4300i_COP1_roundl_s r4300i_COP1_truncl_s r4300i_COP1_ceill_s r4300i_COP1_floorl_s r4300i_COP1_roundw_s r4300i_COP1_truncw_s r4300i_COP1_ceilw_s r4300i_COP1_floorw_s UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvtd_s UNUSED UNUSED r4300i_COP1_cvtw_s r4300i_COP1_cvtl_s UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_C_F_S r4300i_C_UN_S r4300i_C_EQ_S r4300i_C_UEQ_S r4300i_C_OLT_S r4300i_C_ULT_S r4300i_C_OLE_S r4300i_C_ULE_S r4300i_C_SF_S r4300i_C_NGLE_S r4300i_C_SEQ_S r4300i_C_NGL_S r4300i_C_LT_S r4300i_C_NGE_S r4300i_C_LE_S r4300i_C_NGT_S".split(" ");
C1964jsEmulator.prototype.COP1_D_Instruction="r4300i_COP1_add_d r4300i_COP1_sub_d r4300i_COP1_mul_d r4300i_COP1_div_d r4300i_COP1_sqrt_d r4300i_COP1_abs_d r4300i_COP1_mov_d r4300i_COP1_neg_d r4300i_COP1_roundl_d r4300i_COP1_truncl_d r4300i_COP1_ceill_d r4300i_COP1_floorl_d r4300i_COP1_roundw_d r4300i_COP1_truncw_d r4300i_COP1_ceilw_d r4300i_COP1_floorw_d UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvts_d UNUSED UNUSED UNUSED r4300i_COP1_cvtw_d r4300i_COP1_cvtl_d UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_C_F_D r4300i_C_UN_D r4300i_C_EQ_D r4300i_C_UEQ_D r4300i_C_OLT_D r4300i_C_ULT_D r4300i_C_OLE_D r4300i_C_ULE_D r4300i_C_SF_D r4300i_C_NGLE_D r4300i_C_SEQ_D r4300i_C_NGL_D r4300i_C_LT_D r4300i_C_NGE_D r4300i_C_LE_D r4300i_C_NGT_D".split(" ");
C1964jsEmulator.prototype.COP1_W_Instruction="UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvts_w r4300i_COP1_cvtd_w UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.COP1_L_Instruction="UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvts_l r4300i_COP1_cvtd_l UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.instr=function(a,b){return this[this.r4300i_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.REGIMM_instr=function(a,b){return this[this.REGIMM_Instruction[this.helpers.rt(a)]](a,b)};C1964jsEmulator.prototype.COP0_instr=function(a,b){return this[this.COP0_Instruction[this.helpers.rs(a)]](a,b)};C1964jsEmulator.prototype.COP1_instr=function(a,b){return this[this.COP1_Instruction[this.helpers.rs(a)]](a,b)};C1964jsEmulator.prototype.TLB_instr=function(a,b){return this[this.TLB_Instruction[this.helpers.fn(a)]](a,
b)};C1964jsEmulator.prototype.COP1_BC_instr=function(a,b){return this[this.COP1_BC_Instruction[this.helpers.rt(a)]](a,b)};C1964jsEmulator.prototype.COP1_S_instr=function(a,b){return this[this.COP1_S_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.COP1_D_instr=function(a,b){return this[this.COP1_D_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.COP1_W_instr=function(a,b){return this[this.COP1_W_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.COP1_L_instr=
function(a,b){return this[this.COP1_L_Instruction[this.helpers.fn(a)]](a,b)}}).call(this);(function(){C1964jsEmulator.prototype.getTVSystem=function(a){switch(a){case 0:a=this.TV_SYSTEM_NTSC;break;case 55:a=this.TV_SYSTEM_NTSC;break;case 65:a=this.TV_SYSTEM_NTSC;break;case 68:a=this.TV_SYSTEM_PAL;break;case 69:a=this.TV_SYSTEM_NTSC;break;case 70:a=this.TV_SYSTEM_PAL;break;case "I":a=this.TV_SYSTEM_PAL;break;case 74:a=this.TV_SYSTEM_NTSC;break;case 80:a=this.TV_SYSTEM_PAL;break;case 83:a=this.TV_SYSTEM_PAL;break;case 85:a=this.TV_SYSTEM_PAL;break;case 88:a=this.TV_SYSTEM_PAL;break;case 89:a=
this.TV_SYSTEM_PAL;break;case 32:case 33:case 56:case 112:a=this.TV_SYSTEM_PAL;break;default:a=this.TV_SYSTEM_PAL}return a};C1964jsEmulator.prototype.getCIC=function(){var a,b;for(b=a=0;4032>b;)a+=this.memory.romUint8Array[64+b],b+=1;switch(a){case 211495:case 213534:this.log("Using CIC-NUS-6101 for starfox\n");a=63;break;case 213060:this.log("Using CIC-NUS-6102 for mario\n");a=63;break;case 219088:this.log("Using CIC-NUS-6103 for Banjo\n");a=120;break;case 293505:this.log("Using CIC-NUS-6105 for Zelda\n");
a=145;break;case 225740:this.log("Using CIC-NUS-6106 for F-Zero/Yoshi Story\n");a=133;break;case 213961:this.log("Using Boot Code for F1 World Grand Prix\n");a=133;break;default:this.log("Unknown boot code, using Mario boot code instead"),a=63}return a}}).call(this);goog.math={};goog.math.Long=function(a,b){this.low_=a|0;this.high_=b|0};goog.math.Long.IntCache_={};goog.math.Long.fromInt=function(a){if(-128<=a&&128>a){var b=goog.math.Long.IntCache_[a];if(b)return b}b=new goog.math.Long(a|0,0>a?-1:0);-128<=a&&128>a&&(goog.math.Long.IntCache_[a]=b);return b};
goog.math.Long.fromNumber=function(a){return isNaN(a)||!isFinite(a)?goog.math.Long.ZERO:a<=-goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MIN_VALUE:a+1>=goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MAX_VALUE:0>a?goog.math.Long.fromNumber(-a).negate():new goog.math.Long(a%goog.math.Long.TWO_PWR_32_DBL_|0,a/goog.math.Long.TWO_PWR_32_DBL_|0)};goog.math.Long.fromBits=function(a,b){return new goog.math.Long(a,b)};
goog.math.Long.fromString=function(a,b){if(0==a.length)throw Error("number format error: empty string");var d=b||10;if(2>d||36<d)throw Error("radix out of range: "+d);if("-"==a.charAt(0))return goog.math.Long.fromString(a.substring(1),d).negate();if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character: '+a);for(var c=goog.math.Long.fromNumber(Math.pow(d,8)),e=goog.math.Long.ZERO,g=0;g<a.length;g+=8){var f=Math.min(8,a.length-g),h=parseInt(a.substring(g,g+f),d);8>f?(f=goog.math.Long.fromNumber(Math.pow(d,
f)),e=e.multiply(f).add(goog.math.Long.fromNumber(h))):(e=e.multiply(c),e=e.add(goog.math.Long.fromNumber(h)))}return e};goog.math.Long.TWO_PWR_16_DBL_=65536;goog.math.Long.TWO_PWR_24_DBL_=16777216;goog.math.Long.TWO_PWR_32_DBL_=goog.math.Long.TWO_PWR_16_DBL_*goog.math.Long.TWO_PWR_16_DBL_;goog.math.Long.TWO_PWR_31_DBL_=goog.math.Long.TWO_PWR_32_DBL_/2;goog.math.Long.TWO_PWR_48_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_16_DBL_;
goog.math.Long.TWO_PWR_64_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_32_DBL_;goog.math.Long.TWO_PWR_63_DBL_=goog.math.Long.TWO_PWR_64_DBL_/2;goog.math.Long.ZERO=goog.math.Long.fromInt(0);goog.math.Long.ONE=goog.math.Long.fromInt(1);goog.math.Long.NEG_ONE=goog.math.Long.fromInt(-1);goog.math.Long.MAX_VALUE=goog.math.Long.fromBits(-1,2147483647);goog.math.Long.MIN_VALUE=goog.math.Long.fromBits(0,-2147483648);goog.math.Long.TWO_PWR_24_=goog.math.Long.fromInt(16777216);
goog.math.Long.prototype.toInt=function(){return this.low_};goog.math.Long.prototype.toNumber=function(){return this.high_*goog.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()};
goog.math.Long.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(goog.math.Long.MIN_VALUE)){var b=goog.math.Long.fromNumber(a),d=this.div(b),b=d.multiply(b).subtract(this);return d.toString(a)+b.toInt().toString(a)}return"-"+this.negate().toString(a)}for(var d=goog.math.Long.fromNumber(Math.pow(a,6)),b=this,c="";;){var e=b.div(d),g=b.subtract(e.multiply(d)).toInt().toString(a),b=e;if(b.isZero())return g+
c;for(;6>g.length;)g="0"+g;c=""+g+c}};goog.math.Long.prototype.getHighBits=function(){return this.high_};goog.math.Long.prototype.getLowBits=function(){return this.low_};goog.math.Long.prototype.getLowBitsUnsigned=function(){return 0<=this.low_?this.low_:goog.math.Long.TWO_PWR_32_DBL_+this.low_};
goog.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(goog.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high_?this.high_:this.low_,b=31;0<b&&0==(a&1<<b);b--);return 0!=this.high_?b+33:b+1};goog.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_};goog.math.Long.prototype.isNegative=function(){return 0>this.high_};goog.math.Long.prototype.isOdd=function(){return 1==(this.low_&1)};
goog.math.Long.prototype.equals=function(a){return this.high_==a.high_&&this.low_==a.low_};goog.math.Long.prototype.notEquals=function(a){return this.high_!=a.high_||this.low_!=a.low_};goog.math.Long.prototype.lessThan=function(a){return 0>this.compare(a)};goog.math.Long.prototype.lessThanOrEqual=function(a){return 0>=this.compare(a)};goog.math.Long.prototype.greaterThan=function(a){return 0<this.compare(a)};goog.math.Long.prototype.greaterThanOrEqual=function(a){return 0<=this.compare(a)};
goog.math.Long.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),d=a.isNegative();return b&&!d?-1:!b&&d?1:this.subtract(a).isNegative()?-1:1};goog.math.Long.prototype.negate=function(){return this.equals(goog.math.Long.MIN_VALUE)?goog.math.Long.MIN_VALUE:this.not().add(goog.math.Long.ONE)};
goog.math.Long.prototype.add=function(a){var b=this.high_>>>16,d=this.high_&65535,c=this.low_>>>16,e=a.high_>>>16,g=a.high_&65535,f=a.low_>>>16,h;h=0+((this.low_&65535)+(a.low_&65535));a=0+(h>>>16);a+=c+f;c=0+(a>>>16);c+=d+g;d=0+(c>>>16);d=d+(b+e)&65535;return goog.math.Long.fromBits((a&65535)<<16|h&65535,d<<16|c&65535)};goog.math.Long.prototype.subtract=function(a){return this.add(a.negate())};
goog.math.Long.prototype.multiply=function(a){if(this.isZero()||a.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE))return a.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(a.equals(goog.math.Long.MIN_VALUE))return this.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(goog.math.Long.TWO_PWR_24_)&&
a.lessThan(goog.math.Long.TWO_PWR_24_))return goog.math.Long.fromNumber(this.toNumber()*a.toNumber());var b=this.high_>>>16,d=this.high_&65535,c=this.low_>>>16,e=this.low_&65535,g=a.high_>>>16,f=a.high_&65535,h=a.low_>>>16,a=a.low_&65535,i,k,j,l;l=0+e*a;j=0+(l>>>16);j+=c*a;k=0+(j>>>16);j=(j&65535)+e*h;k+=j>>>16;j&=65535;k+=d*a;i=0+(k>>>16);k=(k&65535)+c*h;i+=k>>>16;k&=65535;k+=e*f;i+=k>>>16;k&=65535;i=i+(b*a+d*h+c*f+e*g)&65535;return goog.math.Long.fromBits(j<<16|l&65535,i<<16|k)};
goog.math.Long.prototype.div=function(a){if(a.isZero())throw Error("division by zero");if(this.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE)){if(a.equals(goog.math.Long.ONE)||a.equals(goog.math.Long.NEG_ONE))return goog.math.Long.MIN_VALUE;if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ONE;var b=this.shiftRight(1).div(a).shiftLeft(1);if(b.equals(goog.math.Long.ZERO))return a.isNegative()?goog.math.Long.ONE:goog.math.Long.NEG_ONE;var d=this.subtract(a.multiply(b));
return b.add(d.div(a))}if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(var c=goog.math.Long.ZERO,d=this;d.greaterThanOrEqual(a);){for(var b=Math.max(1,Math.floor(d.toNumber()/a.toNumber())),e=Math.ceil(Math.log(b)/Math.LN2),e=48>=e?1:Math.pow(2,e-48),g=goog.math.Long.fromNumber(b),f=g.multiply(a);f.isNegative()||f.greaterThan(d);)b-=
e,g=goog.math.Long.fromNumber(b),f=g.multiply(a);g.isZero()&&(g=goog.math.Long.ONE);c=c.add(g);d=d.subtract(f)}return c};goog.math.Long.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))};goog.math.Long.prototype.not=function(){return goog.math.Long.fromBits(~this.low_,~this.high_)};goog.math.Long.prototype.and=function(a){return goog.math.Long.fromBits(this.low_&a.low_,this.high_&a.high_)};
goog.math.Long.prototype.or=function(a){return goog.math.Long.fromBits(this.low_|a.low_,this.high_|a.high_)};goog.math.Long.prototype.xor=function(a){return goog.math.Long.fromBits(this.low_^a.low_,this.high_^a.high_)};goog.math.Long.prototype.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.low_;return 32>a?goog.math.Long.fromBits(b<<a,this.high_<<a|b>>>32-a):goog.math.Long.fromBits(0,b<<a-32)};
goog.math.Long.prototype.shiftRight=function(a){a&=63;if(0==a)return this;var b=this.high_;return 32>a?goog.math.Long.fromBits(this.low_>>>a|b<<32-a,b>>a):goog.math.Long.fromBits(b>>a-32,0<=b?0:-1)};goog.math.Long.prototype.shiftRightUnsigned=function(a){a&=63;if(0==a)return this;var b=this.high_;return 32>a?goog.math.Long.fromBits(this.low_>>>a|b<<32-a,b>>>a):32==a?goog.math.Long.fromBits(b,0):goog.math.Long.fromBits(b>>>a-32,0)};(function(){var a=function(b){this.pifUint8Array=b;this.eepromStatusByte=128;this.controlsPresent=Array(4);this.eeprom=new Uint8Array(4096);this.controlsPresent[0]=!0;this.controlsPresent[1]=!1;this.controlsPresent[2]=!1;this.controlsPresent[3]=!1;this.g1964buttons=0;window.onkeydown=this.onKeyDown.bind(this);window.onkeyup=this.onKeyUp.bind(this)};a.prototype.processPif=function(){var b,a,c,e;c=0;e=consts.MEMORY_START_PIF_RAM-consts.MEMORY_START_PIF;if(255===this.pifUint8Array[e]&&255===this.pifUint8Array[e+
1]&&255===this.pifUint8Array[e+2]&&255===this.pifUint8Array[e+3])throw Error("todo: decrypt");for(a=0;64>a;){b=this.pifUint8Array[e+a];if(254===b)break;else if(255!==b&&253!==b&&180!==b&&86!==b&&184!==b)if(0===b)c+=1;else if(4===c){this.processEeprom(e,a);break}else if(4>c){if(!1===this.processController(a,c,e))break;c+=1;a+=b+(this.pifUint8Array[e+a+1]&63)+1}else{log("Device > 4. Device = "+c);break}a+=1}this.pifUint8Array[e+63]=0};a.prototype.processEeprom=function(b,a){switch(this.pifUint8Array[b+
a+2]){case 255:case 0:this.pifUint8Array[b+a+3]=0;this.pifUint8Array[b+a+4]=this.eepromStatusByte;this.pifUint8Array[b+a+5]=0;break;case 4:this.readEeprom(b,a+4,8*this.pifUint8Array[b+a+3]);break;case 5:this.writeEeprom(b,a+4,8*this.pifUint8Array[b+a+3])}return!1};a.prototype.readEeprom=function(b,a,c){this.pifUint8Array[b+a]=this.eeprom[c];this.pifUint8Array[b+a+1]=this.eeprom[c+1];this.pifUint8Array[b+a+2]=this.eeprom[c+2];this.pifUint8Array[b+a+3]=this.eeprom[c+3];this.pifUint8Array[b+a+4]=this.eeprom[c+
4];this.pifUint8Array[b+a+5]=this.eeprom[c+5];this.pifUint8Array[b+a+6]=this.eeprom[c+6];this.pifUint8Array[b+a+7]=this.eeprom[c+7]};a.prototype.writeEeprom=function(b,a,c){this.eeprom[c]=this.pifUint8Array[b+a];this.eeprom[c+1]=this.pifUint8Array[b+a+1];this.eeprom[c+2]=this.pifUint8Array[b+a+2];this.eeprom[c+3]=this.pifUint8Array[b+a+3];this.eeprom[c+4]=this.pifUint8Array[b+a+4];this.eeprom[c+5]=this.pifUint8Array[b+a+5];this.eeprom[c+6]=this.pifUint8Array[b+a+6];this.eeprom[c+7]=this.pifUint8Array[b+
a+7]};a.prototype.processController=function(b,a,c){if(!1===this.controlsPresent[a])return this.pifUint8Array[c+b+1]|=128,this.pifUint8Array[c+b+3]=0,this.pifUint8Array[c+b+4]=0,this.pifUint8Array[c+b+5]=0,!0;a=this.pifUint8Array[c+b+2];switch(a){case 255:case 0:this.pifUint8Array[c+b+3]=5;this.pifUint8Array[c+b+4]=0;this.pifUint8Array[c+b+5]=0;break;case 1:a=this.readControllerData();this.pifUint8Array[c+b+3]=a>>24;this.pifUint8Array[c+b+4]=a>>16;this.pifUint8Array[c+b+5]=a>>8;this.pifUint8Array[c+
b+6]=a;break;case 2:case 3:return log("todo: read/write controller pak"),!1;default:log("unknown controller command: "+a)}return!0};a.prototype.readControllerData=function(){return this.g1964buttons};("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsPif=a}).call(this);(function(){C1964jsPif.prototype.onKeyDown=function(a){if(a)switch(a.which){case 40:this.g1964buttons=this.g1964buttons&4294967040|128;break;case 38:this.g1964buttons=this.g1964buttons&4294967040|127;break;case 39:this.g1964buttons=this.g1964buttons&4294902015|32512;break;case 37:this.g1964buttons=this.g1964buttons&4294902015|32768;break;case 13:this.g1964buttons|=268435456;break;case 90:this.g1964buttons|=-2147483648;break;case 83:this.g1964buttons|=262144;break;case 87:this.g1964buttons|=524288;
break;case 68:this.g1964buttons|=65536;break;case 65:this.g1964buttons|=131072;break;case 88:this.g1964buttons|=1073741824;break;case 73:this.g1964buttons|=134217728;break;case 74:this.g1964buttons|=33554432;break;case 75:this.g1964buttons|=67108864;break;case 76:this.g1964buttons|=16777216;break;case 32:this.g1964buttons|=536870912;break;case 49:this.g1964buttons|=8388608;break;case 48:this.g1964buttons|=4194304}};C1964jsPif.prototype.onKeyUp=function(a){if(a)switch(a.which){case 40:this.g1964buttons&=
-129;break;case 38:this.g1964buttons&=-128;break;case 39:this.g1964buttons&=-32513;break;case 37:this.g1964buttons&=-32769;break;case 13:this.g1964buttons&=-268435457;break;case 90:this.g1964buttons&=2147483647;break;case 83:this.g1964buttons&=-262145;break;case 87:this.g1964buttons&=-524289;break;case 68:this.g1964buttons&=-65537;break;case 65:this.g1964buttons&=-131073;break;case 88:this.g1964buttons&=-1073741825;break;case 73:this.g1964buttons&=-134217729;break;case 74:this.g1964buttons&=-33554433;
break;case 75:this.g1964buttons&=-67108865;break;case 76:this.g1964buttons&=-16777217;break;case 32:this.g1964buttons&=-536870913;break;case 49:this.g1964buttons&=-8388609;break;case 48:this.g1964buttons&=-4194305;break;case 27:toggleUi()}}}).call(this);(function(){var a=function(b){this.core=b;this.rom=this.romUint8Array=void 0;this.rdramArrayBuffer=new ArrayBuffer(8388608);this.rdramUint8Array=new Uint8Array(this.rdramArrayBuffer);this.rdramUint16Array=new Uint16Array(this.rdramArrayBuffer);this.rdramUint32Array=new Uint32Array(this.rdramArrayBuffer);this.rdramDataView=new DataView(this.rdramArrayBuffer);this.spMemUint8Array=new Uint8Array(65536);this.spReg1Uint8Array=new Uint8Array(65536);this.spReg2Uint8Array=new Uint8Array(65536);this.dpcUint8Array=
new Uint8Array(65536);this.dpsUint8Array=new Uint8Array(65536);this.miUint8Array=new Uint8Array(65536);this.viUint8Array=new Uint8Array(65536);this.aiUint8Array=new Uint8Array(65536);this.piUint8Array=new Uint8Array(65536);this.siUint8Array=new Uint8Array(65536);this.c2a1Uint8Array=new Uint8Array(65536);this.c1a1Uint8Array=new Uint8Array(65536);this.c2a2Uint8Array=new Uint8Array(65536);this.c1a3Uint8Array=new Uint8Array(65536);this.riUint8Array=new Uint8Array(65536);this.pifUint8Array=new Uint8Array(65536);
this.gioUint8Array=new Uint8Array(65536);this.ramRegs0Uint8Array=new Uint8Array(65536);this.ramRegs4Uint8Array=new Uint8Array(65536);this.ramRegs8Uint8Array=new Uint8Array(65536);this.dummyReadWriteUint8Array=new Uint8Array(65536);this.region=[];this.region16=[];this.region32=[];this.writeRegion8=[];this.writeRegion16=[];this.writeRegion32=[];this.initRegion(0,2147483648,this.readTLB8,this.writeTLB8,this.readTLB16,this.writeTLB16,this.readTLB32,this.writeTLB32);this.initRegion(2147483648,1073741824,
this.readDummy8,this.writeDummy8,this.readDummy16,this.writeDummy16,this.readDummy32,this.writeDummy32);this.initRegion(3221225472,1073741824,this.readTLB8,this.writeTLB8,this.readTLB16,this.writeTLB16,this.readTLB32,this.writeTLB32);this.initRegion(0,8388608,this.readRdram8,this.writeRdram8,this.readRdram16,this.writeRdram16,this.readRdram32,this.writeRdram32);this.initRegion(66076672,66076672,this.readRamRegs4,this.writeRamRegs4,this.readRamRegs4,this.writeRamRegs4,this.readRamRegs4,this.writeRamRegs4);
this.initRegion(67108864,65536,this.readSpMem8,this.writeSpMem8,this.readSpMem16,this.writeSpMem16,this.readSpMem32,this.writeSpMem32);this.initRegion(67371008,65536,this.readSpReg1_8,this.writeSpReg1_8,this.readSpReg1_16,this.writeSpReg1_16,this.readSpReg1_32,this.writeSpReg1_32);this.initRegion(67633152,65536,this.readSpReg2_8,this.writeSpReg2_8,this.readSpReg2_16,this.writeSpReg2_16,this.readSpReg2_32,this.writeSpReg2_32);this.initRegion(68157440,65536,this.readDpc8,this.writeDpc8,this.readDpc16,
this.writeDpc16,this.readDpc32,this.writeDpc32);this.initRegion(69206016,65536,this.readDps8,this.writeDps8,this.readDps16,this.writeDps16,this.readDps32,this.writeDps32);this.initRegion(70254592,65536,this.readMi8,this.writeMi8,this.readMi16,this.writeMi16,this.readMi32,this.writeMi32);this.initRegion(71303168,65536,this.readVi8,this.writeVi8,this.readVi16,this.writeVi16,this.readVi32,this.writeVi32);this.initRegion(72351744,65536,this.readAi8,this.writeAi8,this.readAi16,this.writeAi16,this.readAi32,
this.writeAi32);this.initRegion(73400320,65536,this.readPi8,this.writePi8,this.readPi16,this.writePi16,this.readPi32,this.writePi32);this.initRegion(75497472,65536,this.readSi8,this.writeSi8,this.readSi16,this.writeSi16,this.readSi32,this.writeSi32);this.initRegion(83886080,65536,this.readC2A1_8,this.writeC2A1_8,this.readC2A1_16,this.writeC2A1_16,this.readC2A1_32,this.writeC2A1_32);this.initRegion(100663296,65536,this.readC1A1_8,this.writeC1A1_8,this.readC1A1_16,this.writeC1A1_16,this.readC1A1_32,
this.writeC1A1_32);this.initRegion(134217728,131072,this.readC2A2_8,this.writeC2A2_8,this.readC2A2_16,this.writeC2A2_16,this.readC2A2_32,this.writeC2A2_32);this.initRegion(268435456,67108864,this.readRom8,this.writeRom8,this.readRom16,this.writeRom16,this.readRom32,this.writeRom);this.initRegion(533725184,65536,this.readC1A3_8,this.writeC1A3_8,this.readC1A3_16,this.writeC1A3_16,this.readC1A3_32,this.writeC1A3_32);this.initRegion(74448896,65536,this.readRi8,this.writeRi8,this.readRi16,this.writeRi16,
this.readRi32,this.writeRi32);this.initRegion(532676608,65536,this.readPif8,this.writePif8,this.readPif16,this.writePif16,this.readPif32,this.writePif32);this.initRegion(402653184,65536,this.readGio8,this.writeGio8,this.readGio16,this.writeGio16,this.readGio32,this.writeGio32);this.initRegion(66060288,65536,this.readRamRegs0_8,this.writeRamRegs0_8,this.readRamRegs0_16,this.writeRamRegs0_16,this.readRamRegs0_32,this.writeRamRegs0_32);this.initRegion(66584576,65536,this.readRamRegs8_8,this.writeRamRegs8_8,
this.readRamRegs8_16,this.writeRamRegs8_16,this.readRamRegs8_32,this.writeRamRegs8_32);this.physRegion=void 0};a.prototype.initRegion=function(b,a,c,e,g,f,h,i){a=b+a>>>14;for(b>>>=14;b<a;)this.region[b]=c,this.region16[b]=g,this.region32[b]=h,this.writeRegion8[b]=e,this.writeRegion16[b]=f,this.writeRegion32[b]=i,b++};a.prototype.readDummy8=function(b,a){return b.dummyReadWriteUint8Array[a&65532]};a.prototype.readDummy16=function(b,a){var c;c=a&65532;return b.dummyReadWriteUint8Array[c]<<8|b.dummyReadWriteUint8Array[c+
1]};a.prototype.readDummy32=function(b,a){var c;c=a&65532;return b.dummyReadWriteUint8Array[c]<<24|b.dummyReadWriteUint8Array[c+1]<<16|b.dummyReadWriteUint8Array[c+2]<<8|b.dummyReadWriteUint8Array[c+3]};a.prototype.readRdram8=function(b,a){return b.rdramUint8Array[a-0]};a.prototype.readRdram16=function(b,a){var c;c=a-0;return b.rdramUint8Array[c]<<8|b.rdramUint8Array[c+1]};a.prototype.readRdram32=function(b,a){var c;c=a-0;return b.rdramUint8Array[c]<<24|b.rdramUint8Array[c+1]<<16|b.rdramUint8Array[c+
2]<<8|b.rdramUint8Array[c+3]};a.prototype.readRamRegs0_8=function(b,a){return b.ramRegs0Uint8Array[a-66060288]};a.prototype.readRamRegs0_16=function(b,a){var c;c=a-66060288;return b.ramRegs0Uint8Array[c]<<8|b.ramRegs0Uint8Array[c+1]};a.prototype.readRamRegs0_32=function(b,a){var c;c=a-66060288;return b.ramRegs0Uint8Array[c]<<24|b.ramRegs0Uint8Array[c+1]<<16|b.ramRegs0Uint8Array[c+2]<<8|b.ramRegs0Uint8Array[c+3]};a.prototype.readRamRegs4_8=function(b,a){return b.ramRegs4Uint8Array[a-66076672]};a.prototype.readRamRegs4_16=
function(b,a){var c;c=a-66076672;return b.ramRegs4Uint8Array[c]<<8|b.ramRegs4Uint8Array[c+1]};a.prototype.readRamRegs4_32=function(b,a){var c;c=a-66076672;return b.ramRegs4Uint8Array[c]<<24|b.ramRegs4Uint8Array[c+1]<<16|b.ramRegs4Uint8Array[c+2]<<8|b.ramRegs4Uint8Array[c+3]};a.prototype.readRamRegs8_8=function(b,a){return b.ramRegs8Uint8Array[a-66584576]};a.prototype.readRamRegs8_16=function(b,a){var c;c=a-66584576;return b.ramRegs8Uint8Array[c]<<8|b.ramRegs8Uint8Array[c+1]};a.prototype.readRamRegs8_32=
function(b,a){var c;c=a-66584576;return b.ramRegs8Uint8Array[c]<<24|b.ramRegs8Uint8Array[c+1]<<16|b.ramRegs8Uint8Array[c+2]<<8|b.ramRegs8Uint8Array[c+3]};a.prototype.readSpMem8=function(b,a){return b.spMemUint8Array[a-67108864]};a.prototype.readSpMem16=function(b,a){var c;c=a-67108864;return b.spMemUint8Array[c]<<8|b.spMemUint8Array[c+1]};a.prototype.readSpMem32=function(b,a){var c;c=a-67108864;return b.spMemUint8Array[c]<<24|b.spMemUint8Array[c+1]<<16|b.spMemUint8Array[c+2]<<8|b.spMemUint8Array[c+
3]};a.prototype.readSpReg1_8=function(b,a){return b.core.interrupts.readSPReg1(a-67371008)};a.prototype.readSpReg1_16=function(b,a){return b.core.interrupts.readSPReg1(a-67371008)};a.prototype.readSpReg1_32=function(b,a){return b.core.interrupts.readSPReg1(a-67371008)};a.prototype.readSpReg2_8=function(b,a){return b.spReg2Uint8Array[a-67633152]};a.prototype.readSpReg2_16=function(b,a){var c;c=a-67633152;return b.spReg2Uint8Array[c]<<8|b.spReg2Uint8Array[c+1]};a.prototype.readSpReg2_32=function(b,
a){var c;c=a-67633152;return b.spReg2Uint8Array[c]<<24|b.spReg2Uint8Array[c+1]<<16|b.spReg2Uint8Array[c+2]<<8|b.spReg2Uint8Array[c+3]};a.prototype.readDpc8=function(b,a){return b.dpcUint8Array[a-68157440]};a.prototype.readDpc16=function(b,a){var c;c=a-68157440;return b.dpcUint8Array[c]<<8|b.dpcUint8Array[c+1]};a.prototype.readDpc32=function(b,a){var c;c=a-68157440;return b.dpcUint8Array[c]<<24|b.dpcUint8Array[c+1]<<16|b.dpcUint8Array[c+2]<<8|b.dpcUint8Array[c+3]};a.prototype.readDps8=function(b,a){return b.dpsUint8Array[a-
69206016]};a.prototype.readDps16=function(b,a){var c;c=a-69206016;return b.dpsUint8Array[c]<<8|b.dpsUint8Array[c+1]};a.prototype.readDps32=function(b,a){var c;c=a-69206016;return b.dpsUint8Array[c]<<24|b.dpsUint8Array[c+1]<<16|b.dpsUint8Array[c+2]<<8|b.dpsUint8Array[c+3]};a.prototype.readMi8=function(b,a){return b.miUint8Array[a-70254592]};a.prototype.readMi16=function(b,a){var c;c=a-70254592;return b.miUint8Array[c]<<8|b.miUint8Array[c+1]};a.prototype.readMi32=function(b,a){var c;c=a-70254592;return b.miUint8Array[c]<<
24|b.miUint8Array[c+1]<<16|b.miUint8Array[c+2]<<8|b.miUint8Array[c+3]};a.prototype.readVi8=function(b,a){return b.core.interrupts.readVI(a-71303168)};a.prototype.readVi16=function(b,a){return b.core.interrupts.readVI(a-71303168)};a.prototype.readVi32=function(b,a){return b.core.interrupts.readVI(a-71303168)};a.prototype.readAi8=function(b,a){return b.core.interrupts.readAI(a-72351744)};a.prototype.readAi16=function(b,a){return b.core.interrupts.readAI(a-72351744)};a.prototype.readAi32=function(b,
a){return b.core.interrupts.readAI(a-72351744)};a.prototype.readPi8=function(b,a){return b.piUint8Array[a-73400320]};a.prototype.readPi16=function(b,a){var c;c=a-73400320;return b.piUint8Array[c]<<8|b.piUint8Array[c+1]};a.prototype.readPi32=function(b,a){var c;c=a-73400320;return b.piUint8Array[c]<<24|b.piUint8Array[c+1]<<16|b.piUint8Array[c+2]<<8|b.piUint8Array[c+3]};a.prototype.readSi8=function(b,a){return b.core.interrupts.readSI(a-75497472)};a.prototype.readSi16=function(b,a){return b.core.interrupts.readSI(a-
75497472)};a.prototype.readSi32=function(b,a){return b.core.interrupts.readSI(a-75497472)};a.prototype.readC2A1_8=function(b,a){return b.c2a1Uint8Array[a-83886080]};a.prototype.readC2A1_16=function(b,a){var c;c=a-83886080;return b.c2a1Uint8Array[c]<<8|b.c2a1Uint8Array[c+1]};a.prototype.readC2A1_32=function(b,a){var c;c=a-83886080;return b.c2a1Uint8Array[c]<<24|b.c2a1Uint8Array[c+1]<<16|b.c2a1Uint8Array[c+2]<<8|b.c2a1Uint8Array[c+3]};a.prototype.readC1A1_8=function(b,a){return b.c1a1Uint8Array[a-100663296]};
a.prototype.readC1A1_16=function(b,a){var c;c=a-100663296;return b.c1a1Uint8Array[c]<<8|b.c1a1Uint8Array[c+1]};a.prototype.readC1A1_32=function(b,a){var c;c=a-100663296;return b.c1a1Uint8Array[c]<<24|b.c1a1Uint8Array[c+1]<<16|b.c1a1Uint8Array[c+2]<<8|b.c1a1Uint8Array[c+3]};a.prototype.readC2A2_8=function(b,a){return b.c2a2Uint8Array[a-134217728]};a.prototype.readC2A2_16=function(b,a){var c;c=a-134217728;return b.c2a2Uint8Array[c]<<8|b.c2a2Uint8Array[c+1]};a.prototype.readC2A2_32=function(b,a){var c;
c=a-134217728;return b.c2a2Uint8Array[c]<<24|b.c2a2Uint8Array[c+1]<<16|b.c2a2Uint8Array[c+2]<<8|b.c2a2Uint8Array[c+3]};a.prototype.readRom8=function(b,a){return b.romUint8Array[a-268435456]};a.prototype.readRom16=function(b,a){var c;c=a-268435456;return b.romUint8Array[c]<<8|b.romUint8Array[c+1]};a.prototype.readRom32=function(b,a){var c;c=a-268435456;return b.romUint8Array[c]<<24|b.romUint8Array[c+1]<<16|b.romUint8Array[c+2]<<8|b.romUint8Array[c+3]};a.prototype.readC1A3_8=function(b,a){return b.c1a3Uint8Array[a-
533725184]};a.prototype.readC1A3_16=function(b,a){var c;c=a-533725184;return b.c1a3Uint8Array[c]<<8|b.c1a3Uint8Array[c+1]};a.prototype.readC1A3_32=function(b,a){var c;c=a-533725184;return b.c1a3Uint8Array[c]<<24|b.c1a3Uint8Array[c+1]<<16|b.c1a3Uint8Array[c+2]<<8|b.c1a3Uint8Array[c+3]};a.prototype.readRi8=function(b,a){return b.riUint8Array[a-74448896]};a.prototype.readRi16=function(b,a){var c;c=a-74448896;return b.riUint8Array[c]<<8|b.riUint8Array[c+1]};a.prototype.readRi32=function(b,a){var c;c=
a-74448896;return b.riUint8Array[c]<<24|b.riUint8Array[c+1]<<16|b.riUint8Array[c+2]<<8|b.riUint8Array[c+3]};a.prototype.readPif8=function(b,a){return b.pifUint8Array[a-532676608]};a.prototype.readPif16=function(b,a){var c;c=a-532676608;return b.pifUint8Array[c]<<8|b.pifUint8Array[c+1]};a.prototype.readPif32=function(b,a){var c;c=a-532676608;return b.pifUint8Array[c]<<24|b.pifUint8Array[c+1]<<16|b.pifUint8Array[c+2]<<8|b.pifUint8Array[c+3]};a.prototype.readGio8=function(b,a){return b.gioUint8Array[a-
402653184]};a.prototype.readGio16=function(b,a){var c;c=a-402653184;return b.gioUint8Array[c]<<8|b.gioUint8Array[c+1]};a.prototype.readGio32=function(b,a){var c;c=a-402653184;return b.gioUint8Array[c]<<24|b.gioUint8Array[c+1]<<16|b.gioUint8Array[c+2]<<8|b.gioUint8Array[c+3]};a.prototype.writeRdram8=function(b,a,c){b.rdramUint8Array[c-0]=a};a.prototype.writeRdram16=function(b,a,c){c-=0;b.rdramUint8Array[c]=a>>8;b.rdramUint8Array[c+1]=a};a.prototype.writeRdram32=function(b,a,c){c-=0;b.rdramUint8Array[c]=
a>>24;b.rdramUint8Array[c+1]=a>>16;b.rdramUint8Array[c+2]=a>>8;b.rdramUint8Array[c+3]=a};a.prototype.writeSpMem8=function(b,a,c){b.spMemUint8Array[c-67108864]=a};a.prototype.writeSpMem16=function(b,a,c){c-=67108864;b.spMemUint8Array[c]=a>>8;b.spMemUint8Array[c+1]=a};a.prototype.writeSpMem32=function(b,a,c){c-=67108864;b.spMemUint8Array[c]=a>>24;b.spMemUint8Array[c+1]=a>>16;b.spMemUint8Array[c+2]=a>>8;b.spMemUint8Array[c+3]=a};a.prototype.writeRi8=function(b,a,c){b.riUint8Array[c-74448896]=a};a.prototype.writeRi16=
function(b,a,c){c-=74448896;b.riUint8Array[c]=a>>8;b.riUint8Array[c+1]=a};a.prototype.writeRi32=function(b,a,c){c-=74448896;b.riUint8Array[c]=a>>24;b.riUint8Array[c+1]=a>>16;b.riUint8Array[c+2]=a>>8;b.riUint8Array[c+3]=a};a.prototype.writeMi8=function(b,a,c,e,g){b.core.interrupts.writeMI(c-70254592,a,e,g)};a.prototype.writeMi16=function(b,a,c,e,g){b.core.interrupts.writeMI(c-70254592,a,e,g)};a.prototype.writeMi32=function(b,a,c,e,g){b.core.interrupts.writeMI(c-70254592,a,e,g)};a.prototype.writeRamRegs8_8=
function(b,a,c){b.ramRegs8Uint8Array[c-66584576]=a};a.prototype.writeRamRegs8_16=function(b,a,c){c-=66584576;b.ramRegs8Uint8Array[c]=a>>8;b.ramRegs8Uint8Array[c+1]=a};a.prototype.writeRamRegs8_32=function(b,a,c){c-=66584576;b.ramRegs8Uint8Array[c]=a>>24;b.ramRegs8Uint8Array[c+1]=a>>16;b.ramRegs8Uint8Array[c+2]=a>>8;b.ramRegs8Uint8Array[c+3]=a};a.prototype.writeRamRegs4_8=function(b,a,c){b.ramRegs4Uint8Array[c-66076672]=a};a.prototype.writeRamRegs4_16=function(b,a,c){c-=66076672;b.ramRegs4Uint8Array[c]=
a>>8;b.ramRegs4Uint8Array[c+1]=a};a.prototype.writeRamRegs4_32=function(b,a,c){c-=66076672;b.ramRegs4Uint8Array[c]=a>>24;b.ramRegs4Uint8Array[c+1]=a>>16;b.ramRegs4Uint8Array[c+2]=a>>8;b.ramRegs4Uint8Array[c+3]=a};a.prototype.writeRamRegs0_8=function(b,a,c){b.ramRegs0Uint8Array[c-66060288]=a};a.prototype.writeRamRegs0_16=function(b,a,c){c-=66060288;b.ramRegs0Uint8Array[c]=a>>8;b.ramRegs0Uint8Array[c+1]=a};a.prototype.writeRamRegs0_32=function(b,a,c){c-=66060288;b.ramRegs0Uint8Array[c]=a>>24;b.ramRegs0Uint8Array[c+
1]=a>>16;b.ramRegs0Uint8Array[c+2]=a>>8;b.ramRegs0Uint8Array[c+3]=a};a.prototype.writeSpReg1_8=function(b,a,c,e,g){b.core.interrupts.writeSPReg1(c-67371008,a,e,g)};a.prototype.writeSpReg1_16=function(b,a,c,e,g){b.core.interrupts.writeSPReg1(c-67371008,a,e,g)};a.prototype.writeSpReg1_32=function(b,a,c,e,g){b.core.interrupts.writeSPReg1(c-67371008,a,e,g)};a.prototype.writePi8=function(b,a,c,e,g){b.core.interrupts.writePI(c-73400320,a,e,g)};a.prototype.writePi16=function(b,a,c,e,g){b.core.interrupts.writePI(c-
73400320,a,e,g)};a.prototype.writePi32=function(b,a,c,e,g){b.core.interrupts.writePI(c-73400320,a,e,g)};a.prototype.writeSi8=function(b,a,c,e,g){b.core.interrupts.writeSI(c-75497472,a,e,g)};a.prototype.writeSi16=function(b,a,c,e,g){b.core.interrupts.writeSI(c-75497472,a,e,g)};a.prototype.writeSi32=function(b,a,c,e,g){b.core.interrupts.writeSI(c-75497472,a,e,g)};a.prototype.writeAi8=function(b,a,c,e,g){b.core.interrupts.writeAI(c-72351744,a,e,g)};a.prototype.writeAi16=function(b,a,c,e,g){b.core.interrupts.writeAI(c-
72351744,a,e,g)};a.prototype.writeAi32=function(b,a,c,e,g){b.core.interrupts.writeAI(c-72351744,a,e,g)};a.prototype.writeVi8=function(b,a,c,e,g){b.core.interrupts.writeVI(c-71303168,a,e,g)};a.prototype.writeVi16=function(b,a,c,e,g){b.core.interrupts.writeVI(c-71303168,a,e,g)};a.prototype.writeVi32=function(b,a,c,e,g){b.core.interrupts.writeVI(c-71303168,a,e,g)};a.prototype.writeSpReg2_8=function(b,a,c,e,g){b.core.interrupts.writeSPReg2(c-67633152,a,e,g)};a.prototype.writeSpReg2_16=function(b,a,c,
e,g){b.core.interrupts.writeSPReg2(c-67633152,a,e,g)};a.prototype.writeSpReg2_32=function(b,a,c,e,g){b.core.interrupts.writeSPReg2(c-67633152,a,e,g)};a.prototype.writeDpc8=function(b,a,c,e,g){b.core.interrupts.writeDPC(c-68157440,a,e,g)};a.prototype.writeDpc16=function(b,a,c,e,g){b.core.interrupts.writeDPC(c-68157440,a,e,g)};a.prototype.writeDpc32=function(b,a,c,e,g){b.core.interrupts.writeDPC(c-68157440,a,e,g)};a.prototype.writeDps8=function(b,a,c){b.dpsUint8Array[c-69206016]=a};a.prototype.writeDps16=
function(b,a,c){c-=69206016;b.dpsUint8Array[c]=a>>8;b.dpsUint8Array[c+1]=a};a.prototype.writeDps32=function(b,a,c){c-=69206016;b.dpsUint8Array[c]=a>>24;b.dpsUint8Array[c+1]=a>>16;b.dpsUint8Array[c+2]=a>>8;b.dpsUint8Array[c+3]=a};a.prototype.writeC2A1_8=function(b,a,c){b.c2a1Uint8Array[c-83886080]=a};a.prototype.writeC2A1_16=function(b,a,c){c-=83886080;b.c2a1Uint8Array[c]=a>>8;b.c2a1Uint8Array[c+1]=a};a.prototype.writeC2A1_32=function(b,a,c){c-=83886080;b.c2a1Uint8Array[c]=a>>24;b.c2a1Uint8Array[c+
1]=a>>16;b.c2a1Uint8Array[c+2]=a>>8;b.c2a1Uint8Array[c+3]=a};a.prototype.writeC1A1_8=function(b,a,c){b.c1a1Uint8Array[c-100663296]=a};a.prototype.writeC1A1_16=function(b,a,c){c-=100663296;b.c1a1Uint8Array[c]=a>>8;b.c1a1Uint8Array[c+1]=a};a.prototype.writeC1A1_32=function(b,a,c){c-=100663296;b.c1a1Uint8Array[c]=a>>24;b.c1a1Uint8Array[c+1]=a>>16;b.c1a1Uint8Array[c+2]=a>>8;b.c1a1Uint8Array[c+3]=a};a.prototype.writeC2A2_8=function(b,a,c){b.c2a2Uint8Array[c-134217728]=a};a.prototype.writeC2A2_16=function(b,
a,c){c-=134217728;b.c2a2Uint8Array[c]=a>>8;b.c2a2Uint8Array[c+1]=a};a.prototype.writeC2A2_32=function(b,a,c){c-=134217728;b.c2a2Uint8Array[c]=a>>24;b.c2a2Uint8Array[c+1]=a>>16;b.c2a2Uint8Array[c+2]=a>>8;b.c2a2Uint8Array[c+3]=a};a.prototype.writeRom8=function(b,a,c){alert("attempt to overwrite rom!");b.romUint8Array[c-268435456]=a};a.prototype.writeRom16=function(b,a,c){c-=268435456;b.romUint8Array[c]=a>>8;b.romUint8Array[c+1]=a};a.prototype.writeRom32=function(b,a,c){c-=268435456;b.romUint8Array[c]=
a>>24;b.romUint8Array[c+1]=a>>16;b.romUint8Array[c+2]=a>>8;b.romUint8Array[c+3]=a};a.prototype.writeC1A3_8=function(b,a,c){b.c1a3Uint8Array[c-533725184]=a};a.prototype.writeC1A3_16=function(b,a,c){c-=533725184;b.c1a3Uint8Array[c]=a>>8;b.c1a3Uint8Array[c+1]=a};a.prototype.writeC1A3_32=function(b,a,c){c-=533725184;b.c1a3Uint8Array[c]=a>>24;b.c1a3Uint8Array[c+1]=a>>16;b.c1a3Uint8Array[c+2]=a>>8;b.c1a3Uint8Array[c+3]=a};a.prototype.writePif8=function(b,a,c){b.pifUint8Array[c-532676608]=a};a.prototype.writePif16=
function(b,a,c){c-=532676608;b.pifUint8Array[c]=a>>8;b.pifUint8Array[c+1]=a};a.prototype.writePif32=function(b,a,c){c-=532676608;b.pifUint8Array[c]=a>>24;b.pifUint8Array[c+1]=a>>16;b.pifUint8Array[c+2]=a>>8;b.pifUint8Array[c+3]=a};a.prototype.writeGio8=function(b,a,c){b.gioUint8Array[c-402653184]=a};a.prototype.writeGio16=function(b,a,c){c-=402653184;b.gioUint8Array[c]=a>>8;b.gioUint8Array[c+1]=a};a.prototype.writeGio32=function(b,a,c){c-=402653184;b.gioUint8Array[c]=a>>24;b.gioUint8Array[c+1]=a>>
16;b.gioUint8Array[c+2]=a>>8;b.gioUint8Array[c+3]=a};a.prototype.writeDummy8=function(b,a,c){b.dummyReadWriteUint8Array[c&65532]=a};a.prototype.writeDummy16=function(b,a,c){c&=65532;b.dummyReadWriteUint8Array[c]=a>>8;b.dummyReadWriteUint8Array[c+1]=a};a.prototype.writeDummy32=function(b,a,c){c&=65532;b.dummyReadWriteUint8Array[c]=a>>24;b.dummyReadWriteUint8Array[c+1]=a>>16;b.dummyReadWriteUint8Array[c+2]=a>>8;b.dummyReadWriteUint8Array[c+3]=a};a.prototype.virtualToPhysical=function(b){return this.physRegion[b>>>
12]<<16|b&65535};a.prototype.readTLB8=function(b,a){var c,a=b.virtualToPhysical(a);c=b.region[a>>>14];c===b.readTLB8&&(c=b.readDummy8);return c(b,a)};a.prototype.writeTLB8=function(b,a,c,e,g){var f,c=b.virtualToPhysical(c);f=b.writeRegion8[c>>>14];f===b.writeTLB8&&(f=b.writeDummy8);f(b,a,c,e,g)};a.prototype.readTLB16=function(b,a){var c,a=b.virtualToPhysical(a);c=b.region16[a>>>14];c===b.readTLB16&&(c=b.readDummy16);return c(b,a)};a.prototype.writeTLB16=function(b,a,c,e,g){var f,c=b.virtualToPhysical(c);
f=b.writeRegion16[c>>>14];f===b.writeTLB16&&(f=b.writeDummy16);f(b,a,c,e,g)};a.prototype.readTLB32=function(b,a){var c,a=b.virtualToPhysical(a);c=b.region32[a>>>14];c===b.readTLB32&&(c=b.readDummy32);return c(b,a)};a.prototype.writeTLB32=function(b,a,c,e,g){var f,c=b.virtualToPhysical(c);f=b.writeRegion32[c>>>14];f===b.writeTLB32&&(f=b.writeDummy);f(b,a,c,e,g)};a.prototype.initPhysRegions=function(){var b;this.physRegion=new Int16Array(1048576);for(b=0;1048576>b;)this.physRegion[b]=(b&131071)>>>4,
b++};a.prototype.getInt8=function(b,a){return b[a]};a.prototype.getInt16=function(b,a){return b[a]<<8|b[a+1]};a.prototype.getInt32=function(b,a,c){return a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3]};a.prototype.getUint32=function(b,a){return b[a]<<24|b[a+1]<<16|b[a+2]<<8|b[a+3]};a.prototype.setInt8=function(b,a,c){b[a]=c};a.prototype.setInt32=function(b,a,c){b[a]=c>>24;b[a+1]=c>>16;b[a+2]=c>>8;b[a+3]=c};a.prototype.setInt16=function(b,a,c){b[a]=c>>8;b[a+1]=c};a.prototype.lb=function(b){b=this.virtualToPhysical(b);
return this.region[b>>>14](this,b)};a.prototype.lh=function(b){b=this.virtualToPhysical(b);return this.region16[b>>>14](this,b)};a.prototype.lw=function(b){b=this.virtualToPhysical(b);return this.region32[b>>>14](this,b)};a.prototype.sw=function(b,a,c,e){a=this.virtualToPhysical(a);this.writeRegion32[a>>>14](this,b,a,c,e)};a.prototype.sb=function(b,a,c,e){a=this.virtualToPhysical(a);this.writeRegion8[a>>>14](this,b,a,c,e)};a.prototype.sh=function(b,a,c,e){a=this.virtualToPhysical(a);this.writeRegion16[a>>>
14](this,b,a,c,e)};("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsMemory=a}).call(this);(function(){C1964jsEmulator.prototype.flushDynaCache=function(){var a;a=void 0;if(!1===this.writeToDom){for(a in this.code)delete this.code[a],this.code[a]&&alert("@code[pc] failed to delete.");delete this.code;this.code={}}else for(;this.kk;)this.kk-=1,this.deleteFunction(this.kk)};C1964jsEmulator.prototype.deleteFunction=function(a){var b,a=document.getElementsByTagName("script")[a];b=a.text.split("_");b=b[1].split("(");b="_"+b[0];a.parentNode.removeChild(a);eval(b+"= function (r, s, t, v){}; delete "+
b+";");window[b]=null;window[b]&&alert("window[fnName] should have been null.")}}).call(this);(function(){var a=function(){};a.prototype.processAudio=function(){};("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsAudio=a}).call(this);(function(){var a,b=function(b,a,e){this.startTime=0;this.memory=b;this.interrupts=a;this.pif=e;this.audio=void 0};b.prototype.copyCartToDram=function(b,a){var e,g,f,h;e=this.memory.getInt32(this.memory.piUint8Array,this.memory.piUint8Array,consts.PI_WR_LEN_REG);f=this.memory.getInt32(this.memory.piUint8Array,this.memory.piUint8Array,consts.PI_DRAM_ADDR_REG);g=this.memory.getInt32(this.memory.piUint8Array,this.memory.piUint8Array,consts.PI_CART_ADDR_REG);log("pi dma write "+(e+1)+" bytes from "+dec2hex(g)+
" to "+dec2hex(f));e&=16777215;f&=16777215;h=e;if(0!==(g&268435456)){g&=268435455;for(g+e+1>this.memory.rom.byteLength&&(h=this.memory.rom.byteLength-g-1);0<=h;)this.memory.rdramUint8Array[f]=this.memory.romUint8Array[g],f++,g++,--h}else for(alert("pi reading from somewhere other than cartridge domain");0<=e--;)this.memory.rdramUint8Array[f]=this.memory.lb(g),g++,f++;this.interrupts.clrFlag(this.memory.piUint8Array,consts.PI_STATUS_REG,consts.PI_STATUS_IO_BUSY|consts.PI_STATUS_DMA_BUSY);this.interrupts.triggerPIInterrupt(b,
a)};b.prototype.copySiToDram=function(b,a){var e,g,f;e=63;f=this.memory.getInt32(this.memory.siUint8Array,this.memory.siUint8Array,consts.SI_DRAM_ADDR_REG);g=this.memory.getInt32(this.memory.siUint8Array,this.memory.siUint8Array,consts.SI_PIF_ADDR_RD64B_REG);if(532678592!==g)throw Error("Unhandled: SI_DRAM_ADDR_RD64B_REG = "+g);log("si dma write "+(e+1)+" bytes from "+dec2hex(g)+" to "+dec2hex(f));e&=16777215;f&=268435455;g&=65535;for(this.pif.processPif();0<=e;)this.memory.rdramUint8Array[f]=this.memory.pifUint8Array[g],
f++,g++,--e;this.interrupts.setFlag(this.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT);this.interrupts.triggerSIInterrupt(b,a)};b.prototype.copyDramToAi=function(){var b,a;a=this.memory.getInt32(this.memory.aiUint8Array,this.memory.aiUint8Array,consts.AI_LEN_REG);b=this.memory.getInt32(this.memory.aiUint8Array,this.memory.aiUint8Array,consts.AI_DRAM_ADDR_REG);a&=16777215;b&=268435455;void 0===this.audio&&(this.audio=new C1964jsAudio);!1===this.audio.processAudio(this.memory,
b,a)&&this.interrupts.clrFlag(this.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL);this.interrupts.setFlag(this.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL)};b.prototype.copyDramToSi=function(b,a){var e,g,f;e=63;f=this.memory.getInt32(this.memory.siUint8Array,this.memory.siUint8Array,consts.SI_PIF_ADDR_WR64B_REG);g=this.memory.getInt32(this.memory.siUint8Array,this.memory.siUint8Array,consts.SI_DRAM_ADDR_REG);if(532678592!==f)throw Error("Unhandled: SI_DRAM_ADDR_RD64B_REG = "+
g);log("si dma read "+(e+1)+" bytes from "+dec2hex(g)+" to "+dec2hex(f));e&=16777215;f&=65535;for(g&=268435455;0<=e;)this.memory.pifUint8Array[f]=this.memory.rdramUint8Array[g],f++,g++,--e;this.interrupts.setFlag(this.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT);this.interrupts.triggerSIInterrupt(b,a)};b.prototype.copySpToDram=function(){alert("todo: copySpToDram")};b.prototype.copyDramToSp=function(){var b,a,e;b=this.memory.getInt32(this.memory.spReg1Uint8Array,this.memory.spReg1Uint8Array,
consts.SP_RD_LEN_REG);e=this.memory.getInt32(this.memory.spReg1Uint8Array,this.memory.spReg1Uint8Array,consts.SP_MEM_ADDR_REG);a=this.memory.getInt32(this.memory.spReg1Uint8Array,this.memory.spReg1Uint8Array,consts.SP_DRAM_ADDR_REG);log("sp dma read "+(b+1)+" bytes from "+dec2hex(a)+" to "+dec2hex(e));b&=4095;e&=8191;for(a&=16777215;0<=b;)this.memory.spMemUint8Array[e]=this.memory.rdramUint8Array[a],e++,a++,--b;this.memory.setInt32(this.memory.spReg1Uint8Array,consts.SP_DMA_BUSY_REG,0);this.memory.getInt32(this.memory.spReg1Uint8Array,
this.memory.spReg1Uint8Array,consts.SP_STATUS_REG)&(consts.SP_STATUS_DMA_BUSY|consts.SP_STATUS_IO_FULL|consts.SP_STATUS_DMA_FULL)&&alert("hmm..todo: an sp fp status flag is blocking from continuing");this.interrupts.clrFlag(this.memory.spReg1Uint8Array,consts.SP_STATUS_REG,consts.SP_STATUS_DMA_BUSY);this.interrupts.setFlag(this.memory.spReg1Uint8Array,consts.SP_STATUS_REG,consts.SP_STATUS_HALT)};a="undefined"!==typeof exports&&null!==exports?exports:this;a.C1964jsDMA=b;a.log=function(){}}).call(this);(function(){SP_STATUS_HALT=1;SP_STATUS_BROKE=2;SP_STATUS_DMA_BUSY=4;SP_STATUS_DMA_FULL=8;SP_STATUS_IO_FULL=16;SP_STATUS_SSTEP=32;SP_STATUS_INTR_BREAK=64;SP_STATUS_YIELD=128;SP_STATUS_YIELDED=256;SP_STATUS_TASKDONE=512;SP_STATUS_SIG3=1024;SP_STATUS_SIG4=2048;SP_STATUS_SIG5=4096;SP_STATUS_SIG6=8192;SP_STATUS_SIG7=16384;SP_CLR_HALT=1;SP_SET_HALT=2;SP_CLR_BROKE=4;SP_CLR_INTR=8;SP_SET_INTR=16;SP_CLR_SSTEP=32;SP_SET_SSTEP=64;SP_CLR_INTR_BREAK=128;SP_SET_INTR_BREAK=256;SP_CLR_YIELD=512;SP_SET_YIELD=1024;
SP_CLR_YIELDED=2048;SP_SET_YIELDED=4096;SP_CLR_TASKDONE=8192;SP_SET_TASKDONE=16384;SP_CLR_SIG3=32768;SP_SET_SIG3=65536;SP_CLR_SIG4=131072;SP_SET_SIG4=262144;SP_CLR_SIG5=524288;SP_SET_SIG5=1048576;SP_CLR_SIG6=2097152;SP_SET_SIG6=4194304;SP_CLR_SIG7=8388608;SP_SET_SIG7=16777216;var a;a=0;("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsInterrupts=function(b,d){this.setException=function(b,a){d[consts.CAUSE]|=b;d[consts.CAUSE]|=a};this.processException=function(a,e){if(0===(d[consts.STATUS]&
consts.IE)||0!==(d[consts.STATUS]&consts.EXL))return!1;d[consts.CAUSE]&=4294967171;d[consts.STATUS]|=consts.EXL;!0===e?(d[consts.CAUSE]|=consts.BD,d[consts.EPC]=a-4):(d[consts.CAUSE]&=~consts.BD,d[consts.EPC]=a);0===b.doOnce&&b.flushDynaCache();b.doOnce=1;b.p=2147484032;return!0};this.triggerCompareInterrupt=function(b,a){this.setException(consts.EXC_INT,consts.CAUSE_IP8,b,a)};this.triggerPIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_PI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<
24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_PI)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerSPInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_SP);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+
2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_SP)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerVIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_VI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_VI)&&this.setException(consts.EXC_INT,
consts.CAUSE_IP3,a,d)};this.triggerSIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_SI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_SI)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerAIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,
consts.MI_INTR_AI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_AI)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerDPInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_DP);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+
1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_DP)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerRspBreak=function(){this.setFlag(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,consts.SP_STATUS_TASKDONE|consts.SP_STATUS_BROKE|consts.SP_STATUS_HALT);0!==((b.memory.spReg1Uint8Array[consts.SP_STATUS_REG]<<24|b.memory.spReg1Uint8Array[consts.SP_STATUS_REG+1]<<16|b.memory.spReg1Uint8Array[consts.SP_STATUS_REG+
2]<<8|b.memory.spReg1Uint8Array[consts.SP_STATUS_REG+3])&consts.SP_STATUS_INTR_BREAK)&&this.triggerSPInterrupt(0,!1)};this.clearMIInterrupt=function(a){this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_REG,a);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG))&&(d[consts.CAUSE]&=
~consts.CAUSE_IP3)};this.readVI=function(c){switch(c){case consts.VI_CURRENT_REG:if(625===(a+=1))a=0;return(b.memory.getInt32(b.memory.viUint8Array,b.memory.viUint8Array,c)&4294967294)+a|0;default:return b.memory.getInt32(b.memory.viUint8Array,b.memory.viUint8Array,c)}};this.writeVI=function(a,d){switch(a){case consts.VI_ORIGIN_REG:b.memory.setInt32(b.memory.viUint8Array,a,d);break;case consts.VI_CURRENT_REG:this.clearMIInterrupt(consts.MI_INTR_VI);b.memory.setInt32(b.memory.viUint8Array,a,d);break;
case consts.VI_INTR_REG:b.memory.setInt32(b.memory.viUint8Array,a,d);break;default:b.memory.setInt32(b.memory.viUint8Array,a,d)}};this.writePI=function(a,d,g,f){switch(a){case consts.PI_WR_LEN_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);b.dma.copyCartToDram(g,f);break;case consts.PI_RD_LEN_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);alert("write to PI_RD_LEN_REG");b.dma.copyDramToCart(g,f);break;case consts.PI_DRAM_ADDR_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);break;case consts.PI_CART_ADDR_REG:b.memory.setInt32(b.memory.piUint8Array,
a,d);break;case consts.PI_STATUS_REG:this.writePIStatusReg(d,g,f);break;default:b.memory.setInt32(b.memory.piUint8Array,a,d)}};this.writeSI=function(a,d,g,f){switch(a){case consts.SI_DRAM_ADDR_REG:b.memory.setInt32(b.memory.siUint8Array,a,d);break;case consts.SI_STATUS_REG:this.writeSIStatusReg(d,g,f);break;case consts.SI_PIF_ADDR_RD64B_REG:b.memory.setInt32(b.memory.siUint8Array,a,d);b.dma.copySiToDram(g,f);break;case consts.SI_PIF_ADDR_WR64B_REG:b.memory.setInt32(b.memory.siUint8Array,a,d);b.dma.copyDramToSi(g,
f);break;default:b.memory.setInt32(b.memory.siUint8Array,a,d)}};this.readSI=function(a){switch(a){case consts.SI_STATUS_REG:return this.readSIStatusReg(),b.memory.getInt32(b.memory.siUint8Array,b.memory.siUint8Array,a);default:return b.memory.getInt32(b.memory.siUint8Array,b.memory.siUint8Array,a)}};this.readSIStatusReg=function(){0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_SI)?this.setFlag(b.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT):
this.clrFlag(b.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT)};this.readAI=function(a){switch(a){case consts.AI_LEN_REG:return b.kfi-=1,0===b.kfi&&(b.kfi=512,this.clrFlag(b.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL)),0;case consts.AI_STATUS_REG:return b.memory.getInt32(b.memory.aiUint8Array,b.memory.aiUint8Array,a);default:return b.memory.getInt32(b.memory.aiUint8Array,b.memory.aiUint8Array,a)}};this.writeAI=function(a,d,g,f){switch(a){case consts.AI_DRAM_ADDR_REG:b.memory.setInt32(b.memory.aiUint8Array,
a,d);break;case consts.AI_LEN_REG:b.memory.setInt32(b.memory.aiUint8Array,a,d);b.dma.copyDramToAi(g,f);break;case consts.AI_STATUS_REG:this.clearMIInterrupt(consts.MI_INTR_AI);break;case consts.AI_DACRATE_REG:b.memory.setInt32(b.memory.aiUint8Array,a,d);break;case consts.AI_CONTROL_REG:b.memory.setInt32(b.memory.aiUint8Array,a,d&1);break;default:b.memory.setInt32(b.memory.aiUint8Array,a,d)}};this.writeMI=function(a,d,g,f){switch(a){case consts.MI_INIT_MODE_REG:this.writeMIModeReg(d);break;case consts.MI_INTR_MASK_REG:this.writeMIIntrMaskReg(d,
g,f);break;case consts.MI_VERSION_REG:case consts.MI_INTR_REG:break;default:b.memory.setInt32(b.memory.miUint8Array,a,d)}};this.readSPReg1=function(a){var d;switch(a){case consts.SP_STATUS_REG:return b.memory.getInt32(b.memory.spReg1Uint8Array,b.memory.spReg1Uint8Array,a);case consts.SP_SEMAPHORE_REG:return d=b.memory.getInt32(b.memory.aiUint8Array,b.memory.aiUint8Array,a),b.memory.setInt32(b.memory.spReg1Uint8Array,a,1),d;default:return b.memory.getInt32(b.memory.spReg1Uint8Array,b.memory.spReg1Uint8Array,
a)}};this.writeSPReg1=function(a,d,g,f){switch(a){case consts.SP_STATUS_REG:this.writeSPStatusReg(d,g,f);break;case consts.SP_SEMAPHORE_REG:b.memory.setInt32(b.memory.spReg1Uint8Array,a,0);break;case consts.SP_WR_LEN_REG:b.memory.setInt32(b.memory.spReg1Uint8Array,a,d);b.dma.copySpToDram(g,f);break;case consts.SP_RD_LEN_REG:b.memory.setInt32(b.memory.spReg1Uint8Array,a,d);b.dma.copyDramToSp(g,f);break;default:b.memory.setInt32(b.memory.spReg1Uint8Array,a,d)}};this.writeSPReg2=function(a,d){switch(a){case consts.SP_PC_REG:b.memory.setInt32(b.memory.spReg2Uint8Array,
a,d&4092);break;default:b.memory.setInt32(b.memory.spReg2Uint8Array,a,d)}};this.setFlag=function(a,d,g){var f;f=b.memory.getUint32(a,d);b.memory.setInt32(a,d,f|g)};this.clrFlag=function(a,d,g){var f;f=b.memory.getUint32(a,d);b.memory.setInt32(a,d,f&~g)};this.writeMIModeReg=function(a){a&consts.MI_SET_RDRAM?this.setFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_RDRAM):a&consts.MI_CLR_RDRAM&&this.clrFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_RDRAM);a&consts.MI_SET_INIT?
this.setFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_INIT):a&consts.MI_CLR_INIT&&this.clrFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_INIT);a&consts.MI_SET_EBUS?this.setFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_EBUS):a&consts.MI_CLR_EBUS&&this.clrFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_EBUS);a&consts.MI_CLR_DP_INTR&&this.clearMIInterrupt(consts.MI_INTR_DP)};this.writeMIIntrMaskReg=function(a,d,g){a&consts.MI_INTR_MASK_SP_SET?
this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SP):a&consts.MI_INTR_MASK_SP_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SP);a&consts.MI_INTR_MASK_SI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SI):a&consts.MI_INTR_MASK_SI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SI);a&consts.MI_INTR_MASK_AI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_AI):
a&consts.MI_INTR_MASK_AI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_AI);a&consts.MI_INTR_MASK_VI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_VI):a&consts.MI_INTR_MASK_VI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_VI);a&consts.MI_INTR_MASK_PI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_PI):a&consts.MI_INTR_MASK_PI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,
consts.MI_INTR_PI);a&consts.MI_INTR_MASK_DP_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_DP):a&consts.MI_INTR_MASK_DP_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_DP);0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_MASK_REG)&63&b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG))&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,d,g)};this.writeSIStatusReg=function(){this.clrFlag(b.memory.siUint8Array,consts.SI_STATUS_REG,
consts.SI_STATUS_INTERRUPT)};this.writeSPStatusReg=function(a,d,g){var f;f=b.memory.getUint32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG);a&SP_CLR_BROKE&&(f&=~consts.SP_STATUS_BROKE);a&SP_SET_INTR?this.triggerSPInterrupt(d,g):a&SP_CLR_INTR&&this.clearMIInterrupt(consts.MI_INTR_SP);a&SP_SET_SSTEP?f|=SP_STATUS_SSTEP:a&SP_CLR_SSTEP&&(f&=~SP_STATUS_SSTEP);a&SP_SET_INTR_BREAK?f|=SP_STATUS_INTR_BREAK:a&SP_CLR_INTR_BREAK&&(f&=~SP_STATUS_INTR_BREAK);a&SP_SET_YIELD?f|=SP_STATUS_YIELD:a&SP_CLR_YIELD&&(f&=
~SP_STATUS_YIELD);a&SP_SET_YIELDED?f|=SP_STATUS_YIELDED:a&SP_CLR_YIELDED&&(f&=~SP_STATUS_YIELDED);a&SP_SET_TASKDONE?f|=SP_STATUS_TASKDONE:a&SP_CLR_YIELDED&&(f&=~SP_STATUS_YIELDED);a&SP_SET_SIG3?f|=SP_STATUS_SIG3:a&SP_CLR_SIG3&&(f&=~SP_STATUS_SIG3);a&SP_SET_SIG4?f|=SP_STATUS_SIG4:a&SP_CLR_SIG4&&(f&=~SP_STATUS_SIG4);a&SP_SET_SIG5?f|=SP_STATUS_SIG5:a&SP_CLR_SIG5&&(f&=~SP_STATUS_SIG5);a&SP_SET_SIG6?f|=SP_STATUS_SIG6:a&SP_CLR_SIG6&&(f&=~SP_STATUS_SIG6);a&SP_SET_SIG7?f|=SP_STATUS_SIG7:a&SP_CLR_SIG7&&(f&=
~SP_STATUS_SIG7);a&SP_SET_HALT?(f|=SP_STATUS_HALT,b.memory.setInt32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,f)):a&SP_CLR_HALT&&(0===(f&SP_STATUS_BROKE)?(f&=~SP_STATUS_HALT,b.memory.setInt32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,f),a=b.memory.getUint32(b.memory.spMemUint8Array,consts.SP_DMEM_TASK),this.runSPTask(a)):b.memory.setInt32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,f))};this.writeDPCStatusReg=function(a){a&consts.DPC_CLR_XBUS_DMEM_DMA&&this.clrFlag(b.memory.dpcUint8Array,
consts.DPC_STATUS_REG,consts.DPC_STATUS_XBUS_DMEM_DMA);a&consts.DPC_SET_XBUS_DMEM_DMA&&this.setFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_XBUS_DMEM_DMA);a&consts.DPC_CLR_FREEZE&&this.clrFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FREEZE);a&consts.DPC_SET_FREEZE&&this.setFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FREEZE);a&consts.DPC_CLR_FLUSH&&this.clrFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FLUSH);
a&consts.DPC_SET_FLUSH&&this.setFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FLUSH)};this.writeDPC=function(a,d,g,f){switch(a){case consts.DPC_STATUS_REG:this.writeDPCStatusReg(d,g,f);break;case consts.DPC_START_REG:b.memory.setInt32(b.memory.dpcUint8Array,a,d);break;case consts.DPC_END_REG:b.memory.setInt32(b.memory.dpcUint8Array,a,d);this.processRDPList();break;case consts.DPC_CLOCK_REG:case consts.DPC_BUFBUSY_REG:case consts.DPC_PIPEBUSY_REG:case consts.DPC_TMEM_REG:break;
default:b.memory.setInt32(b.memory.dpcUint8Array,a,d)}};this.writePIStatusReg=function(a,d,g){a&consts.PI_STATUS_CLR_INTR&&this.clearMIInterrupt(consts.MI_INTR_PI);a&consts.PI_STATUS_RESET&&(b.memory.getUint32(b.memory.piUint8Array,consts.PI_STATUS_REG)&(consts.PI_STATUS_IO_BUSY|consts.PI_STATUS_DMA_BUSY)?(b.memory.setInt32(b.memory.piUint8Array,consts.PI_STATUS_REG,0),this.triggerPIInterrupt(d,g)):b.memory.setInt32(b.memory.piUint8Array,consts.PI_STATUS_REG,0))};this.runSPTask=function(a){switch(a){case consts.GFX_TASK:if(null===
b.videoHLE||void 0===b.videoHLE)b.videoHLE=new C1964jsVideoHLE(b,b.webGL.gl);b.settings.wireframe=document.getElementById("wireframe").checked;!1===b.terminate&&b.videoHLE.processDisplayList();break;case consts.SND_TASK:this.processAudioList();break;case consts.JPG_TASK:this.processJpegTask()}this.checkInterrupts();this.triggerRspBreak()};this.processAudioList=function(){this.clrFlag(b.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL)};this.processJpegTask=function(){};this.processRDPList=
function(){};this.checkInterrupts=function(){0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_DP)&&this.triggerDPInterrupt(0,!1);0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_AI)&&this.triggerAIInterrupt(0,!1);0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_SI)&&this.triggerSIInterrupt(0,!1);0!==(d[consts.CAUSE]&d[consts.STATUS]&65280)&&this.setException(consts.EXC_INT,0,b.p,!1)};return this}}).call(this);glMatrixArrayType="undefined"!=typeof Float32Array?Float32Array:"undefined"!=typeof WebGLFloatArray?WebGLFloatArray:Array;
var vec3={create:function(a){var b=new glMatrixArrayType(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},add:function(a,b,d){if(!d||a==d)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;d[0]=a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];return d},subtract:function(a,b,d){if(!d||a==d)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2];return d},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,
b,d){if(!d||a==d)return a[0]*=b,a[1]*=b,a[2]*=b,a;d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;return d},normalize:function(a,b){b||(b=a);var d=a[0],c=a[1],e=a[2],g=Math.sqrt(d*d+c*c+e*e);if(g){if(1==g)return b[0]=d,b[1]=c,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=d*g;b[1]=c*g;b[2]=e*g;return b},cross:function(a,b,d){d||(d=a);var c=a[0],e=a[1],a=a[2],g=b[0],f=b[1],b=b[2];d[0]=e*b-a*f;d[1]=a*g-c*b;d[2]=c*f-e*g;return d},length:function(a){var b=a[0],d=a[1],a=a[2];return Math.sqrt(b*b+d*d+a*a)},
dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,d){d||(d=a);var c=a[0]-b[0],e=a[1]-b[1],a=a[2]-b[2],b=Math.sqrt(c*c+e*e+a*a);if(!b)return d[0]=0,d[1]=0,d[2]=0,d;b=1/b;d[0]=c*b;d[1]=e*b;d[2]=a*b;return d},lerp:function(a,b,d,c){c||(c=a);c[0]=a[0]+d*(b[0]-a[0]);c[1]=a[1]+d*(b[1]-a[1]);c[2]=a[2]+d*(b[2]-a[2]);return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"}},mat3={create:function(a){var b=new glMatrixArrayType(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a==b){var d=a[1],c=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=d;a[5]=a[7];a[6]=c;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},
toMat4:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},mat4={create:function(a){var b=new glMatrixArrayType(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=
a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a==b){var d=a[1],c=a[2],e=a[3],g=a[6],f=a[7],h=a[11];a[1]=a[4];a[2]=
a[8];a[3]=a[12];a[4]=d;a[6]=a[9];a[7]=a[13];a[8]=c;a[9]=g;a[11]=a[14];a[12]=e;a[13]=f;a[14]=h;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],d=a[1],c=a[2],e=a[3],g=a[4],f=a[5],h=a[6],i=a[7],k=a[8],j=a[9],l=a[10],m=a[11],n=a[12],p=a[13],q=a[14],a=a[15];return n*j*h*e-k*p*h*e-n*f*l*e+g*p*l*e+k*f*q*e-g*j*q*e-n*j*c*i+k*p*c*i+
n*d*l*i-b*p*l*i-k*d*q*i+b*j*q*i+n*f*c*m-g*p*c*m-n*d*h*m+b*p*h*m+g*d*q*m-b*f*q*m-k*f*c*a+g*j*c*a+k*d*h*a-b*j*h*a-g*d*l*a+b*f*l*a},inverse:function(a,b){b||(b=a);var d=a[0],c=a[1],e=a[2],g=a[3],f=a[4],h=a[5],i=a[6],k=a[7],j=a[8],l=a[9],m=a[10],n=a[11],p=a[12],q=a[13],r=a[14],z=a[15],u=d*h-c*f,w=d*i-e*f,v=d*k-g*f,x=c*i-e*h,y=c*k-g*h,A=e*k-g*i,B=j*q-l*p,C=j*r-m*p,D=j*z-n*p,E=l*r-m*q,F=l*z-n*q,G=m*z-n*r,t=1/(u*G-w*F+v*E+x*D-y*C+A*B);b[0]=(h*G-i*F+k*E)*t;b[1]=(-c*G+e*F-g*E)*t;b[2]=(q*A-r*y+z*x)*t;b[3]=
(-l*A+m*y-n*x)*t;b[4]=(-f*G+i*D-k*C)*t;b[5]=(d*G-e*D+g*C)*t;b[6]=(-p*A+r*v-z*w)*t;b[7]=(j*A-m*v+n*w)*t;b[8]=(f*F-h*D+k*B)*t;b[9]=(-d*F+c*D-g*B)*t;b[10]=(p*y-q*v+z*u)*t;b[11]=(-j*y+l*v-n*u)*t;b[12]=(-f*E+h*C-i*B)*t;b[13]=(d*E-c*C+e*B)*t;b[14]=(-p*x+q*w-r*u)*t;b[15]=(j*x-l*w+m*u)*t;return b},toRotationMat:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},
toMat3:function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},toInverseMat3:function(a,b){var d=a[0],c=a[1],e=a[2],g=a[4],f=a[5],h=a[6],i=a[8],k=a[9],j=a[10],l=j*f-h*k,m=-j*g+h*i,n=k*g-f*i,p=d*l+c*m+e*n;if(!p)return null;p=1/p;b||(b=mat3.create());b[0]=l*p;b[1]=(-j*c+e*k)*p;b[2]=(h*c-e*f)*p;b[3]=m*p;b[4]=(j*d-e*i)*p;b[5]=(-h*d+e*g)*p;b[6]=n*p;b[7]=(-k*d+c*i)*p;b[8]=(f*d-c*g)*p;return b},multiply:function(a,b,d){d||(d=
a);var c=a[0],e=a[1],g=a[2],f=a[3],h=a[4],i=a[5],k=a[6],j=a[7],l=a[8],m=a[9],n=a[10],p=a[11],q=a[12],r=a[13],z=a[14],a=a[15],u=b[0],w=b[1],v=b[2],x=b[3],y=b[4],A=b[5],B=b[6],C=b[7],D=b[8],E=b[9],F=b[10],G=b[11],t=b[12],H=b[13],I=b[14],b=b[15];d[0]=u*c+w*h+v*l+x*q;d[1]=u*e+w*i+v*m+x*r;d[2]=u*g+w*k+v*n+x*z;d[3]=u*f+w*j+v*p+x*a;d[4]=y*c+A*h+B*l+C*q;d[5]=y*e+A*i+B*m+C*r;d[6]=y*g+A*k+B*n+C*z;d[7]=y*f+A*j+B*p+C*a;d[8]=D*c+E*h+F*l+G*q;d[9]=D*e+E*i+F*m+G*r;d[10]=D*g+E*k+F*n+G*z;d[11]=D*f+E*j+F*p+G*a;d[12]=
t*c+H*h+I*l+b*q;d[13]=t*e+H*i+I*m+b*r;d[14]=t*g+H*k+I*n+b*z;d[15]=t*f+H*j+I*p+b*a;return d},multiplyVec3:function(a,b,d){d||(d=b);var c=b[0],e=b[1],b=b[2];d[0]=a[0]*c+a[4]*e+a[8]*b+a[12];d[1]=a[1]*c+a[5]*e+a[9]*b+a[13];d[2]=a[2]*c+a[6]*e+a[10]*b+a[14];return d},multiplyVec4:function(a,b,d){d||(d=b);var c=b[0],e=b[1],g=b[2],b=b[3];d[0]=a[0]*c+a[4]*e+a[8]*g+a[12]*b;d[1]=a[1]*c+a[5]*e+a[9]*g+a[13]*b;d[2]=a[2]*c+a[6]*e+a[10]*g+a[14]*b;d[3]=a[3]*c+a[7]*e+a[11]*g+a[15]*b;return d},translate:function(a,
b,d){var c=b[0],e=b[1],b=b[2];if(!d||a==d)return a[12]=a[0]*c+a[4]*e+a[8]*b+a[12],a[13]=a[1]*c+a[5]*e+a[9]*b+a[13],a[14]=a[2]*c+a[6]*e+a[10]*b+a[14],a[15]=a[3]*c+a[7]*e+a[11]*b+a[15],a;var g=a[0],f=a[1],h=a[2],i=a[3],k=a[4],j=a[5],l=a[6],m=a[7],n=a[8],p=a[9],q=a[10],r=a[11];d[0]=g;d[1]=f;d[2]=h;d[3]=i;d[4]=k;d[5]=j;d[6]=l;d[7]=m;d[8]=n;d[9]=p;d[10]=q;d[11]=r;d[12]=g*c+k*e+n*b+a[12];d[13]=f*c+j*e+p*b+a[13];d[14]=h*c+l*e+q*b+a[14];d[15]=i*c+m*e+r*b+a[15];return d},scale:function(a,b,d){var c=b[0],e=
b[1],b=b[2];if(!d||a==d)return a[0]*=c,a[1]*=c,a[2]*=c,a[3]*=c,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;d[0]=a[0]*c;d[1]=a[1]*c;d[2]=a[2]*c;d[3]=a[3]*c;d[4]=a[4]*e;d[5]=a[5]*e;d[6]=a[6]*e;d[7]=a[7]*e;d[8]=a[8]*b;d[9]=a[9]*b;d[10]=a[10]*b;d[11]=a[11]*b;d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d},rotate:function(a,b,d,c){var e=d[0],g=d[1],d=d[2],f=Math.sqrt(e*e+g*g+d*d);if(!f)return null;1!=f&&(f=1/f,e*=f,g*=f,d*=f);var h=Math.sin(b),i=Math.cos(b),k=1-i,b=a[0],
f=a[1],j=a[2],l=a[3],m=a[4],n=a[5],p=a[6],q=a[7],r=a[8],z=a[9],u=a[10],w=a[11],v=e*e*k+i,x=g*e*k+d*h,y=d*e*k-g*h,A=e*g*k-d*h,B=g*g*k+i,C=d*g*k+e*h,D=e*d*k+g*h,e=g*d*k-e*h,g=d*d*k+i;c?a!=c&&(c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=b*v+m*x+r*y;c[1]=f*v+n*x+z*y;c[2]=j*v+p*x+u*y;c[3]=l*v+q*x+w*y;c[4]=b*A+m*B+r*C;c[5]=f*A+n*B+z*C;c[6]=j*A+p*B+u*C;c[7]=l*A+q*B+w*C;c[8]=b*D+m*e+r*g;c[9]=f*D+n*e+z*g;c[10]=j*D+p*e+u*g;c[11]=l*D+q*e+w*g;return c},rotateX:function(a,b,d){var c=Math.sin(b),
b=Math.cos(b),e=a[4],g=a[5],f=a[6],h=a[7],i=a[8],k=a[9],j=a[10],l=a[11];d?a!=d&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[4]=e*b+i*c;d[5]=g*b+k*c;d[6]=f*b+j*c;d[7]=h*b+l*c;d[8]=e*-c+i*b;d[9]=g*-c+k*b;d[10]=f*-c+j*b;d[11]=h*-c+l*b;return d},rotateY:function(a,b,d){var c=Math.sin(b),b=Math.cos(b),e=a[0],g=a[1],f=a[2],h=a[3],i=a[8],k=a[9],j=a[10],l=a[11];d?a!=d&&(d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):
d=a;d[0]=e*b+i*-c;d[1]=g*b+k*-c;d[2]=f*b+j*-c;d[3]=h*b+l*-c;d[8]=e*c+i*b;d[9]=g*c+k*b;d[10]=f*c+j*b;d[11]=h*c+l*b;return d},rotateZ:function(a,b,d){var c=Math.sin(b),b=Math.cos(b),e=a[0],g=a[1],f=a[2],h=a[3],i=a[4],k=a[5],j=a[6],l=a[7];d?a!=d&&(d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=e*b+i*c;d[1]=g*b+k*c;d[2]=f*b+j*c;d[3]=h*b+l*c;d[4]=e*-c+i*b;d[5]=g*-c+k*b;d[6]=f*-c+j*b;d[7]=h*-c+l*b;return d},frustum:function(a,b,d,c,e,g,f){f||(f=mat4.create());
var h=b-a,i=c-d,k=g-e;f[0]=2*e/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*e/i;f[6]=0;f[7]=0;f[8]=(b+a)/h;f[9]=(c+d)/i;f[10]=-(g+e)/k;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(2*g*e)/k;f[15]=0;return f},perspective:function(a,b,d,c,e){a=d*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a,a,d,c,e)},ortho:function(a,b,d,c,e,g,f){f||(f=mat4.create());var h=b-a,i=c-d,k=g-e;f[0]=2/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/i;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/k;f[11]=0;f[12]=-(a+b)/h;f[13]=-(c+d)/i;f[14]=-(g+e)/k;
f[15]=1;return f},lookAt:function(a,b,d,c){c||(c=mat4.create());var e=a[0],g=a[1],a=a[2],f=d[0],h=d[1],i=d[2],d=b[1],k=b[2];if(e==b[0]&&g==d&&a==k)return mat4.identity(c);var j,l,m,n,d=e-b[0],k=g-b[1],b=a-b[2];n=1/Math.sqrt(d*d+k*k+b*b);d*=n;k*=n;b*=n;j=h*b-i*k;i=i*d-f*b;f=f*k-h*d;(n=Math.sqrt(j*j+i*i+f*f))?(n=1/n,j*=n,i*=n,f*=n):f=i=j=0;h=k*f-b*i;l=b*j-d*f;m=d*i-k*j;(n=Math.sqrt(h*h+l*l+m*m))?(n=1/n,h*=n,l*=n,m*=n):m=l=h=0;c[0]=j;c[1]=h;c[2]=d;c[3]=0;c[4]=i;c[5]=l;c[6]=k;c[7]=0;c[8]=f;c[9]=m;c[10]=
b;c[11]=0;c[12]=-(j*e+i*g+f*a);c[13]=-(h*e+l*g+m*a);c[14]=-(d*e+k*g+b*a);c[15]=1;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}};
quat4={create:function(a){var b=new glMatrixArrayType(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},calculateW:function(a,b){var d=a[0],c=a[1],e=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-d*d-c*c-e*e)),a;b[0]=d;b[1]=c;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-d*d-c*c-e*e));return b},inverse:function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b},length:function(a){var b=
a[0],d=a[1],c=a[2],a=a[3];return Math.sqrt(b*b+d*d+c*c+a*a)},normalize:function(a,b){b||(b=a);var d=a[0],c=a[1],e=a[2],g=a[3],f=Math.sqrt(d*d+c*c+e*e+g*g);if(0==f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=d*f;b[1]=c*f;b[2]=e*f;b[3]=g*f;return b},multiply:function(a,b,d){d||(d=a);var c=a[0],e=a[1],g=a[2],a=a[3],f=b[0],h=b[1],i=b[2],b=b[3];d[0]=c*b+a*f+e*i-g*h;d[1]=e*b+a*h+g*f-c*i;d[2]=g*b+a*i+c*h-e*f;d[3]=a*b-c*f-e*h-g*i;return d},multiplyVec3:function(a,b,d){d||(d=b);var c=b[0],e=b[1],g=b[2],
b=a[0],f=a[1],h=a[2],a=a[3],i=a*c+f*g-h*e,k=a*e+h*c-b*g,j=a*g+b*e-f*c,c=-b*c-f*e-h*g;d[0]=i*a+c*-b+k*-h-j*-f;d[1]=k*a+c*-f+j*-b-i*-h;d[2]=j*a+c*-h+i*-f-k*-b;return d},toMat3:function(a,b){b||(b=mat3.create());var d=a[0],c=a[1],e=a[2],g=a[3],f=d+d,h=c+c,i=e+e,k=d*f,j=d*h,d=d*i,l=c*h,c=c*i,e=e*i,f=g*f,h=g*h,g=g*i;b[0]=1-(l+e);b[1]=j-g;b[2]=d+h;b[3]=j+g;b[4]=1-(k+e);b[5]=c-f;b[6]=d-h;b[7]=c+f;b[8]=1-(k+l);return b},toMat4:function(a,b){b||(b=mat4.create());var d=a[0],c=a[1],e=a[2],g=a[3],f=d+d,h=c+c,
i=e+e,k=d*f,j=d*h,d=d*i,l=c*h,c=c*i,e=e*i,f=g*f,h=g*h,g=g*i;b[0]=1-(l+e);b[1]=j-g;b[2]=d+h;b[3]=0;b[4]=j+g;b[5]=1-(k+e);b[6]=c-f;b[7]=0;b[8]=d-h;b[9]=c+f;b[10]=1-(k+l);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},slerp:function(a,b,d,c){c||(c=a);var e=d;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(e=-1*d);c[0]=1-d*a[0]+e*b[0];c[1]=1-d*a[1]+e*b[1];c[2]=1-d*a[2]+e*b[2];c[3]=1-d*a[3]+e*b[3];return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};WebGLUtils=function(){var a=function(b,a){for(var c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=null,g=0;g<c.length;++g){try{e=b.getContext(c[g],a)}catch(f){}if(e)break}return e};return{create3DContext:a,setupWebGL:function(b,d){function c(a){var c=b.parentNode;c&&(c.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+a+"</div></div></td></tr></table>")}if(!window.WebGLRenderingContext)return c('This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>'),
null;var e=a(b,d);e||c('It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>');return e}}}();window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/60)}}();
window.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout}();(function(){("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsRenderer=function(a,b,d){var c,e,g,f,h;this.videoHLE=g=h=f=void 0;c=[0,8,16,24,33,41,49,57,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,198,206,214,222,231,239,247,255];this.textureCache={};this.texRect=function(b,a,c,d,f,g,h,q,r,z,u){var w,v,x,y;this.videoHLE=u;v=u.pow2roundup(r.width);w=u.pow2roundup(r.height);y=r.width/v;x=r.height/w;w=f/r.height;v=g/r.width;f=(f+(c-b)*h)/r.width*y;g=(g+(d-a)*q)/r.height*
x;e((b-160)/160,-(a-120)/120,(c-160)/160,-(d-120)/120,w,v,f,g,u);this.draw(r,z,u)};this.formatTexture=function(b,a,d,e){var f,g,h,q,r;this.useTextureCache=!0;if(!0===this.useTextureCache&&(g=e*d,g=a[g]>>>0<<24|a[g+d+1]>>>0<<16|a[g+2*d+1]>>>0<<8|a[g+3*d+1]>>>0,null!=this.textureCache[g]))return this.textureCache[g];e=new ArrayBuffer(4*e*d);e=new Uint8Array(e);!0===this.useTextureCache&&(this.textureCache[g]=e);switch(b.fmt){case 0:switch(b.siz){case 2:r=b.width;for(q=0;q<b.height;){for(h=0;h<b.width;)f=
2*q*r+2*h,g=4*q*d+4*h,f=a[f]<<8|a[f+1],e[g]=c[f>>11&31],e[g+1]=c[f>>6&31],e[g+2]=c[f>>1&31],e[g+3]=f&0?0:255,h++;q++}}}return e};e=function(a,c,d,e,m,n,p,q){a=[d,e,0,d,c,0,a,c,0,a,e,0];f=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,f);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.DYNAMIC_DRAW);f.itemSize=3;f.numItems=4;m=[p,q,p,n,m,n,m,q];h=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,h);b.bufferData(b.ARRAY_BUFFER,new Float32Array(m),b.STATIC_DRAW);h.itemSize=2;h.numItems=4;g=b.createBuffer();
b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),b.STATIC_DRAW);g.itemSize=1;g.numItems=6};this.draw=function(c,e,j){var l,m;b.useProgram(d.shaderProgram);b.disable(b.DEPTH_TEST);b.enable(b.BLEND);b.blendFunc(b.SRC_ALPHA,b.ONE);b.enableVertexAttribArray(d.shaderProgram.vertexPositionAttribute);b.bindBuffer(b.ARRAY_BUFFER,f);b.vertexAttribPointer(d.shaderProgram.vertexPositionAttribute,f.itemSize,b.FLOAT,!1,0,0);b.enableVertexAttribArray(d.shaderProgram.textureCoordAttribute);
b.bindBuffer(b.ARRAY_BUFFER,h);b.vertexAttribPointer(d.shaderProgram.textureCoordAttribute,h.itemSize,b.FLOAT,!1,0,0);m=j.pow2roundup(c.width);l=j.pow2roundup(c.height);e=this.formatTexture(c,e,m,l);void 0!==e&&(c=b.createTexture(),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,c),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,m,l,0,b.RGBA,b.UNSIGNED_BYTE,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.uniform1i(d.shaderProgram.samplerUniform,
c),0<j.primColor.length&&b.uniform4fv(d.shaderProgram.uPrimColor,j.primColor),0<j.fillColor.length&&b.uniform4fv(d.shaderProgram.uFillColor,j.fillColor),0<j.envColor.length&&b.uniform4fv(d.shaderProgram.uEnvColor,j.envColor),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g),d.setMatrixUniforms(d.shaderProgram),d.setCombineUniforms(d.shaderProgram),b.uniform1i(d.shaderProgram.wireframeUniform,a.wireframe?1:0),!0===a.wireframe?b.drawElements(b.LINE_LOOP,g.numItems,b.UNSIGNED_SHORT,0):b.drawElements(b.TRIANGLES,
g.numItems,b.UNSIGNED_SHORT,0))};return this}}).call(this);(function(){var a;a=function(b,a){var c;this.processDisplayList=this.callBind(this.processDisplayList,this);this.core=b;this.gl=a;this.RICE_MATRIX_STACK=60;this.MAX_TEXTURES=8;this.MAX_VERTICES=80;this.MAX_TILES=8;this.tmem=new Uint8Array(4096);this.activeTile=0;this.textureTile=[];this.N64VertexList=[];this.vtxTransformed=[];this.vtxNonTransformed=[];this.vecProjected=[];this.vtxProjected5=[];this.geometryMode=0;this.gRSP={};this.matToLoad=mat4.create();this.gRSPworldProject=mat4.create();this.triangleVertexColorBuffer=
this.triangleVertexPositionBuffer=void 0;this.dlistStackPointer=0;this.dlistStack=[];this.renderer=new C1964jsRenderer(this.core.settings,this.core.webGL.gl,this.core.webGL);this.texImg={};this.segments=[];this.primColor=[];this.fillColor=[];this.envColor=[];this.currentMicrocodeMap=this.microcodeMap0;for(c=0;c<this.MAX_TILES;)this.textureTile[c]=[],c+=1;for(c=0;c<this.MAX_VERTICES;)this.N64VertexList[c]={},c+=1;for(c=0;c<consts.MAX_DL_STACK_SIZE;)this.dlistStack[c]={},c+=1;for(c=0;c<this.segments.length;)this.segments[c]=
0,c+=1;this.gRSP.projectionMtxs=[];this.gRSP.modelviewMtxs=[];for(c=0;c<this.RICE_MATRIX_STACK;)this.gRSP.projectionMtxs[c]=mat4.create(),this.gRSP.modelviewMtxs[c]=mat4.create(),c+=1;this.gRSP.vertexMult=10;this.triangleVertexTextureCoordBuffer=void 0;return this};a.prototype.callBind=function(b,a){return function(){return b.call(a)}};a.prototype.processDisplayList=function(){!0===this.core.showFB&&(this.initBuffers(),this.core.webGL.show3D(),this.core.showFB=!1,this.resetState());this.core.webGL.beginDList();
this.dlParserProcess();return this.core.interrupts.triggerSPInterrupt(0,!1)};a.prototype.videoLog=function(){};a.prototype.dlParserProcess=function(){var b,a;this.dlistStackPointer=0;this.dlistStack[this.dlistStackPointer].pc=this.core.memory.getInt32(this.core.memory.spMemUint8Array,this.core.memory.spMemUint8Array,consts.TASK_DATA_PTR);this.dlistStack[this.dlistStackPointer].countdown=consts.MAX_DL_COUNT;for(this.renderReset();0<=this.dlistStackPointer;)a=this.dlistStack[this.dlistStackPointer].pc,
b=this.getCommand(a),b=this.currentMicrocodeMap[b],this.dlistStack[this.dlistStackPointer].pc+=8,this[b](a),0<=this.dlistStackPointer&&(this.dlistStack[this.dlistStackPointer].countdown-=1,0>this.dlistStack[this.dlistStackPointer].countdown&&(this.dlistStackPointer-=1));this.videoLog("finished dlist");this.core.interrupts.triggerSPInterrupt(0,!1)};a.prototype.RDP_GFX_PopDL=function(){this.dlistStackPointer-=1};a.prototype.RSP_RDP_Nothing=function(){this.videoLog("RSP RDP NOTHING");this.dlistStackPointer-=
1};a.prototype.RSP_GBI1_MoveMem=function(b){var a,c;c=this.getGbi1Type(b);a=this.getGbi1Length(b);b=this.getGbi1RspSegmentAddr(b);this.videoLog("movemem type="+c+", length="+a+" addr="+b)};a.prototype.RSP_GBI1_SpNoop=function(){this.videoLog("RSP_GBI1_SpNoop")};a.prototype.RSP_GBI1_Reserved=function(){this.videoLog("RSP_GBI1_Reserved")};a.prototype.setProjection=function(b,a,c){a?(this.gRSP.projectionMtxTop<this.RICE_MATRIX_STACK-1&&(this.gRSP.projectionMtxTop+=1),c?mat4.set(b,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]):
mat4.multiply(this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop-1],b,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop])):c?mat4.set(b,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]):mat4.multiply(this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop],b,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]);this.gRSP.bMatrixIsUpdated=!0};a.prototype.setWorldView=function(a,d,c){!0===d?(this.gRSP.modelViewMtxTop<this.RICE_MATRIX_STACK-1&&(this.gRSP.modelViewMtxTop+=1),c?mat4.set(a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]):
mat4.multiply(this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop-1],a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop])):c?mat4.set(a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]):mat4.multiply(this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop],a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]);this.gRSP.bMatrixIsUpdated=!0};a.prototype.RSP_GBI0_Mtx=function(a){var d;d=this.getGbi0DlistAddr(a);d=this.getRspSegmentAddr(d);this.videoLog("RSP_GBI0_Mtx addr: "+dec2hex(d));this.loadMatrix(d);
this.gbi0isProjectionMatrix(a)?this.setProjection(this.matToLoad,this.gbi0PushMatrix(a),this.gbi0LoadMatrix(a)):this.setWorldView(this.matToLoad,this.gbi0PushMatrix(a),this.gbi0LoadMatrix(a))};a.prototype.loadMatrix=function(a){var d,c,e,g,f;for(e=f=0;4>e;){for(g=0;4>g;)d=a+(e<<3)+(g<<1),c=(this.core.memory.rdramUint8Array[d]<<8|this.core.memory.rdramUint8Array[d+1])<<16>>16,d=(this.core.memory.rdramUint8Array[d+32]<<8|this.core.memory.rdramUint8Array[d+32+1])&65535,this.matToLoad[f]=(c<<16|d)/65536,
f+=1,g+=1;e+=1}};a.prototype.DLParser_SetTImg=function(a){this.texImg.format=this.getTImgFormat(a);this.texImg.size=this.getTImgSize(a);this.texImg.width=this.getTImgWidth(a)+1;this.texImg.addr=this.getTImgAddr(a);this.texImg.bpl=this.texImg.width<<this.texImg.size>>1;this.texImg.changed=!0};a.prototype.RSP_GBI0_Vtx=function(a){var d,c;d=this.getGbi0NumVertices(a)+1;c=this.getGbi0Vertex0(a);a=this.getGbi0DlistAddr(a);a=this.getRspSegmentAddr(a);80<c+d&&(d=32-c);this.processVertexData(a,c,d)};a.prototype.updateCombinedMatrix=
function(){var a,d;this.gRSP.bMatrixIsUpdated&&(d=this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop],a=this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop],mat4.multiply(a,d,this.gRSPworldProject),this.gRSP.bMatrixIsUpdated=!1,this.gRSP.bCombinedMatrixIsUpdated=!0);this.gRSP.bCombinedMatrixIsUpdated=!1};a.prototype.processVertexData=function(a,d,c){var e,g,f,h;this.updateCombinedMatrix();for(g=d;g<d+c;)e=a+16*(g-d),this.N64VertexList[g].x=this.getVertexX(e),this.N64VertexList[g].y=this.getVertexY(e),
this.N64VertexList[g].z=this.getVertexZ(e),h=this.textureTile[this.activeTile].width,f=this.textureTile[this.activeTile].height,this.N64VertexList[g].s=this.getVertexS(e)/32/h,this.N64VertexList[g].t=this.getVertexT(e)/32/f,this.N64VertexList[g].r=this.getVertexColorR(e)/255,this.N64VertexList[g].g=this.getVertexColorG(e)/255,this.N64VertexList[g].b=this.getVertexColorB(e)/255,this.N64VertexList[g].a=this.getVertexAlpha(e)/255,this.N64VertexList[g].nx=this.toSByte(this.getVertexNormalX(e))/255,this.N64VertexList[g].ny=
this.toSByte(this.getVertexNormalY(e))/255,this.N64VertexList[g].nz=this.toSByte(this.getVertexNormalZ(e))/255,g+=1};a.prototype.DLParser_SetCImg=function(){this.videoLog("TODO: DLParser_SetCImg")};a.prototype.RSP_GBI0_DL=function(a){var d;d=this.getGbi0DlistAddr(a);d=this.getRspSegmentAddr(d);this.videoLog("dlist address = "+dec2hex(d));this.getGbi0DlistParam(a)===consts.RSP_DLIST_PUSH&&(this.dlistStackPointer+=1);this.dlistStack[this.dlistStackPointer].pc=d;this.dlistStack[this.dlistStackPointer].countdown=
consts.MAX_DL_COUNT};a.prototype.DLParser_SetCombine=function(a){this.combineA0=this.getCombineA0(a);this.combineB0=this.getCombineB0(a);this.combineC0=this.getCombineC0(a);this.combineD0=this.getCombineD0(a);15===this.combineA0&&(this.combineA0=255);15===this.combineB0&&(this.combineB0=255);31===this.combineC0&&(this.combineC0=255);7===this.combineD0&&(this.combineD0=255);this.combineA0a=this.getCombineA0a(a);this.combineB0a=this.getCombineB0a(a);this.combineC0a=this.getCombineC0a(a);this.combineD0a=
this.getCombineD0a(a);7===this.combineA0a&&(this.combineA0a=255);7===this.combineB0a&&(this.combineB0a=255);7===this.combineC0a&&(this.combineC0a=255);7===this.combineD0a&&(this.combineD0a=255);this.combineA1=this.getCombineA1(a);this.combineB1=this.getCombineB1(a);this.combineC1=this.getCombineC1(a);this.combineD1=this.getCombineD1(a);15===this.combineA1&&(this.combineA1=255);15===this.combineB1&&(this.combineB1=255);31===this.combineC1&&(this.combineC1=255);7===this.combineD1&&(this.combineD1=255);
this.combineA1a=this.getCombineA1a(a);this.combineB1a=this.getCombineB1a(a);this.combineC1a=this.getCombineC1a(a);this.combineD1a=this.getCombineD1a(a);7===this.combineA1a&&(this.combineA1a=255);7===this.combineB1a&&(this.combineB1a=255);7===this.combineC1a&&(this.combineC1a=255);7===this.combineD1a&&(this.combineD1a=255);this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a);this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a+4)};a.prototype.RSP_GBI1_MoveWord=function(a){var d;this.videoLog("RSP_GBI1_MoveWord");switch(this.getGbi0MoveWordType(a)){case consts.RSP_MOVE_WORD_MATRIX:this.RSP_RDP_InsertMatrix();break;case consts.RSP_MOVE_WORD_SEGMENT:d=this.getGbi0MoveWordOffset(a)>>2&15,a=this.getGbi0MoveWordValue(a)&16777215,this.segments[d]=a}};a.prototype.renderReset=function(){this.resetMatrices();this.gRSP.numVertices=0;this.gRSP.curTile=0;this.gRSP.fTexScaleX=0.03125;this.gRSP.fTexScaleY=0.03125};a.prototype.resetMatrices=
function(){this.gRSP.projectionMtxTop=0;this.gRSP.modelViewMtxTop=0;this.gRSP.projectionMtxs[0]=mat4.create();this.gRSP.modelviewMtxs[0]=mat4.create();mat4.identity(this.gRSP.modelviewMtxs[0]);mat4.identity(this.gRSP.projectionMtxs[0]);this.gRSP.bMatrixIsUpdated=!0;this.updateCombinedMatrix()};a.prototype.RSP_RDP_InsertMatrix=function(){this.updateCombinedMatrix();this.gRSP.bMatrixIsUpdated=!1;this.gRSP.bCombinedMatrixIsUpdated=!0};a.prototype.DLParser_SetScissor=function(){this.videoLog("TODO: DLParser_SetScissor")};
a.prototype.RSP_GBI1_SetOtherModeH=function(){this.videoLog("TODO: DLParser_GBI1_SetOtherModeH")};a.prototype.RSP_GBI1_SetOtherModeL=function(){this.videoLog("TODO: DLParser_GBI1_SetOtherModeL")};a.prototype.RSP_GBI0_Sprite2DBase=function(){this.videoLog("TODO: RSP_GBI0_Sprite2DBase")};a.prototype.RSP_GBI0_Tri4=function(){this.videoLog("TODO: RSP_GBI0_Tri4")};a.prototype.RSP_GBI1_RDPHalf_Cont=function(){this.videoLog("TODO: RSP_GBI1_RDPHalf_Cont")};a.prototype.RSP_GBI1_RDPHalf_2=function(){this.videoLog("TODO: RSP_GBI1_RDPHalf_2")};
a.prototype.RSP_GBI1_RDPHalf_1=function(){this.videoLog("TODO: RSP_GBI1_RDPHalf_1")};a.prototype.RSP_GBI1_Line3D=function(){this.videoLog("TODO: RSP_GBI1_Line3D")};a.prototype.RSP_GBI1_ClearGeometryMode=function(a){a=this.getClearGeometryMode(a);this.geometryMode&=~a};a.prototype.RSP_GBI1_SetGeometryMode=function(a){a=this.getSetGeometryMode(a);this.geometryMode|=a};a.prototype.RSP_GBI1_EndDL=function(){this.videoLog("RSP_GBI1_EndDL");this.RDP_GFX_PopDL();this.drawScene(!1,7)};a.prototype.RSP_GBI1_Texture=
function(a){var d;d=this.getTextureTile(a);this.textureTile[d].on=this.getTextureOn(a);this.textureTile[d].level=this.getTextureLevel(a);this.textureTile[d].scales=this.getTextureScaleS(a)/32768;this.textureTile[d].scalet=this.getTextureScaleT(a)/32768};a.prototype.RSP_GBI1_PopMtx=function(){this.videoLog("TODO: RSP_GBI1_PopMtx")};a.prototype.RSP_GBI1_CullDL=function(){this.videoLog("TODO: RSP_GBI1_CullDL")};a.prototype.RSP_GBI1_Tri1=function(a){var d,c,e;d=this.getGbi0Tri1V0(a)/this.gRSP.vertexMult;
c=this.getGbi0Tri1V1(a)/this.gRSP.vertexMult;e=this.getGbi0Tri1V2(a)/this.gRSP.vertexMult;this.getGbi0Tri1Flag(a);!1!==this.prepareTriangle(d,c,e)&&this.getCommand(a+8)};a.prototype.RSP_GBI1_Noop=function(){this.videoLog("TODO: RSP_GBI1_Noop")};a.prototype.RDP_TriFill=function(){this.videoLog("TODO: RDP_TriFill")};a.prototype.RDP_TriFillZ=function(){this.videoLog("RDP_TriFillZ")};a.prototype.RDP_TriTxtr=function(){this.videoLog("TODO: RDP_TriTxtr")};a.prototype.RDP_TriTxtrZ=function(){this.videoLog("TODO: RDP_TriTxtrZ")};
a.prototype.RDP_TriShade=function(){this.videoLog("TODO: RDP_TriShade")};a.prototype.RDP_TriShadeZ=function(){this.videoLog("TODO: RDP_TriShadeZ")};a.prototype.RDP_TriShadeTxtr=function(){this.videoLog("TODO: RDP_TriShadeTxtr")};a.prototype.RDP_TriShadeTxtrZ=function(){this.videoLog("TODO: RDP_TriShadeTxtrZ")};a.prototype.DLParser_TexRect=function(a){var d,c,e,g,f,h,i,k;f=this.getTexRectXh(a)/4;i=this.getTexRectYh(a)/4;g=this.getTexRectTileNo(a);h=this.getTexRectXl(a)/4;k=this.getTexRectYl(a)/4;c=
this.getTexRectS(a)/32;e=this.getTexRectT(a)/32;d=this.getTexRectDsDx(a)/1024;a=this.getTexRectDtDy(a)/1024;this.renderer.texRect(h,k,f,i,c,e,d,a,this.textureTile[g],this.tmem,this);this.dlistStack[this.dlistStackPointer].pc+=8;this.hasTexture=!0};a.prototype.DLParser_TexRectFlip=function(){this.dlistStack[this.dlistStackPointer].pc+=8;this.videoLog("TODO: DLParser_TexRectFlip")};a.prototype.DLParser_RDPLoadSynch=function(){this.videoLog("TODO: DLParser_RDPLoadSynch")};a.prototype.DLParser_RDPPipeSynch=
function(){this.videoLog("TODO: DLParser_RDPPipeSynch")};a.prototype.DLParser_RDPTileSynch=function(){this.videoLog("TODO: DLParser_RDPTileSynch")};a.prototype.DLParser_RDPFullSynch=function(){this.videoLog("TODO: DLParser_RDPFullSynch");this.core.interrupts.triggerDPInterrupt(0,!1)};a.prototype.DLParser_SetKeyGB=function(){this.videoLog("TODO: DLParser_SetKeyGB")};a.prototype.DLParser_SetKeyR=function(){this.videoLog("TODO: DLParser_SetKeyR")};a.prototype.DLParser_SetConvert=function(){this.videoLog("TODO: DLParser_SetConvert")};
a.prototype.DLParser_SetPrimDepth=function(){this.videoLog("TODO: DLParser_SetPrimDepth")};a.prototype.DLParser_RDPSetOtherMode=function(){this.videoLog("TODO: DLParser_RDPSetOtherMode")};a.prototype.DLParser_LoadTLut=function(){this.videoLog("TODO: DLParser_LoadTLut")};a.prototype.DLParser_SetTileSize=function(a){var d;d=this.getSetTileSizeTile(a);this.textureTile[d].uls=this.getSetTileSizeUls(a);this.textureTile[d].ult=this.getSetTileSizeUlt(a);this.textureTile[d].lrs=(this.getSetTileSizeLrs(a)>>
2)+1;this.textureTile[d].lrt=(this.getSetTileSizeLrt(a)>>2)+1;this.textureTile[d].width=this.textureTile[d].lrs-this.textureTile[d].uls;this.textureTile[d].height=this.textureTile[d].lrt-this.textureTile[d].ult;this.videoLog("TODO: DLParser_SetTileSize")};a.prototype.DLParser_LoadBlock=function(a){var d,c;c=this.getLoadBlockTile(a);this.getLoadBlockUls(a);this.getLoadBlockUlt(a);d=this.getLoadBlockLrs(a)+1;this.getLoadBlockDxt(a);a=d*this.textureTile[c].siz;4096<a&&console.error("LoadBlock is making too large of a transfer. "+
a+" bytes");for(d=0;d<a;)this.tmem[d]=this.core.memory.rdramUint8Array[this.texImg.addr+d],d++};a.prototype.DLParser_LoadTile=function(){this.videoLog("TODO: DLParser_LoadTile")};a.prototype.DLParser_SetTile=function(a){var d;this.activeTile=d=this.getSetTileTile(a);this.textureTile[d].fmt=this.getSetTileFmt(a);this.textureTile[d].siz=this.getSetTileSiz(a);this.textureTile[d].line=this.getSetTileLine(a);this.textureTile[d].tmem=this.getSetTileTmem(a);this.textureTile[d].pal=this.getSetTilePal(a);
this.textureTile[d].cmt=this.getSetTileCmt(a);this.textureTile[d].cms=this.getSetTileCms(a);this.textureTile[d].maskt=this.getSetTileMaskt(a);this.textureTile[d].masks=this.getSetTileMasks(a);this.textureTile[d].shiftt=this.getSetTileShiftt(a);this.textureTile[d].shifts=this.getSetTileShifts(a);this.videoLog("TODO: DLParser_SetTile")};a.prototype.DLParser_FillRect=function(){this.videoLog("TODO: DLParser_FillRect")};a.prototype.DLParser_SetFillColor=function(a){this.fillColor=[];this.fillColor.push(this.getSetFillColorR(a)/
255);this.fillColor.push(this.getSetFillColorG(a)/255);this.fillColor.push(this.getSetFillColorB(a)/255);this.fillColor.push(this.getSetFillColorA(a)/255);this.videoLog("TODO: DLParser_SetFillColor")};a.prototype.DLParser_SetFogColor=function(){this.videoLog("TODO: DLParser_SetFogColor")};a.prototype.DLParser_SetBlendColor=function(){this.videoLog("TODO: DLParser_SetBlendColor")};a.prototype.DLParser_SetPrimColor=function(a){this.primColor=[];this.primColor.push(this.getSetPrimColorR(a)/255);this.primColor.push(this.getSetPrimColorG(a)/
255);this.primColor.push(this.getSetPrimColorB(a)/255);this.primColor.push(this.getSetPrimColorA(a)/255);this.videoLog("TODO: DLParser_SetPrimColor")};a.prototype.DLParser_SetEnvColor=function(a){this.envColor=[];this.envColor.push(this.getSetEnvColorR(a)/255);this.envColor.push(this.getSetEnvColorG(a)/255);this.envColor.push(this.getSetEnvColorB(a)/255);this.envColor.push(this.getSetEnvColorA(a)/255);this.videoLog("TODO: DLParser_SetEnvColor")};a.prototype.DLParser_SetZImg=function(){this.videoLog("TODO: DLParser_SetZImg")};
a.prototype.prepareTriangle=function(a,d,c){(a=this.initVertex(a,this.gRSP.numVertices,!1))&&(a=this.initVertex(d,this.gRSP.numVertices+1,!1));a&&(a=this.initVertex(c,this.gRSP.numVertices+2,!1));a&&(this.gRSP.numVertices+=3);return a};a.prototype.initVertex=function(a){var d;if(a>=consts.MAX_VERTS)return!1;d=3*this.triangleVertexPositionBuffer.numItems;this.triVertices[d]=this.N64VertexList[a].x;this.triVertices[d+1]=this.N64VertexList[a].y;this.triVertices[d+2]=this.N64VertexList[a].z;this.triangleVertexPositionBuffer.numItems+=
1;d=4*this.triangleVertexColorBuffer.numItems;this.triColorVertices[d]=this.N64VertexList[a].r;this.triColorVertices[d+1]=this.N64VertexList[a].g;this.triColorVertices[d+2]=this.N64VertexList[a].b;this.triColorVertices[d+3]=this.N64VertexList[a].a;this.triangleVertexColorBuffer.numItems+=1;d=2*this.triangleVertexTextureCoordBuffer.numItems;this.triTextureCoords[d]=this.N64VertexList[a].s;this.triTextureCoords[d+1]=this.N64VertexList[a].t;this.triangleVertexTextureCoordBuffer.numItems+=1;return!0};
a.prototype.drawScene=function(){var a,d,c;this.gl.useProgram(this.core.webGL.shaderProgram);this.gl.disable(this.gl.DEPTH_TEST);this.gl.enable(this.gl.BLEND);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexPositionBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.triVertices),this.gl.STATIC_DRAW);this.gl.enableVertexAttribArray(this.core.webGL.shaderProgram.vertexPositionAttribute);this.gl.vertexAttribPointer(this.core.webGL.shaderProgram.vertexPositionAttribute,
this.triangleVertexPositionBuffer.itemSize,this.gl.FLOAT,!1,0,0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexColorBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.triColorVertices),this.gl.STATIC_DRAW);this.gl.enableVertexAttribArray(this.core.webGL.shaderProgram.vertexColorAttribute);this.gl.vertexAttribPointer(this.core.webGL.shaderProgram.vertexColorAttribute,this.triangleVertexColorBuffer.itemSize,this.gl.FLOAT,!1,0,0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
this.triangleVertexTextureCoordBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.triTextureCoords),this.gl.STATIC_DRAW);this.gl.enableVertexAttribArray(this.core.webGL.shaderProgram.textureCoordAttribute);this.gl.vertexAttribPointer(this.core.webGL.shaderProgram.textureCoordAttribute,this.triangleVertexTextureCoordBuffer.itemSize,this.gl.FLOAT,!1,0,0);c=this.textureTile[this.activeTile];d=this.pow2roundup(c.width);a=this.pow2roundup(c.height);d=this.renderer.formatTexture(c,this.tmem,
d,a);a=this.gl.createTexture();this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,a);this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,c.width,c.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,d);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST);this.gl.uniform1i(this.core.webGL.shaderProgram.samplerUniform,a);0<this.primColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uPrimColor,
this.primColor);0<this.fillColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uFillColor,this.fillColor);0<this.envColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uEnvColor,this.envColor);this.core.webGL.setCombineUniforms(this.core.webGL.shaderProgram);this.gl.uniform1i(this.core.webGL.shaderProgram.wireframeUniform,this.core.settings.wireframe?1:0);this.gl.uniformMatrix4fv(this.core.webGL.shaderProgram.pMatrixUniform,!1,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]);
this.gl.uniformMatrix4fv(this.core.webGL.shaderProgram.mvMatrixUniform,!1,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]);!0===this.core.settings.wireframe?this.gl.drawArrays(this.gl.LINES,0,this.triangleVertexPositionBuffer.numItems):this.gl.drawArrays(this.gl.TRIANGLES,0,this.triangleVertexPositionBuffer.numItems);this.resetState()};a.prototype.resetState=function(){this.triangleVertexPositionBuffer.numItems=0;this.triangleVertexColorBuffer.numItems=0;this.triangleVertexTextureCoordBuffer.numItems=
0;this.triVertices=[];this.triColorVertices=[];this.triTextureCoords=[];this.primColor=[];this.fillColor=[];return this.envColor=[]};a.prototype.initBuffers=function(){this.triangleVertexPositionBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexPositionBuffer);this.triVertices=[];this.triangleVertexPositionBuffer.itemSize=3;this.triangleVertexPositionBuffer.numItems=0;this.triangleVertexColorBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,
this.triangleVertexColorBuffer);this.triColorVertices=[];this.triangleVertexColorBuffer.itemSize=4;this.triangleVertexColorBuffer.numItems=0;this.triangleVertexTextureCoordBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexTextureCoordBuffer);this.triTextureCoords=[];this.triangleVertexTextureCoordBuffer.itemSize=2;this.triangleVertexTextureCoordBuffer.numItems=0};("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsVideoHLE=a}).call(this);(function(){C1964jsVideoHLE.prototype.getGbi0MoveWordType=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)&255};C1964jsVideoHLE.prototype.getGbi0MoveWordOffset=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>8&65535};C1964jsVideoHLE.prototype.getGbi0MoveWordValue=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a+4)};C1964jsVideoHLE.prototype.getGbi0DlistParam=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>>16&255};C1964jsVideoHLE.prototype.getGbi0DlistAddr=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)};C1964jsVideoHLE.prototype.getCommand=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>>24&255};C1964jsVideoHLE.prototype.getGbi0Tri1V2=
function(a){return this.core.memory.rdramUint8Array[a+7]};C1964jsVideoHLE.prototype.getGbi0Tri1V1=function(a){return this.core.memory.rdramUint8Array[a+6]};C1964jsVideoHLE.prototype.getGbi0Tri1V0=function(a){return this.core.memory.rdramUint8Array[a+5]};C1964jsVideoHLE.prototype.getGbi0Tri1Flag=function(a){return this.core.memory.rdramUint8Array[a+4]};C1964jsVideoHLE.prototype.getGbi0NumVertices=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a)>>>20&15};C1964jsVideoHLE.prototype.getGbi0Vertex0=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>>16&15};C1964jsVideoHLE.prototype.getFiddledVertexX=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>16)};C1964jsVideoHLE.prototype.getFiddledVertexY=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a)<<16>>16)};C1964jsVideoHLE.prototype.getFiddledVertexZ=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>16)};C1964jsVideoHLE.prototype.getVertexX=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>16)};C1964jsVideoHLE.prototype.getVertexY=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a)<<16>>16)};C1964jsVideoHLE.prototype.getVertexZ=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>16)};C1964jsVideoHLE.prototype.getVertexS=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+8)>>16)};C1964jsVideoHLE.prototype.getVertexT=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+
8)<<16>>16)};C1964jsVideoHLE.prototype.getVertexColorR=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)>>>24)};C1964jsVideoHLE.prototype.getVertexColorG=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)>>16&255)};C1964jsVideoHLE.prototype.getVertexColorB=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a+12)>>8&255)};C1964jsVideoHLE.prototype.getVertexAlpha=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)&255)};C1964jsVideoHLE.prototype.getVertexNormalX=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)>>>24)};C1964jsVideoHLE.prototype.getVertexNormalY=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a+12)>>16&255)};C1964jsVideoHLE.prototype.getVertexNormalZ=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)>>8&255)};C1964jsVideoHLE.prototype.toSByte=function(a){return 127<a?a-256:a};C1964jsVideoHLE.prototype.getTextureLevel=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>11&7)};C1964jsVideoHLE.prototype.getTextureTile=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a)>>8&7)};C1964jsVideoHLE.prototype.getTextureOn=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)&15)};C1964jsVideoHLE.prototype.getTextureScaleS=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>16&65535)};C1964jsVideoHLE.prototype.getTextureScaleT=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a+4)&65535)};C1964jsVideoHLE.prototype.getCombineA0=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>20&15)};C1964jsVideoHLE.prototype.getCombineB0=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>28&15)};C1964jsVideoHLE.prototype.getCombineC0=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a)>>15&31)};C1964jsVideoHLE.prototype.getCombineD0=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>15&7)};C1964jsVideoHLE.prototype.getCombineA0a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>12&7)};C1964jsVideoHLE.prototype.getCombineB0a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a+4)>>12&7)};C1964jsVideoHLE.prototype.getCombineC0a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>9&7)};C1964jsVideoHLE.prototype.getCombineD0a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>9&7)};C1964jsVideoHLE.prototype.getCombineA1=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a)>>5&15)};C1964jsVideoHLE.prototype.getCombineB1=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>24&15)};C1964jsVideoHLE.prototype.getCombineC1=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)&31)};C1964jsVideoHLE.prototype.getCombineD1=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a+4)>>6&7)};C1964jsVideoHLE.prototype.getCombineA1a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>21&7)};C1964jsVideoHLE.prototype.getCombineB1a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>3&7)};C1964jsVideoHLE.prototype.getCombineC1a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a+4)>>18&7)};C1964jsVideoHLE.prototype.getCombineD1a=function(a){return Number(this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)&7)};C1964jsVideoHLE.prototype.gbi0isProjectionMatrix=function(a){return 0!==(this.core.memory.rdramUint8Array[a+1]&1)?!0:!1};C1964jsVideoHLE.prototype.gbi0LoadMatrix=function(a){return 0!==(this.core.memory.rdramUint8Array[a+1]&2)?!0:!1};C1964jsVideoHLE.prototype.gbi0PushMatrix=function(a){return 0!==
(this.core.memory.rdramUint8Array[a+1]&4)?!0:!1};C1964jsVideoHLE.prototype.getTexRectXh=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>>12&4095};C1964jsVideoHLE.prototype.getTexRectYh=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)&4095};C1964jsVideoHLE.prototype.getTexRectTileNo=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,
a+4)>>>24&7};C1964jsVideoHLE.prototype.getTexRectXl=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)>>>12&4095};C1964jsVideoHLE.prototype.getTexRectYl=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4)&4095};C1964jsVideoHLE.prototype.getTexRectS=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)>>>16&65535};
C1964jsVideoHLE.prototype.getTexRectT=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+12)&65535};C1964jsVideoHLE.prototype.getTexRectDsDx=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+20)>>>16&65535};C1964jsVideoHLE.prototype.getTexRectDtDy=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+20)&65535};C1964jsVideoHLE.prototype.getGbi1Type=
function(){};C1964jsVideoHLE.prototype.getGbi1Length=function(){};C1964jsVideoHLE.prototype.getGbi1RspSegmentAddr=function(){};C1964jsVideoHLE.prototype.getRspSegmentAddr=function(a){return this.segments[a>>24&15]+(a&16777215)};C1964jsVideoHLE.prototype.getTImgWidth=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)&4095};C1964jsVideoHLE.prototype.getTImgSize=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
this.core.memory.rdramUint8Array,a)>>>19&3};C1964jsVideoHLE.prototype.getTImgFormat=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a)>>>21&7};C1964jsVideoHLE.prototype.getTImgAddr=function(a){a=this.core.memory.getInt32(this.core.memory.rdramUint8Array,this.core.memory.rdramUint8Array,a+4);return this.getRspSegmentAddr(a)};C1964jsVideoHLE.prototype.getSetTileFmt=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,
a)>>21&7};C1964jsVideoHLE.prototype.getSetTileSiz=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)>>19&3};C1964jsVideoHLE.prototype.getSetTileLine=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)>>9&511};C1964jsVideoHLE.prototype.getSetTileTmem=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)&511};C1964jsVideoHLE.prototype.getSetTileTile=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,
a+4)>>24&7};C1964jsVideoHLE.prototype.getSetTilePal=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>20&15};C1964jsVideoHLE.prototype.getSetTileCmt=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>18&3};C1964jsVideoHLE.prototype.getSetTileMaskt=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>14&15};C1964jsVideoHLE.prototype.getSetTileShiftt=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)>>10&15};C1964jsVideoHLE.prototype.getSetTileCms=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>8&3};C1964jsVideoHLE.prototype.getSetTileMasks=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>4&15};C1964jsVideoHLE.prototype.getSetTileShifts=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)&15};C1964jsVideoHLE.prototype.getLoadBlockTile=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)>>24&7};C1964jsVideoHLE.prototype.getLoadBlockUls=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)>>12&4095};C1964jsVideoHLE.prototype.getLoadBlockUlt=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)&4095};C1964jsVideoHLE.prototype.getLoadBlockLrs=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>12&4095};C1964jsVideoHLE.prototype.getLoadBlockDxt=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)&4095};C1964jsVideoHLE.prototype.getSetTileSizeTile=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>24&7};C1964jsVideoHLE.prototype.getSetTileSizeUls=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)>>12&4095};C1964jsVideoHLE.prototype.getSetTileSizeUlt=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)&4095};C1964jsVideoHLE.prototype.getSetTileSizeLrs=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)>>12&4095};C1964jsVideoHLE.prototype.getSetTileSizeLrt=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)&4095};C1964jsVideoHLE.prototype.getSetPrimColorM=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)>>8&255};C1964jsVideoHLE.prototype.getSetPrimColorL=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a)&255};C1964jsVideoHLE.prototype.getSetPrimColorR=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)>>24&255};C1964jsVideoHLE.prototype.getSetPrimColorG=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>16&255};C1964jsVideoHLE.prototype.getSetPrimColorB=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>8&255};C1964jsVideoHLE.prototype.getSetPrimColorA=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)&255};C1964jsVideoHLE.prototype.getSetGeometryMode=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)};C1964jsVideoHLE.prototype.getClearGeometryMode=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)};C1964jsVideoHLE.prototype.pow2roundup=function(a){var b;for(b=1;b<a;)b<<=1;return b};C1964jsVideoHLE.prototype.getSetFillColorR=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>24&255};C1964jsVideoHLE.prototype.getSetFillColorG=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,
a+4)>>16&255};C1964jsVideoHLE.prototype.getSetFillColorB=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>8&255};C1964jsVideoHLE.prototype.getSetFillColorA=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)&255};C1964jsVideoHLE.prototype.getSetEnvColorR=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>24&255};C1964jsVideoHLE.prototype.getSetEnvColorG=function(a){return this.core.memory.getInt32(0,
this.core.memory.rdramUint8Array,a+4)>>16&255};C1964jsVideoHLE.prototype.getSetEnvColorB=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)>>8&255};C1964jsVideoHLE.prototype.getSetEnvColorA=function(a){return this.core.memory.getInt32(0,this.core.memory.rdramUint8Array,a+4)&255};C1964jsVideoHLE.prototype.microcodeMap0="RSP_GBI1_SpNoop RSP_GBI0_Mtx RSP_GBI1_Reserved RSP_GBI1_MoveMem RSP_GBI0_Vtx RSP_GBI1_Reserved RSP_GBI0_DL RSP_GBI1_Reserved RSP_GBI1_Reserved RSP_GBI0_Sprite2DBase RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_GBI0_Tri4 RSP_GBI1_RDPHalf_Cont RSP_GBI1_RDPHalf_2 RSP_GBI1_RDPHalf_1 RSP_GBI1_Line3D RSP_GBI1_ClearGeometryMode RSP_GBI1_SetGeometryMode RSP_GBI1_EndDL RSP_GBI1_SetOtherModeL RSP_GBI1_SetOtherModeH RSP_GBI1_Texture RSP_GBI1_MoveWord RSP_GBI1_PopMtx RSP_GBI1_CullDL RSP_GBI1_Tri1 RSP_GBI1_Noop RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RDP_TriFill RDP_TriFillZ RDP_TriTxtr RDP_TriTxtrZ RDP_TriShade RDP_TriShadeZ RDP_TriShadeTxtr RDP_TriShadeTxtrZ RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing DLParser_TexRect DLParser_TexRectFlip DLParser_RDPLoadSynch DLParser_RDPPipeSynch DLParser_RDPTileSynch DLParser_RDPFullSynch DLParser_SetKeyGB DLParser_SetKeyR DLParser_SetConvert DLParser_SetScissor DLParser_SetPrimDepth DLParser_RDPSetOtherMode DLParser_LoadTLut RSP_RDP_Nothing DLParser_SetTileSize DLParser_LoadBlock DLParser_LoadTile DLParser_SetTile DLParser_FillRect DLParser_SetFillColor DLParser_SetFogColor DLParser_SetBlendColor DLParser_SetPrimColor DLParser_SetEnvColor DLParser_SetCombine DLParser_SetTImg DLParser_SetZImg DLParser_SetCImg".split(" ")}).call(this);(function(){var a;a=function(a,b){this.gl=void 0;this.core=a;this.webGLStart(b);return this};var b,d,c,e;d=e=c=void 0;b=mat4.create();d=[];e=mat4.create();c=mat4.create();a.prototype.initGL=function(a){try{log("canvas = "+a),log("canvas.getContext = "+a.getContext),this.gl=a.getContext("webgl")||a.getContext("moz-webgl")||a.getContext("webkit-3d")||a.getContext("experimental-webgl"),log("gl = "+this.gl),this.gl.viewportWidth=a.width,log("this.gl.viewportWidth = "+this.gl.viewportWidth),this.gl.viewportHeight=
a.height,log("this.gl.viewportHeight = "+this.gl.viewportHeight)}catch(b){}this.gl||log("Could not initialise WebGL. Your browser may not support it.")};a.prototype.loadFile=function(a,b,c,d){var e;e=new XMLHttpRequest;e.open("GET",a,!1);e.onreadystatechange=function(){4===e.readyState&&(200===e.status?c(e.responseText,b):d(a))};e.send(null)};a.prototype.loadFiles=function(a,b,c){var d,e,j,l,m;j=a.length;e=0;m=[];l=function(a,c){m[c]=a;e+=1;e===j&&b(m)};for(d=0;d<j;)this.loadFile(a[d],d,l,c),d++};
a.prototype.initShaders=function(a,b){var c,d,e,j=this;c=e=d=void 0;this.loadFiles(["shaders/"+a,"shaders/"+b],function(d){e=j.gl.createShader(j.gl.VERTEX_SHADER);c=j.gl.createShader(j.gl.FRAGMENT_SHADER);j.gl.shaderSource(c,d[0]);j.gl.shaderSource(e,d[1]);j.gl.compileShader(c);j.gl.compileShader(e);j.gl.getShaderParameter(e,j.gl.COMPILE_STATUS)||alert(b+": "+j.gl.getShaderInfoLog(e));j.gl.getShaderParameter(c,j.gl.COMPILE_STATUS)||alert(j.gl.getShaderInfoLog(a+" "+c))},function(a){alert('Failed to download "'+
a+'"')});d=this.gl.createProgram();this.gl.attachShader(d,e);this.gl.attachShader(d,c);this.gl.linkProgram(d);this.gl.getProgramParameter(d,this.gl.LINK_STATUS)||alert("Could not initialize shaders");this.gl.useProgram(d);d.vertexPositionAttribute=this.gl.getAttribLocation(d,"aVertexPosition");d.vertexColorAttribute=this.gl.getAttribLocation(d,"aVertexColor");d.pMatrixUniform=this.gl.getUniformLocation(d,"uPMatrix");d.mvMatrixUniform=this.gl.getUniformLocation(d,"uMVMatrix");d.nMatrixUniform=this.gl.getUniformLocation(d,
"uNormalMatrix");d.textureCoordAttribute=this.gl.getAttribLocation(d,"aTextureCoord");d.samplerUniform=this.gl.getUniformLocation(d,"uSampler");d.wireframeUniform=this.gl.getUniformLocation(d,"uWireframe");d.uCombineA0=this.gl.getUniformLocation(d,"uCombineA0");d.uCombineB0=this.gl.getUniformLocation(d,"uCombineB0");d.uCombineC0=this.gl.getUniformLocation(d,"uCombineC0");d.uCombineD0=this.gl.getUniformLocation(d,"uCombineD0");d.uCombineA0a=this.gl.getUniformLocation(d,"uCombineA0a");d.uCombineB0a=
this.gl.getUniformLocation(d,"uCombineB0a");d.uCombineC0a=this.gl.getUniformLocation(d,"uCombineC0a");d.uCombineD0a=this.gl.getUniformLocation(d,"uCombineD0a");d.uCombineA1=this.gl.getUniformLocation(d,"uCombineA1");d.uCombineB1=this.gl.getUniformLocation(d,"uCombineB1");d.uCombineC1=this.gl.getUniformLocation(d,"uCombineC1");d.uCombineD1=this.gl.getUniformLocation(d,"uCombineD1");d.uCombineA1a=this.gl.getUniformLocation(d,"uCombineA1a");d.uCombineB1a=this.gl.getUniformLocation(d,"uCombineB1a");d.uCombineC1a=
this.gl.getUniformLocation(d,"uCombineC1a");d.uCombineD1a=this.gl.getUniformLocation(d,"uCombineD1a");d.uPrimColor=this.gl.getUniformLocation(d,"uPrimColor");d.uFillColor=this.gl.getUniformLocation(d,"uFillColor");d.uEnvColor=this.gl.getUniformLocation(d,"uEnvColor");return d};a.prototype.setCombineUniforms=function(a){var b;b=this.core.videoHLE;this.gl.uniform1i(a.uCombineA0,b.combineA0);this.gl.uniform1i(a.uCombineB0,b.combineB0);this.gl.uniform1i(a.uCombineC0,b.combineC0);this.gl.uniform1i(a.uCombineD0,
b.combineD0);this.gl.uniform1i(a.uCombineA0a,b.combineA0a);this.gl.uniform1i(a.uCombineB0a,b.combineB0a);this.gl.uniform1i(a.uCombineC0a,b.combineC0a);this.gl.uniform1i(a.uCombineD0a,b.combineD0a);this.gl.uniform1i(a.uCombineA1,b.combineA1);this.gl.uniform1i(a.uCombineB1,b.combineB1);this.gl.uniform1i(a.uCombineC1,b.combineC1);this.gl.uniform1i(a.uCombineD1,b.combineD1);this.gl.uniform1i(a.uCombineA1a,b.combineA1a);this.gl.uniform1i(a.uCombineB1a,b.combineB1a);this.gl.uniform1i(a.uCombineC1a,b.combineC1a);
this.gl.uniform1i(a.uCombineD1a,b.combineD1a)};a.prototype.beginDList=function(){this.gl.viewport(0,0,this.gl.viewportWidth,this.gl.viewportHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);mat4.perspective(45,this.gl.viewportWidth/this.gl.viewportHeight,0.1,100,e);mat4.identity(b);mat4.translate(b,[0,0,-2.4]);mat4.set(b,c);mat4.inverse(c,c);mat4.transpose(c);mat4.translate(b,[0,0,-1])};a.prototype.setMatrixUniforms=function(a){this.gl.uniformMatrix4fv(a.pMatrixUniform,!1,e);
this.gl.uniformMatrix4fv(a.mvMatrixUniform,!1,b);this.gl.uniformMatrix4fv(a.nMatrixUniform,!1,c)};a.prototype.mvPushMatrix=function(){var a;a=mat4.create();mat4.set(b,a);d.push(a)};a.prototype.mvPopMatrix=function(){if(0===d.length)throw Error("Invalid popMatrix!");b=d.pop()};a.prototype.webGLStart=function(){var a;a=document.getElementById("Canvas3D");this.initGL(a);this.shaderProgram=this.initShaders("fragment.shader","vertex.shader");this.gl&&this.gl.clearColor(0,0,0,1);a.style.visibility="hidden"};
a.prototype.show3D=function(){document.getElementById("Canvas3D").style.visibility="visible"};a.prototype.hide3D=function(){document.getElementById("Canvas3D").style.visibility="hidden"};("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsWebGL=a}).call(this);var bitjs=bitjs||{};bitjs.io=bitjs.io||{};
(function(){bitjs.BIT=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768];var a=[0,1,3,7,15,31,63,127,255];bitjs.io.BitStream=function(a,d,c,e){if(!a||!a.toString||"[object ArrayBuffer]"!==a.toString())throw"Error! BitArray constructed with an invalid ArrayBuffer object";this.bytes=new Uint8Array(a,c||0,e||a.byteLength);this.bitPtr=this.bytePtr=0;this.peekBits=d?this.peekBits_rtl:this.peekBits_ltr};bitjs.io.BitStream.prototype.peekBits_ltr=function(b,d){if(0>=b||"number"!=typeof b)return 0;
for(var c=this.bytePtr,e=this.bitPtr,g=0,f=0,h=this.bytes;0<b;){if(c>=h.length)throw"Error!  Overflowed the bit stream! n="+b+", bytePtr="+c+", bytes.length="+h.length+", bitPtr="+e;var i=8-e;if(b>=i){var k=a[i]<<e,g=g|(h[c]&k)>>e<<f;c++;e=0;f+=i;b-=i}else k=a[b]<<e,g|=(h[c]&k)>>e<<f,e+=b,f+=b,b=0}d&&(this.bitPtr=e,this.bytePtr=c);return g};bitjs.io.BitStream.prototype.peekBits_rtl=function(b,d){if(0>=b||"number"!=typeof b)return 0;for(var c=this.bytePtr,e=this.bitPtr,g=0,f=this.bytes;0<b;){if(c>=
f.length)throw"Error!  Overflowed the bit stream! n="+b+", bytePtr="+c+", bytes.length="+f.length+", bitPtr="+e;var h=8-e;b>=h?(g<<=h,g|=a[h]&f[c],c++,e=0,b-=h):(g<<=b,g|=(f[c]&a[b]<<8-b-e)>>8-b-e,e+=b,b=0)}d&&(this.bitPtr=e,this.bytePtr=c);return g};bitjs.io.BitStream.prototype.getBits=function(){return((this.bytes[this.bytePtr]&255)<<16)+((this.bytes[this.bytePtr+1]&255)<<8)+(this.bytes[this.bytePtr+2]&255)>>>8-this.bitPtr&65535};bitjs.io.BitStream.prototype.readBits=function(a){return this.peekBits(a,
!0)};bitjs.io.BitStream.prototype.peekBytes=function(a,d){if(0>=a||"number"!=typeof a)return 0;for(;0!=this.bitPtr;)this.readBits(1);var d=d||!1,c=this.bytePtr,c=this.bytes.subarray(c,c+a);d&&(this.bytePtr+=a);return c};bitjs.io.BitStream.prototype.readBytes=function(a){return this.peekBytes(a,!0)};bitjs.io.ByteStream=function(a,d,c){this.bytes=new Uint8Array(a,d||0,c||a.byteLength);this.ptr=0};bitjs.io.ByteStream.prototype.peekNumber=function(a){if(0>=a||"number"!=typeof a)return-1;for(var d=0,a=
this.ptr+a-1;a>=this.ptr;)d<<=8,d|=this.bytes[a],--a;return d};bitjs.io.ByteStream.prototype.readNumber=function(a){var d=this.peekNumber(a);this.ptr+=a;return d};bitjs.io.ByteStream.prototype.peekBytes=function(a,d){if(0>=a||"number"!=typeof a)return 0;var c=this.bytes.subarray(this.ptr,this.ptr+a);d&&(this.ptr+=a);return c};bitjs.io.ByteStream.prototype.readBytes=function(a){return this.peekBytes(a,!0)};bitjs.io.ByteStream.prototype.peekString=function(a){if(0>=a||"number"!=typeof a)return 0;for(var d=
"",c=this.ptr,a=this.ptr+a;c<a;++c)d+=String.fromCharCode(this.bytes[c]);return d};bitjs.io.ByteStream.prototype.readString=function(a){var d=this.peekString(a);this.ptr+=a;return d};bitjs.io.ByteBuffer=function(a){if("number"!=typeof a||0>=a)throw"Error! ByteBuffer initialized with '"+a+"'";this.data=new Uint8Array(a);this.ptr=0};bitjs.io.ByteBuffer.prototype.insertByte=function(a){this.data[this.ptr++]=a};bitjs.io.ByteBuffer.prototype.insertBytes=function(a){this.data.set(a,this.ptr);this.ptr+=
a.length}})();bitjs=bitjs||{};bitjs.archive=bitjs.archive||{};
(function(){bitjs.base=function(a,b,d){var c=arguments.callee.caller;if(c.superClass_)return c.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),g=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===c)g=!0;else if(g)return f.prototype[b].apply(a,e);if(a[b]===c)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};
bitjs.inherits=function(a,b){function d(){}d.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new d;a.prototype.constructor=a};bitjs.archive.UnarchiveEvent=function(a){this.type=a};bitjs.archive.UnarchiveEvent.Type={START:"start",PROGRESS:"progress",EXTRACT:"extract",FINISH:"finish",INFO:"info",ERROR:"error"};bitjs.archive.UnarchiveInfoEvent=function(a){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.INFO);this.msg=a};bitjs.inherits(bitjs.archive.UnarchiveInfoEvent,bitjs.archive.UnarchiveEvent);
bitjs.archive.UnarchiveErrorEvent=function(a){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.ERROR);this.msg=a};bitjs.inherits(bitjs.archive.UnarchiveErrorEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveStartEvent=function(){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.START)};bitjs.inherits(bitjs.archive.UnarchiveStartEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveFinishEvent=function(){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.FINISH)};bitjs.inherits(bitjs.archive.UnarchiveFinishEvent,
bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveProgressEvent=function(a,b,d,c,e,g){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.PROGRESS);this.currentFilename=a;this.currentFileNumber=b;this.currentBytesUnarchivedInFile=d;this.totalFilesInArchive=g;this.currentBytesUnarchived=c;this.totalUncompressedBytesInArchive=e};bitjs.inherits(bitjs.archive.UnarchiveProgressEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveExtractEvent=function(a){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.EXTRACT);
this.unarchivedFile=a};bitjs.inherits(bitjs.archive.UnarchiveExtractEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.Unarchiver=function(a,b){this.ab=a;this.pathToBitJS_=b||"";this.listeners_={};for(var d in bitjs.archive.UnarchiveEvent.Type)this.listeners_[bitjs.archive.UnarchiveEvent.Type[d]]=[]};bitjs.archive.Unarchiver.prototype.worker_=null;bitjs.archive.Unarchiver.prototype.getScriptFileName=function(){throw"Subclasses of AbstractUnarchiver must overload getScriptFileName()";};bitjs.archive.Unarchiver.prototype.addEventListener=
function(a,b){a in this.listeners_&&-1==this.listeners_[a].indexOf(b)&&this.listeners_[a].push(b)};bitjs.archive.Unarchiver.prototype.removeEventListener=function(a,b){if(a in this.listeners_){var d=this.listeners_[a].indexOf(b);-1!=d&&this.listeners_[a].splice(d,1)}};bitjs.archive.Unarchiver.prototype.handleWorkerEvent_=function(a){(a instanceof bitjs.archive.UnarchiveEvent||a.type)&&this.listeners_[a.type]instanceof Array?this.listeners_[a.type].forEach(function(b){b(a)}):console.log(a)};bitjs.archive.Unarchiver.prototype.start=
function(){var a=this,b=this.pathToBitJS_+this.getScriptFileName();b&&(this.worker_=new Worker(b),this.worker_.onerror=function(a){console.log("Worker error: message = "+a.message);throw a;},this.worker_.onmessage=function(b){"string"==typeof b.data?console.log(b.data):a.handleWorkerEvent_(b.data)},this.worker_.postMessage({file:this.ab}))};bitjs.archive.Unzipper=function(a,b){bitjs.base(this,a,b)};bitjs.inherits(bitjs.archive.Unzipper,bitjs.archive.Unarchiver);bitjs.archive.Unzipper.prototype.getScriptFileName=
function(){return"unzip.min.js"};bitjs.archive.Unrarrer=function(a,b){bitjs.base(this,a,b)};bitjs.inherits(bitjs.archive.Unrarrer,bitjs.archive.Unarchiver);bitjs.archive.Unrarrer.prototype.getScriptFileName=function(){return"unrar.js"};bitjs.archive.Untarrer=function(a,b){bitjs.base(this,a,b)};bitjs.inherits(bitjs.archive.Untarrer,bitjs.archive.Unarchiver);bitjs.archive.Untarrer.prototype.getScriptFileName=function(){return"untar.js"}})();(function(){var a,b,d,c,e,g,f,h;g=d=void 0;this.progress=document.querySelector(".percent");a="";window.File?window.FileReader?window.FileList?window.Blob||(alertMessge+=" window.Blob"):a+=" window.FileList":a+=" window.FileReader":a+=" window.File";0<a.length&&log("Unsupported in this browser: "+a);this.i1964js=void 0;c=function(){var a,b,c,d;d=[];b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(c=0;c<b.length;)a=b[c].split("="),d.push(a[0]),d[a[0]]=unescape(a[1]),
c++;return d};e=function(a){try{void 0!==this.i1964js&&null!=this.i1964js&&this.i1964js.stopEmulatorAndCleanup(),this.i1964js=new C1964jsEmulator(d),this.i1964js.init(a)}catch(b){throw void 0!==this.i1964js&&null!=this.i1964js&&(this.i1964js.terminate=!0),b;}};f=function(a,b){var c,d;"zip"!==a.split(".").pop().toLowerCase()?(c=new Uint8Array(b),this.romLength=c.byteLength,e(c)):(d=new bitjs.archive.Unzipper(b,"lib/bitjs/"),d.addEventListener(bitjs.archive.UnarchiveEvent.Type.EXTRACT,function(a){if(a.unarchivedFile)return console.log("extracted: "+
a.unarchivedFile.filename),c=new Uint8Array(a.unarchivedFile.fileData),this.romLength=c.byteLength,e(c)}),d.addEventListener(bitjs.archive.UnarchiveEvent.Type.INFO,function(a){return console.log("zip info: "+a.msg)}),d.addEventListener(bitjs.archive.UnarchiveEvent.Type.PROGRESS,function(){}),d.addEventListener(bitjs.archive.UnarchiveEvent.Type.FINISH,function(a){return console.log("finish: "+a.msg)}),d.addEventListener(bitjs.archive.UnarchiveEvent.Type.ERROR,function(a){return console.log("ERROR: "+
a.msg)}),d.start())};this.start1964=function(a){var b,e;d=a;document.getElementById("user_panel").className="show";e=c();b=void 0;for(a=0;a<e.length;)"rom"===e[a]&&(b=e[e[a]]),a++;void 0!==b&&null!=b&&(a=new XMLHttpRequest,a.open("GET",b,!0),a.responseType="arraybuffer",a.send(),a.onload=function(a){return f(b,a.target.response)})};b=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case a.target.error.NOT_READABLE_ERR:alert("File is not readable");
break;case a.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};h=function(a){a.lengthComputable&&(a=Math.round(100*(a.loaded/a.total)),100>a&&void 0!==this.progress&&(this.progress.style.width=a+"%",this.progress.textContent=a+"%"))};document.getElementById("user_panel").onmousemove=function(){return document.getElementById("user_panel").className="show"};document.getElementById("user_panel").ontouchend=function(a){document.getElementById("user_panel").className=
"show";a.cancelBubble=!0;if(a.stopPropagation)return a.stopPropagation()};document.getElementById("user_panel").onmouseup=function(a){a.cancelBubble=!0;if(a.stopPropagation)return a.stopPropagation()};document.onmouseup=function(){return document.getElementById("user_panel").className=""===document.getElementById("user_panel").className?"show":""};document.ontouchend=function(){return document.getElementById("user_panel").className=""===document.getElementById("user_panel").className?"show":""};document.getElementById("files").addEventListener("change",
function(a){var c;void 0===a.target.files||void 0===a.target.files[0]||(c=a.target.files[0].name,this.progressBar=document.getElementById("progress_bar"),void 0!==this.progress&&(this.progress.style.width="0%",this.progress.textContent="0%"),g=new FileReader,g.onerror=b,g.onprogress=h,g.onabort=function(){alert("File read cancelled")},g.onloadstart=function(){void 0!==this.progressBar&&(document.getElementById("progress_bar").className="loading")},g.onload=function(){void 0!==this.progress&&(this.progress.style.width=
"100%",this.progress.textContent="100%");void 0!==this.progressBar&&setTimeout("document.getElementById('progress_bar').className='';document.getElementById('user_panel').className='';",1E3);f(c,g.result)},g.readAsArrayBuffer(a.target.files[0]))},!1)}).call(this);
