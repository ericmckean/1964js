/*
 1964js - JavaScript/HTML5 port of 1964 - N64 emulator
Copyright (C) 2012 Joel Middendorf

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
*/
(function(){var a;a=function(){return function(){this.MEMORY_START_PIF=532676608;this.MEMORY_START_PIF_RAM=532678592;this.MEMORY_SIZE_PIF=65536;this.INDEX=0;this.RANDOM=1;this.ENTRYLO0=2;this.ENTRYLO1=3;this.CONTEXT=4;this.PAGEMASK=5;this.WIRED=6;this.RESERVED0=7;this.BADVADDR=8;this.COUNT=9;this.ENTRYHI=10;this.COMPARE=11;this.STATUS=12;this.CAUSE=13;this.EPC=14;this.PREVID=15;this.CONFIG=16;this.LLADDR=17;this.WATCHLO=18;this.WATCHHI=19;this.XCONTEXT=20;this.RESERVED1=21;this.RESERVED2=22;this.RESERVED3=
23;this.RESERVED4=24;this.RESERVED5=25;this.PERR=26;this.CACHEERR=27;this.TAGLO=28;this.TAGHI=29;this.ERROREPC=30;this.RESERVED6=31;this.SP_DMEM_TASK=4032;this.SP_MEM_ADDR_REG=0;this.SP_DRAM_ADDR_REG=4;this.SP_RD_LEN_REG=8;this.SP_WR_LEN_REG=12;this.SP_STATUS_REG=16;this.SP_DMA_FULL_REG=20;this.SP_DMA_BUSY_REG=24;this.SP_SEMAPHORE_REG=28;this.SP_PC_REG=0;this.SP_IBIST_REG=4;this.VI_STATUS_REG=0;this.VI_ORIGIN_REG=4;this.VI_WIDTH_REG=8;this.VI_INTR_REG=12;this.VI_CURRENT_REG=16;this.VI_BURST_REG=20;
this.VI_V_SYNC_REG=24;this.VI_H_SYNC_REG=28;this.VI_LEAP_REG=32;this.VI_H_START_REG=36;this.VI_V_START_REG=40;this.VI_V_BURST_REG=44;this.VI_X_SCALE_REG=48;this.VI_Y_SCALE_REG=52;this.AI_DRAM_ADDR_REG=0;this.AI_LEN_REG=4;this.AI_CONTROL_REG=8;this.AI_STATUS_REG=12;this.AI_DACRATE_REG=16;this.AI_BITRATE_REG=20;this.PI_DRAM_ADDR_REG=0;this.PI_CART_ADDR_REG=4;this.PI_RD_LEN_REG=8;this.PI_WR_LEN_REG=12;this.PI_STATUS_REG=16;this.PI_BSD_DOM1_LAT_REG=20;this.PI_BSD_DOM1_PWD_REG=24;this.PI_BSD_DOM1_PGS_REG=
28;this.PI_BSD_DOM1_RLS_REG=32;this.PI_BSD_DOM2_LAT_REG=36;this.PI_BSD_DOM2_PWD_REG=40;this.PI_BSD_DOM2_PGS_REG=44;this.PI_BSD_DOM2_RLS_REG=48;this.RI_MODE_REG=0;this.RI_CONFIG_REG=4;this.RI_CURRENT_LOAD_REG=8;this.RI_SELECT_REG=12;this.RI_REFRESH_REG=16;this.RI_LATENCY_REG=20;this.RI_RERROR_REG=24;this.RI_WERROR_REG=28;this.MI_INIT_MODE_REG=0;this.MI_VERSION_REG=4;this.MI_INTR_REG=8;this.MI_INTR_MASK_REG=12;this.SI_DRAM_ADDR_REG=0;this.SI_PIF_ADDR_RD64B_REG=4;this.SI_PIF_ADDR_WR64B_REG=16;this.SI_STATUS_REG=
24;this.SI_STATUS_DMA_BUSY=1;this.SI_STATUS_RD_BUSY=2;this.SI_STATUS_DMA_ERROR=8;this.SI_STATUS_INTERRUPT=4096;this.AI_STATUS_FIFO_FULL=2147483648;this.AI_STATUS_DMA_BUSY=1073741824;this.PI_STATUS_RESET=1;this.PI_STATUS_CLR_INTR=2;this.PI_STATUS_ERROR=4;this.PI_STATUS_IO_BUSY=2;this.MI_INTR_SP=this.PI_STATUS_DMA_BUSY=1;this.MI_INTR_SI=2;this.MI_INTR_AI=4;this.MI_INTR_VI=8;this.MI_INTR_PI=16;this.MI_INTR_DP=32;this.MI_INTR_MASK_SP=1;this.MI_INTR_MASK_SI=2;this.MI_INTR_MASK_AI=4;this.MI_INTR_MASK_VI=
8;this.MI_INTR_MASK_PI=16;this.MI_INTR_MASK_DP=32;this.MI_INTR_MASK_SP_CLR=1;this.MI_INTR_MASK_SP_SET=2;this.MI_INTR_MASK_SI_CLR=4;this.MI_INTR_MASK_SI_SET=8;this.MI_INTR_MASK_AI_CLR=16;this.MI_INTR_MASK_AI_SET=32;this.MI_INTR_MASK_VI_CLR=64;this.MI_INTR_MASK_VI_SET=128;this.MI_INTR_MASK_PI_CLR=256;this.MI_INTR_MASK_PI_SET=512;this.MI_INTR_MASK_DP_CLR=1024;this.MI_INTR_MASK_DP_SET=2048;this.MI_MODE_INIT=128;this.MI_MODE_EBUS=256;this.MI_MODE_RDRAM=512;this.MI_CLR_INIT=128;this.MI_SET_INIT=256;this.MI_CLR_EBUS=
512;this.MI_SET_EBUS=1024;this.MI_CLR_DP_INTR=2048;this.MI_CLR_RDRAM=4096;this.MI_SET_RDRAM=8192;this.DPC_START_REG=0;this.DPC_END_REG=4;this.DPC_CURRENT_REG=8;this.DPC_STATUS_REG=12;this.DPC_CLOCK_REG=16;this.DPC_BUFBUSY_REG=20;this.DPC_PIPEBUSY_REG=24;this.DPC_TMEM_REG=28;this.SP_STATUS_HALT=1;this.SP_STATUS_BROKE=2;this.SP_STATUS_DMA_BUSY=4;this.SP_STATUS_DMA_FULL=8;this.SP_STATUS_IO_FULL=16;this.SP_STATUS_SSTEP=32;this.SP_STATUS_INTR_BREAK=64;this.SP_STATUS_YIELD=128;this.SP_STATUS_YIELDED=256;
this.SP_STATUS_TASKDONE=512;this.SP_STATUS_SIG3=1024;this.SP_STATUS_SIG4=2048;this.SP_STATUS_SIG5=4096;this.SP_STATUS_SIG6=8192;this.SP_STATUS_SIG7=16384;this.DPC_STATUS_XBUS_DMEM_DMA=1;this.DPC_STATUS_FREEZE=2;this.DPC_STATUS_FLUSH=4;this.DPC_STATUS_START_GCLK=8;this.DPC_STATUS_TMEM_BUSY=16;this.DPC_STATUS_PIPE_BUSY=32;this.DPC_STATUS_CMD_BUSY=64;this.DPC_STATUS_CBUF_READY=128;this.DPC_STATUS_DMA_BUSY=256;this.DPC_STATUS_END_VALID=512;this.DPC_STATUS_START_VALID=1024;this.DPC_CLR_XBUS_DMEM_DMA=1;
this.DPC_SET_XBUS_DMEM_DMA=2;this.DPC_CLR_FREEZE=4;this.DPC_SET_FREEZE=8;this.DPC_CLR_FLUSH=16;this.DPC_SET_FLUSH=32;this.DPC_CLR_TMEM_REG=64;this.DPC_CLR_PIPEBUSY_REG=128;this.DPC_CLR_BUFBUSY_REG=256;this.DPC_CLR_CLOCK_REG=512;this.IE=1;this.EXL=2;this.ERL=4;this.BD=2147483648;this.BEV=4194304;this.EXC_INT=0;this.EXC_MOD=4;this.TLBL_Miss=this.EXC_RMISS=8;this.TLBS_Miss=this.EXC_WMISS=12;this.EXC_RADE=16;this.EXC_WADE=20;this.EXC_IBE=24;this.EXC_DBE=28;this.EXC_SYSCALL=32;this.EXC_BREAK=36;this.EXC_II=
40;this.EXC_CPU=44;this.EXC_OV=48;this.EXC_TRAP=52;this.EXC_VCEI=56;this.EXC_FPE=60;this.EXC_WATCH=92;this.EXC_VCED=124;this.CAUSE_IP8=32768;this.CAUSE_IP7=16384;this.CAUSE_IP6=8192;this.CAUSE_IP5=4096;this.CAUSE_IP4=2048;this.CAUSE_IP3=1024;this.CAUSE_SW2=512;this.CAUSE_SW1=256;this.CAUSE_BD=2147483648;this.COP1_CONDITION_BIT=8388608;this.NTLBENTRIES=31;this.TLBHI_VPN2MASK=4294959104;this.TLBHI_VPN2SHIFT=13;this.TLBHI_PIDMASK=255;this.TLBHI_PIDSHIFT=0;this.TLBHI_NPID=255;this.TLBLO_PFNMASK=1073741760;
this.TLBLO_PFNSHIFT=6;this.TLBLO_CACHMASK=56;this.TLBLO_CACHSHIFT=3;this.TLBLO_UNCACHED=16;this.TLBLO_NONCOHRNT=24;this.TLBLO_EXLWR=40;this.TLBLO_D=4;this.TLBLO_V=2;this.TLBLO_G=1;this.TLBINX_PROBE=2147483648;this.TLBINX_INXMASK=63;this.TLBINX_INXSHIFT=0;this.TLBRAND_RANDMASK=63;this.TLBRAND_RANDSHIFT=0;this.TLBWIRED_WIREDMASK=63;this.TLBCTXT_BASEMASK=4286578688;this.TLBCTXT_BASESHIFT=23;this.TLBCTXT_BASEBITS=9;this.TLBCTXT_VPNMASK=8388592;this.TLBCTXT_VPNSHIFT=4;this.TLBPGMASK_4K=0;this.TLBPGMASK_16K=
24576;this.TLBPGMASK_64K=122880;this.BAD_TASK=0;this.GFX_TASK=1;this.SND_TASK=2;this.JPG_TASK=4;this.TASK_TYPE=4032;this.TASK_FLAGS=4036;this.TASK_MICROCODE_BOOT=4040;this.TASK_MICROCODE_BOOT_SIZE=4044;this.TASK_MICROCODE=4048;this.TASK_MICROCODE_SIZE=4052;this.TASK_MICROCODE_DATA=4056;this.TASK_MICROCODE_DATA_SIZE=4060;this.TASK_DRAM_STACK=4064;this.TASK_DRAM_STACK_SIZE=4068;this.TASK_OUTPUT_BUFF=4072;this.TASK_OUTPUT_BUFF_SIZE=4076;this.TASK_DATA_PTR=4080;this.TASK_DATA_SIZE=4084;this.TASK_YIELD_DATA_PTR=
4088;this.TASK_YIELD_DATA_SIZE=4092;this.MAX_DL_STACK_SIZE=32;this.MAX_DL_COUNT=1E6;this.MAX_VERTS=80;this.RSP_SPNOOP=0;this.RSP_MTX=1;this.RSP_RESERVED0=2;this.RSP_MOVEMEM=3;this.RSP_VTX=4;this.RSP_RESERVED1=5;this.RSP_DL=6;this.RSP_RESERVED2=7;this.RSP_RESERVED3=8;this.RSP_SPRITE2D_BASE=this.RSP_SPRITE2D=9;this.RSP_TRI1=this.RSP_1ST=191;this.RSP_CULLDL=this.RSP_1ST-1;this.RSP_POPMTX=this.RSP_1ST-2;this.RSP_MOVEWORD=this.RSP_1ST-3;this.RSP_TEXTURE=this.RSP_1ST-4;this.RSP_SETOTHERMODE_H=this.RSP_1ST-
5;this.RSP_SETOTHERMODE_L=this.RSP_1ST-6;this.RSP_ENDDL=this.RSP_1ST-7;this.RSP_SETGEOMETRYMODE=this.RSP_1ST-8;this.RSP_CLEARGEOMETRYMODE=this.RSP_1ST-9;this.RSP_LINE3D=this.RSP_1ST-10;this.RSP_RDPHALF_1=this.RSP_1ST-11;this.RSP_RDPHALF_2=this.RSP_1ST-12;this.RSP_RDPHALF_CONT=this.RSP_1ST-13;this.RSP_MODIFYVTX=this.RSP_1ST-13;this.RSP_TRI2=this.RSP_1ST-14;this.RSP_BRANCH_Z=this.RSP_1ST-15;this.RSP_LOAD_UCODE=this.RSP_1ST-16;this.RSP_SPRITE2D_SCALEFLIP=this.RSP_1ST-1;this.RSP_SPRITE2D_DRAW=this.RSP_1ST-
2;this.RSP_ZELDAVTX=1;this.RSP_ZELDAMODIFYVTX=2;this.RSP_ZELDACULLDL=3;this.RSP_ZELDABRANCHZ=4;this.RSP_ZELDATRI1=5;this.RSP_ZELDATRI2=6;this.RSP_ZELDALINE3D=7;this.RSP_ZELDARDPHALF_2=241;this.RSP_ZELDASETOTHERMODE_H=227;this.RSP_ZELDASETOTHERMODE_L=226;this.RSP_ZELDARDPHALF_1=225;this.RSP_ZELDASPNOOP=224;this.RSP_ZELDAENDDL=223;this.RSP_ZELDADL=222;this.RSP_ZELDALOAD_UCODE=221;this.RSP_ZELDAMOVEMEM=220;this.RSP_ZELDAMOVEWORD=219;this.RSP_ZELDAMTX=218;this.RSP_ZELDAGEOMETRYMODE=217;this.RSP_ZELDAPOPMTX=
216;this.RSP_ZELDATEXTURE=215;this.RSP_ZELDASUBMODULE=214;this.RSP_DMATRI=5;this.G_DLINMEM=7;this.RDP_NOOP=192;this.RDP_SETCIMG=255;this.RDP_SETZIMG=254;this.RDP_SETTIMG=253;this.RDP_SETCOMBINE=252;this.RDP_SETENVCOLOR=251;this.RDP_SETPRIMCOLOR=250;this.RDP_SETBLENDCOLOR=249;this.RDP_SETFOGCOLOR=248;this.RDP_SETFILLCOLOR=247;this.RDP_FILLRECT=246;this.RDP_SETTILE=245;this.RDP_LOADTILE=244;this.RDP_LOADBLOCK=243;this.RDP_SETTILESIZE=242;this.RDP_LOADTLUT=240;this.RDP_RDPSETOTHERMODE=239;this.RDP_SETPRIMDEPTH=
238;this.RDP_SETSCISSOR=237;this.RDP_SETCONVERT=236;this.RDP_SETKEYR=235;this.RDP_SETKEYGB=234;this.RDP_FULLSYNC=233;this.RDP_TILESYNC=232;this.RDP_PIPESYNC=231;this.RDP_LOADSYNC=230;this.RDP_TEXRECT_FLIP=229;this.RDP_TEXRECT=228;this.RSP_ZELDA_MTX_MODELVIEW=0;this.RSP_ZELDA_MTX_PROJECTION=4;this.RSP_ZELDA_MTX_MUL=0;this.RSP_ZELDA_MTX_LOAD=2;this.RSP_ZELDA_MTX_PUSH=0;this.RSP_ZELDA_MTX_NOPUSH=1;this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE=0;this.RSP_SETOTHERMODE_SHIFT_ZSRCSEL=2;this.RSP_SETOTHERMODE_SHIFT_RENDERMODE=
3;this.RSP_SETOTHERMODE_SHIFT_BLENDER=16;this.RSP_SETOTHERMODE_SHIFT_BLENDMASK=0;this.RSP_SETOTHERMODE_SHIFT_ALPHADITHER=4;this.RSP_SETOTHERMODE_SHIFT_RGBDITHER=6;this.RSP_SETOTHERMODE_SHIFT_COMBKEY=8;this.RSP_SETOTHERMODE_SHIFT_TEXTCONV=9;this.RSP_SETOTHERMODE_SHIFT_TEXTFILT=12;this.RSP_SETOTHERMODE_SHIFT_TEXTLUT=14;this.RSP_SETOTHERMODE_SHIFT_TEXTLOD=16;this.RSP_SETOTHERMODE_SHIFT_TEXTDETAIL=17;this.RSP_SETOTHERMODE_SHIFT_TEXTPERSP=19;this.RSP_SETOTHERMODE_SHIFT_CYCLETYPE=20;this.RSP_SETOTHERMODE_SHIFT_COLORDITHER=
22;this.RSP_SETOTHERMODE_SHIFT_PIPELINE=23;this.RSP_PIPELINE_MODE_1PRIMITIVE=1<<this.RSP_SETOTHERMODE_SHIFT_PIPELINE;this.RSP_PIPELINE_MODE_NPRIMITIVE=0<<this.RSP_SETOTHERMODE_SHIFT_PIPELINE;this.CYCLE_TYPE_1=0;this.CYCLE_TYPE_2=1;this.CYCLE_TYPE_COPY=2;this.CYCLE_TYPE_FILL=3;this.TLUT_FMT_NONE=0<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;this.TLUT_FMT_UNKNOWN=1<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;this.TLUT_FMT_RGBA16=2<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;this.TLUT_FMT_IA16=3<<this.RSP_SETOTHERMODE_SHIFT_TEXTLUT;
this.RDP_TFILTER_POINT=0<<this.RSP_SETOTHERMODE_SHIFT_TEXTFILT;this.RDP_TFILTER_AVERAGE=3<<this.RSP_SETOTHERMODE_SHIFT_TEXTFILT;this.RDP_TFILTER_BILERP=2<<this.RSP_SETOTHERMODE_SHIFT_TEXTFILT;this.RDP_ALPHA_COMPARE_NONE=0<<this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE;this.RDP_ALPHA_COMPARE_THRESHOLD=1<<this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE;this.RDP_ALPHA_COMPARE_DITHER=3<<this.RSP_SETOTHERMODE_SHIFT_ALPHACOMPARE;this.Z_COMPARE=16;this.Z_UPDATE=32;this.ZMODE_DEC=3072;this.G_ZBUFFER=1;this.G_TEXTURE_ENABLE=
2;this.G_SHADE=4;this.G_SHADING_SMOOTH=512;this.G_CULL_FRONT=4096;this.G_CULL_BACK=8192;this.G_CULL_BOTH=12288;this.G_FOG=65536;this.G_LIGHTING=131072;this.G_TEXTURE_GEN=262144;this.G_TEXTURE_GEN_LINEAR=524288;this.G_LOD=1048576;this.TXT_FMT_RGBA=0;this.TXT_FMT_YUV=1;this.TXT_FMT_CI=2;this.TXT_FMT_IA=3;this.TXT_FMT_I=4;this.TXT_SIZE_4b=0;this.TXT_SIZE_8b=1;this.TXT_SIZE_16b=2;this.TXT_SIZE_32b=3;this.RDP_TXT_LOADTILE=7;this.RDP_TXT_WRAP=this.RDP_TXT_NOMIRROR=this.RDP_TXT_RENDERTILE=0;this.RDP_TXT_MIRROR=
1;this.RDP_TXT_CLAMP=2;this.RDP_TXT_NOLOD=this.RDP_TXT_NOMASK=0;this.RSP_GBI1_MV_MEM_VIEWPORT=128;this.RSP_GBI1_MV_MEM_LOOKATY=130;this.RSP_GBI1_MV_MEM_LOOKATX=132;this.RSP_GBI1_MV_MEM_L0=134;this.RSP_GBI1_MV_MEM_L1=136;this.RSP_GBI1_MV_MEM_L2=138;this.RSP_GBI1_MV_MEM_L3=140;this.RSP_GBI1_MV_MEM_L4=142;this.RSP_GBI1_MV_MEM_L5=144;this.RSP_GBI1_MV_MEM_L6=146;this.RSP_GBI1_MV_MEM_L7=148;this.RSP_GBI1_MV_MEM_TXTATT=150;this.RSP_GBI1_MV_MEM_MATRIX_1=158;this.RSP_GBI1_MV_MEM_MATRIX_2=152;this.RSP_GBI1_MV_MEM_MATRIX_3=
154;this.RSP_GBI1_MV_MEM_MATRIX_4=156;this.RSP_GBI2_MV_MEM__VIEWPORT=8;this.RSP_GBI2_MV_MEM__LIGHT=10;this.RSP_GBI2_MV_MEM__POINT=12;this.RSP_GBI2_MV_MEM__MATRIX=14;this.RSP_GBI2_MV_MEM_O_LOOKATX=0;this.RSP_GBI2_MV_MEM_O_LOOKATY=24;this.RSP_GBI2_MV_MEM_O_L0=48;this.RSP_GBI2_MV_MEM_O_L1=72;this.RSP_GBI2_MV_MEM_O_L2=96;this.RSP_GBI2_MV_MEM_O_L3=120;this.RSP_GBI2_MV_MEM_O_L4=144;this.RSP_GBI2_MV_MEM_O_L5=168;this.RSP_GBI2_MV_MEM_O_L6=192;this.RSP_GBI2_MV_MEM_O_L7=216;this.RSP_MOVE_WORD_MATRIX=0;this.RSP_MOVE_WORD_NUMLIGHT=
2;this.RSP_MOVE_WORD_CLIP=4;this.RSP_MOVE_WORD_SEGMENT=6;this.RSP_MOVE_WORD_FOG=8;this.RSP_MOVE_WORD_LIGHTCOL=10;this.RSP_MOVE_WORD_POINTS=12;this.RSP_MOVE_WORD_PERSPNORM=14;this.RSP_MV_WORD_OFFSET_NUMLIGHT=0;this.RSP_MV_WORD_OFFSET_CLIP_RNX=4;this.RSP_MV_WORD_OFFSET_CLIP_RNY=12;this.RSP_MV_WORD_OFFSET_CLIP_RPX=20;this.RSP_MV_WORD_OFFSET_CLIP_RPY=28;this.RSP_MV_WORD_OFFSET_FOG=0;this.RSP_MV_WORD_OFFSET_POINT_RGBA=16;this.RSP_MV_WORD_OFFSET_POINT_ST=20;this.RSP_MV_WORD_OFFSET_POINT_XYSCREEN=24;this.RSP_MV_WORD_OFFSET_POINT_ZSCREEN=
28;this.RSP_DLIST_PUSH=0;this.RSP_DLIST_NOPUSH=1}}();("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsConstants=a}).call(this);function _BigInt_toString(){return this.toStringBase(10)}
function _BigInt_toStringBase(a){var b,c,e,d,g;b=this.len;if(0==b||1==b&&!this.digits[0])return"0";switch(a){default:case 10:c=Math.floor(3856*b/800)+2;e=1E4;break;case 16:c=Math.floor(16*b/4)+2;e=65536;break;case 8:c=16*b+2;e=4096;break;case 2:c=16*b+2,e=16}d=this.clone().digits;for(s="";b&&c;){for(var f=b,h=0;f--;)h=(h<<16)+d[f],0>h&&(h+=4294967296),d[f]=Math.floor(h/e),h%=e;0==d[b-1]&&b--;for(f=4;f--&&!(g=h%a,s="0123456789abcdef".charAt(g)+s,--c,h=Math.floor(h/a),0==b&&0==h););}for(b=0;b<s.length&&
"0"==s.charAt(b);)b++;b&&(s=s.substring(b,s.length));this.sign||(s="-"+s);return s}function _BigInt_clone(){var a,b;a=new BigInt(this.len,this.sign);for(b=0;b<this.len;b++)a.digits[b]=this.digits[b];return a}
function BigInt(a,b){var c;this.toString=_BigInt_toString;this.toStringBase=_BigInt_toStringBase;this.clone=_BigInt_clone;0==BigInt.arguments.length?(this.sign=!0,this.len=a=1,this.digits=Array(1),c=!0):1==BigInt.arguments.length?(c=bigint_from_any(BigInt.arguments[0]),c==BigInt.arguments[0]&&(c=c.clone()),this.sign=c.sign,this.len=c.len,this.digits=c.digits,c=!1):(this.sign=b?!0:!1,this.len=a,this.digits=Array(a),c=!0);if(c)for(c=0;c<a;c++)this.digits[c]=0}
function bigint_norm(a){for(var b=a.len,c=a.digits;b--&&!c[b];);a.len=++b;return a}function bigint_from_int(a){var b;0>a&&(a=-a);a&=2147483647;65535>=a?(b=new BigInt(1,1),b.digits[0]=a):(b=new BigInt(2,1),b.digits[0]=a&65535,b.digits[1]=a>>16&65535);return b}
function bigint_from_string(a,b){var c,e=!0,d,g,f,h=1;a+="@";c=0;"+"==a.charAt(c)?c++:"-"==a.charAt(c)&&(c++,e=!1);if("@"==a.charAt(c))return null;b||("0"==a.charAt(c)?(d=a.charAt(c+1),b="x"==d||"X"==d?16:"b"==d||"B"==d?2:8):b=10);if(8==b){for(;"0"==a.charAt(c);)c++;d=3*(a.length-c)}else{if(16==b&&"0"==a.charAt(c)&&("x"==a.charAt(c+1)||"X"==a.charAt(c+1)))c+=2;if(2==b&&"0"==a.charAt(c)&&("b"==a.charAt(c+1)||"B"==a.charAt(c+1)))c+=2;for(;"0"==a.charAt(c);)c++;"@"==a.charAt(c)&&c--;d=4*(a.length-c)}e=
new BigInt((d>>4)+1,e);for(g=e.digits;;){d=a.charAt(c++);if("@"==d)break;switch(d){case "0":d=0;break;case "1":d=1;break;case "2":d=2;break;case "3":d=3;break;case "4":d=4;break;case "5":d=5;break;case "6":d=6;break;case "7":d=7;break;case "8":d=8;break;case "9":d=9;break;case "a":case "A":d=10;break;case "b":case "B":d=11;break;case "c":case "C":d=12;break;case "d":case "D":d=13;break;case "e":case "E":d=14;break;case "f":case "F":d=15;break;default:d=b}if(d>=b)break;for(f=0;;){for(;f<h;)d+=g[f]*
b,g[f++]=d&65535,d>>>=16;if(d)h++;else break}}return bigint_norm(e)}
function bigint_from_any(a){if("object"==typeof a)return a.constructor==BigInt?a:BigInt(1,1);if("string"==typeof a)return bigint_from_string(a);if("number"==typeof a){var b,c,e;if(-2147483647<=a&&2147483647>=a)return bigint_from_int(a);a+="";b=a.indexOf("e",0);if(-1==b)return bigint_from_string(a);c=a.substr(0,b);a=a.substr(b+2,a.length-(b+2));b=c.indexOf(".",0);-1!=b?(e=c.length-(b+1),c=c.substr(0,b)+c.substr(b+1,e),a=parseInt(a)-e):a=parseInt(a);for(;0<a--;)c+="0";return bigint_from_string(c)}return BigInt(1,
1)}function bigint_uminus(a){a=a.clone();a.sign=!a.sign;return bigint_norm(a)}function bigint_add_internal(a,b,c){var e,d,g;c=c==b.sign;if(a.sign!=c)return c?bigint_sub_internal(b,a):bigint_sub_internal(a,b);a.len>b.len?(g=a.len+1,e=a,a=b,b=e):g=b.len+1;e=new BigInt(g,c);g=a.len;for(c=d=0;d<g;d++)c+=a.digits[d]+b.digits[d],e.digits[d]=c&65535,c>>>=16;for(g=b.len;c&&d<g;)c+=b.digits[d],e.digits[d++]=c&65535,c>>>=16;for(;d<g;)e.digits[d]=b.digits[d],d++;e.digits[d]=c&65535;return bigint_norm(e)}
function bigint_sub_internal(a,b){var c=0,e,d,g;g=a.len;if(a.len<b.len)c=a,a=b,b=c;else if(a.len==b.len)for(;0<g;){g--;if(a.digits[g]>b.digits[g])break;if(a.digits[g]<b.digits[g]){c=a;a=b;b=c;break}}c=new BigInt(a.len,0==c?1:0);e=c.digits;for(d=g=0;g<b.len;g++)d+=a.digits[g]-b.digits[g],e[g]=d&65535,d>>>=16;for(;d&&g<a.len;)d+=a.digits[g],e[g++]=d&65535,d>>>=16;for(;g<a.len;)e[g]=a.digits[g],g++;return bigint_norm(c)}
function bigint_plus(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_add_internal(a,b,1)}function bigint_minus(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_add_internal(a,b,0)}
function bigint_mul(a,b){var c,e,d=0,g,f,h,k,m,l,n;a=bigint_from_any(a);b=bigint_from_any(b);e=a.len+b.len+1;g=new BigInt(e,a.sign==b.sign);h=a.digits;k=b.digits;f=g.digits;for(n=b.len;e--;)f[e]=0;for(c=0;c<a.len;c++)if(m=h[c],0!=m){for(e=d=0;e<n;e++)l=d+m*k[e],d=f[c+e]+l,l&&(f[c+e]=d&65535),d>>>=16;d&&(f[c+e]=d)}return bigint_norm(g)}
function bigint_divmod(a,b,c){var e=a.len,d=b.len,g,f,h,k,m,l,n,p,q,r;k=b.digits;if(0==d&&0==k[0])return null;if(e<d||e==d&&a.digits[e-1]<b.digits[d-1])return c?bigint_norm(a):BigInt(1,1);g=a.digits;if(1==d){p=k[0];h=a.clone();m=h.digits;l=0;for(g=e;g--;)l=65536*l+m[g],m[g]=l/p&65535,l%=p;h.sign=a.sign==b.sign;return c?(a.sign||(l=-l),a.sign!=b.sign&&(l+=k[0]*(b.sign?1:-1)),bigint_from_int(l)):bigint_norm(h)}h=new BigInt(e==d?e+2:e+1,a.sign==b.sign);m=h.digits;for(e==d&&(m[e+1]=0);!k[d-1];)d--;if(1!=
(p=65536/(k[d-1]+1)&65535)){f=b.clone();l=f.digits;for(n=f=0;f<d;)n+=k[f]*p,l[f++]=n&65535,n>>=16;k=l;for(n=f=0;f<e;)n+=g[f]*p,m[f++]=n&65535,n>>=16;m[f]=n&65535}else{m[e]=0;for(f=e;f--;)m[f]=g[f]}f=e==d?e+1:e;do{if(q=m[f]==k[d-1]?65535:(65536*m[f]+m[f-1])/k[d-1]&65535){l=n=g=0;do l+=k[g]*q,r=n-(l&65535),n=m[f-d+g]+r,r&&(m[f-d+g]=n&65535),n>>=16,l>>>=16;while(++g<d);for(n+=m[f-d+g]-l;n;){n=g=0;q--;do r=n+k[g],n=m[f-d+g]+r,r&&(m[f-d+g]=n&65535),n>>=16;while(++g<d);n--}}m[f]=q}while(--f>=d);if(c){e=
h.clone();if(p){m=e.digits;l=0;for(g=d;g--;)l=65536*l+m[g],m[g]=l/p&65535,l%=p}e.len=d;e.sign=a.sign;return a.sign!=b.sign?bigint_add_internal(e,b,1):bigint_norm(e)}a=h.clone();m=a.digits;f=(e==d?e+2:e+1)-d;for(g=0;g<f;g++)m[g]=m[g+d];a.len=g;return bigint_norm(a)}function bigint_div(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_divmod(a,b,0)}function bigint_mod(a,b){a=bigint_from_any(a);b=bigint_from_any(b);return bigint_divmod(a,b,1)}
function bigint_cmp(a,b){var c;if(a==b)return 0;a=bigint_from_any(a);b=bigint_from_any(b);c=a.len;if(a.sign!=b.sign)return a.sign?1:-1;if(c<b.len)return a.sign?-1:1;if(c>b.len)return a.sign?1:-1;for(;c--&&a.digits[c]==b.digits[c];);return-1==c?0:a.digits[c]>b.digits[c]?a.sign?1:-1:a.sign?-1:1}function bigint_number(a){for(var b=0,c=a.len,e=a.digits;c--;)b=e[c]+65536*b;a.sign||(b=-b);return b};var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&goog.isDef(b)?c[e]=b:c=c[e]?c[e]:c[e]={}};goog.getObjectByName=function(a,b){for(var c=a.split("."),e=b||goog.global,d;d=c.shift();)if(goog.isDefAndNotNull(e[d]))e=e[d];else return null;return e};
goog.globalize=function(a,b){var c=b||goog.global,e;for(e in a)c[e]=a[e]};goog.addDependency=function(a,b,c){if(!COMPILED){var e;a=a.replace(/\\/g,"/");for(var d=goog.dependencies_,g=0;e=b[g];g++)d.nameToPath[e]=a,a in d.pathToNames||(d.pathToNames[a]={}),d.pathToNames[a][e]=!0;for(e=0;b=c[e];e++)a in d.requires||(d.requires[a]={}),d.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a,b){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,e=c.lastIndexOf("?"),e=
-1==e?c.length:e;if("base.js"==c.substr(e-7,7)){goog.basePath=c.substr(0,e-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){return goog.inHtmlDocument_()?(goog.global.document.write('<script type="text/javascript" src="'+a+'">\x3c/script>'),!0):!1},goog.writeScripts_=function(){function a(g){if(!(g in e.written)){if(!(g in e.visited)&&(e.visited[g]=
!0,g in e.requires))for(var d in e.requires[g])if(!goog.isProvided_(d))if(d in e.nameToPath)a(e.nameToPath[d]);else throw Error("Undefined nameToPath for "+d);g in c||(c[g]=!0,b.push(g))}}var b=[],c={},e=goog.dependencies_,d;for(d in goog.included_)e.written[d]||a(d);for(d=0;d<b.length;d++)if(b[d])goog.importScript_(goog.basePath+b[d]);else throw Error("Undefined script input");},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),
goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,e);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(b){return goog.cssNameMapping_[b]||b},e=function(b){b=b.split("-");for(var a=[],e=0;e<b.length;e++)a.push(c(b[e]));return a.join("-")},e=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:e:function(b){return b};return b?a+"-"+e(b):e(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var c=b||{},e;for(e in c){var d=(""+c[e]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+e+"\\}","gi"),d)}return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var e=arguments.callee.caller;if(e.superClass_)return e.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var d=Array.prototype.slice.call(arguments,2),g=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===e)g=!0;else if(g)return f.prototype[b].apply(a,d);if(a[b]===e)return a.constructor.prototype[b].apply(a,d);throw Error("goog.base called from a method of one name to a method of a different name");};
goog.scope=function(a){a.call(goog.global)};(function(){var a,b,c,e;b=new C1964jsConstants;c=void 0;a=function(){function a(b){this.settings=b;this.request=void 0;this.debug=!1;this.writeToDom=!0;this.code=!0===this.writeToDom?window:{};this.vAddr=new Int32Array(1);this.cp0=new Int32Array(32);this.cp1Buffer=new ArrayBuffer(128);this.cp1_i=new Int32Array(this.cp1Buffer);this.cp1_f=new Float32Array(this.cp1Buffer);this.cp1_f64=new Float64Array(this.cp1Buffer);this.cp1Con=new Int32Array(32);this.LLbit=0;this.terminate=!1;this.NUM_CHANNELS=1;this.SAMPLE_RATE=
this.NUM_SAMPLES=4E4;this.interval=this.isBigEndian=this.isLittleEndian=0;this.m=-125E3;this.forceRepaint=!1;this.kk=this.doOnce=0;this.TV_SYSTEM_NTSC=1;this.currentHack=this.TV_SYSTEM_PAL=0;this.kfi=32E5;this.cnt=0;this.r=new Int32Array([0,0,3513981929,3513981929,7145,4099027429,2751471372,2751471368,112,0,64,2751463488,3509783491,3509783491,627128870,782254871,0,0,0,0,0,0,0,6,0,3611240851,0,0,0,2751471600,0,2751468884,0,0,0]);this.h=new Int32Array(35);this.memory=new C1964jsMemory(this);this.interrupts=
new C1964jsInterrupts(this,this.cp0);this.pif=new C1964jsPif(this.memory.pifUint8Array);this.dma=new C1964jsDMA(this.memory,this.interrupts,this.pif);this.webGL=new C1964jsWebGL(this,b.wireframe);this.log=function(a){return console.log(a)}}a.prototype.callBind=function(a,b){return function(){return a.call(b)}};a.prototype.init=function(a){var e,c;this.endianTest();this.helpers=new C1964jsHelpers(this,this.isLittleEndian);this.initTLB();cancelAnimFrame(this.request);this.currentHack=0;this.dma.startTime=
0;this.kfi=512;this.interval=this.doOnce=0;this.m=-125E3;this.flushDynaCache();this.showFB=!0;this.webGL.hide3D();this.memory.rom=a;this.memory.romUint8Array=a;this.docElement=document.getElementById("screen");this.errorElement=document.getElementById("error");this.c=document.getElementById("Canvas");this.ctx=this.c.getContext("2d");this.ImDat=this.ctx.createImageData(320,240);a=3;for(c=0;240>c;){for(e=0;320>e;)this.ImDat.data[a]=255,a+=4,e+=1;c+=1}this.stopCompiling=!1;this.byteSwap(this.memory.rom);
for(a=0;4096>a;)this.memory.spMemUint8Array[a]=this.memory.rom[a],a+=1;this.r[20]=this.getTVSystem(this.memory.romUint8Array[61]);this.r[22]=this.getCIC();this.cp0[b.STATUS]=1883242500;this.cp0[b.RANDOM]=31;this.cp0[b.CONFIG]=451683;this.cp0[b.PREVID]=2816;this.cp1Con[0]=1297;this.p=2751463488;this.memory.setInt32(this.memory.miUint8Array,b.MI_VERSION_REG,16843009);this.memory.setInt32(this.memory.riUint8Array,b.RI_CONFIG_REG,1);this.memory.setInt32(this.memory.viUint8Array,b.VI_INTR_REG,1023);this.memory.setInt32(this.memory.viUint8Array,
b.VI_V_SYNC_REG,209);this.memory.setInt32(this.memory.viUint8Array,b.VI_H_SYNC_REG,860231);for(a=0;35>a;)this.h[a]=this.r[a]>>31,a+=1;this.startEmulator()};a.prototype.byteSwap=function(a){var b,e;console.log("byte swapping...");b=this.memory.getUint32(a,0);switch(b>>>0){case 931151890:0!==a.byteLength%2&&alert("help: support odd byte lengths for this swap");for(b=0;b<a.byteLength;)e=a[b],a[b]=a[b+1],a[b+1]=e,b+=2;break;case 2151092800:break;default:this.log("Unhandled byte order: 0x"+dec2hex(b))}console.log("swap done")};
a.prototype.endianTest=function(){var a,b;a=new ArrayBuffer(2);b=new Uint8Array(a);a=new Uint16Array(a);b[0]=255;b[1]=17;4607===a[0]?(this.log("You are on a little-endian system"),this.isLittleEndian=1,this.isBigEndian=0):(this.log("You are on a big-endian system"),this.isLittleEndian=0,this.isBigEndian=1)};a.prototype.repaint=function(a,b,e){var c,d,l,n,p;d=e;c=0;if(this.showFB){n=b.data;for(p=-76800;0!==p;)e=this.memory.rdramUint8Array[d],l=this.memory.rdramUint8Array[d+1],n[c]=e&248,n[c+1]=(e<<
5|l>>>3)&248,n[c+2]=l<<2&248,e=this.memory.rdramUint8Array[d+2],l=this.memory.rdramUint8Array[d+3],n[c+4]=e&248,n[c+5]=(e<<5|l>>>3)&248,n[c+6]=l<<2&248,d+=4,c+=8,p+=2;a.putImageData(b,0,0)}};a.prototype.initTLB=function(){var a;this.tlb=Array(32);for(a=0;32>a;)this.tlb[a]={valid:!1,entryHi:new Int32Array(1),entryLo1:new Int32Array(1),entryLo0:new Int32Array(1),pageMask:new Int32Array(1),loCompare:new Int32Array(1),myHiMask:new Int32Array(1)},a+=1;this.memory.initPhysRegions()};a.prototype.runLoop=
function(){var a=this;this.mySetInterval=setInterval(function(){var e,c,d;!0===a.terminate&&clearInterval(mySetInterval);a.interrupts.checkInterrupts();for(d=[];;)if(0<=a.m)if(a.interval+=1,a.m=-62500,4===a.interval){a.interval=0;a.repaintWrapper();a.cp0[b.COUNT]+=625E3;a.interrupts.triggerCompareInterrupt(0,!1);a.interrupts.triggerVIInterrupt(0,!1);a.interrupts.processException(a.p);break}else d.push(void 0);else{a.interrupts.processException(a.p);c=a.p>>>2;c="_"+c;try{e=a.code[c],d.push(a.run(e,
a.r,a.h))}catch(m){e=a.decompileBlock(a.p),d.push(e=e(a.r,a.h,a.memory,a))}}return d},8);return this};a.prototype.run=function(a,b,e){for(;0>this.m;)a=a(b,e,this.memory,this)};a.prototype.repaintWrapper=function(){this.repaint(this.ctx,this.ImDat,this.memory.getInt32(this.memory.viUint8Array,b.VI_ORIGIN_REG)&16777215)};a.prototype.startEmulator=function(){this.terminate=!1;this.log("startEmulator");this.runLoop()};a.prototype.stopEmulatorAndCleanup=function(){this.terminate=this.stopCompiling=!0;
this.log("stopEmulatorAndCleanup");this.flushDynaCache()};a.prototype.getFnName=function(a){return"_"+(a>>>2)};a.prototype.decompileBlock=function(a){var b,e,d;this.cnt=c=0;b="_"+(a>>>2);for(d=!0===this.writeToDom?"function "+b+"(r, h, m, t){":"i1964js.code."+b+"=function(r, h, m, t){";!this.stopCompiling;)if(e=this.memory.lw(a+c),d+=this[this.CPU_instruction[e>>26&63]](e),this.cnt+=1,c+=4,1E4<c)throw Error("too many instructions! bailing.");this.stopCompiling=!1;d+="t.m+="+this.cnt+";";d+="t.p="+
(a+c>>0);d+=";return t.code."+this.getFnName(a+c>>0)+"}";!0===this.writeToDom?(a=document.createElement("script"),e=document.getElementsByTagName("script")[this.kk],this.kk+=1,e.parentNode.insertBefore(a,e),a.text=d):wrapEval(d);return this.code[b]};a.prototype.wrapEval=function(a){return eval(a)};a.prototype.r4300i_add=function(a){return this.helpers.sLogic(a,"+")};a.prototype.r4300i_addu=function(a){return this.helpers.sLogic(a,"+")};a.prototype.r4300i_sub=function(a){return this.helpers.sLogic(a,
"-")};a.prototype.r4300i_subu=function(a){return this.helpers.sLogic(a,"-")};a.prototype.r4300i_or=function(a){return this.helpers.dLogic(a,"|")};a.prototype.r4300i_xor=function(a){return this.helpers.dLogic(a,"^")};a.prototype.r4300i_nor=function(a){return"{"+this.helpers.tRD(a)+"=~("+this.helpers.RS(a)+"|"+this.helpers.RT(a)+");"+this.helpers.tRDH(a)+"=~("+this.helpers.RSH(a)+"|"+this.helpers.RTH(a)+")}"};a.prototype.r4300i_and=function(a){return this.helpers.dLogic(a,"&")};a.prototype.r4300i_lui=
function(a){var b;b=(a&65535)<<16;return"{"+this.helpers.tRT(a)+"="+b+";"+this.helpers.tRTH(a)+"="+(b>>31)+"}"};a.prototype.r4300i_lw=function(a){return"{"+this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=m.lw(vAddr);"+this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_lwu=function(a){return"{"+this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=m.lw(vAddr);"+this.helpers.tRTH(a)+"=0}"};a.prototype.r4300i_sw=function(a,b){var e,d;d="{"+this.helpers.setVAddr(a)+"m.sw("+this.helpers.RT(a)+
",vAddr";!0===b?(e=this.p+c+4|0,d+=", "+e+", true)}"):(e=this.p+c|0,d+=", "+e+")}");return d};a.prototype.delaySlot=function(a,b){var e,d;d=this.p+c+4+(this.helpers.soffset_imm(a)<<2)|0;e=this.memory.lw(this.p+c+4|0);e=this[this.CPU_instruction[e>>26&63]](e,!0);d=e+"t.m+="+(this.cnt+1)+";t.p="+d+";return t.code."+this.getFnName(d)+"}";!1===b&&(d+=e+"t.m++;");c+=4;return d};a.prototype.r4300i_bne=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RS(a)+"!=="+this.helpers.RT(a)+")||("+this.helpers.RSH(a)+
"!=="+this.helpers.RTH(a)+")){"+this.delaySlot(a,!1)};a.prototype.r4300i_beq=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RS(a)+"==="+this.helpers.RT(a)+")&&("+this.helpers.RSH(a)+"==="+this.helpers.RTH(a)+")){"+this.delaySlot(a,!1)};a.prototype.r4300i_bnel=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RS(a)+"!=="+this.helpers.RT(a)+")||("+this.helpers.RSH(a)+"!=="+this.helpers.RTH(a)+")){"+this.delaySlot(a,!0)};a.prototype.r4300i_blez=function(a){this.stopCompiling=
!0;return"if (("+this.helpers.RSH(a)+"<0)||(("+this.helpers.RSH(a)+"===0)&&("+this.helpers.RS(a)+"===0))){"+this.delaySlot(a,!1)};a.prototype.r4300i_blezl=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RSH(a)+"<0)||(("+this.helpers.RSH(a)+"===0)&&("+this.helpers.RS(a)+"===0))){"+this.delaySlot(a,!0)};a.prototype.r4300i_bgez=function(a){this.stopCompiling=!0;return"if ("+this.helpers.RSH(a)+">=0){"+this.delaySlot(a,!1)};a.prototype.r4300i_bgezl=function(a){this.stopCompiling=!0;return"if ("+
this.helpers.RSH(a)+">=0){"+this.delaySlot(a,!0)};a.prototype.r4300i_bgtzl=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RSH(a)+">0)||(("+this.helpers.RSH(a)+"===0)&&("+this.helpers.RS(a)+"!==0))){"+this.delaySlot(a,!0)};a.prototype.r4300i_bltzl=function(a){this.stopCompiling=!0;return"if ("+this.helpers.RSH(a)+"<0){"+this.delaySlot(a,!0)};a.prototype.r4300i_bgezal=function(a){var b;this.stopCompiling=!0;b=this.p+c+8>>0;return"if ("+this.helpers.RSH(a)+">=0){r[31]="+b+";h[31]="+(b>>
31)+";"+this.delaySlot(a,!1)};a.prototype.r4300i_bgezall=function(a){var b;this.stopCompiling=!0;b=this.p+c+8>>0;return"if ("+this.helpers.RSH(a)+">=0){r[31]="+b+";h[31]="+(b>>31)+";"+this.delaySlot(a,!0)};a.prototype.r4300i_bltz=function(a){this.stopCompiling=!0;return"if ("+this.helpers.RSH(a)+"<0){"+this.delaySlot(a,!1)};a.prototype.r4300i_bgtz=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RSH(a)+">0)||(("+this.helpers.RSH(a)+"===0)&&("+this.helpers.RS(a)+"!==0))){"+this.delaySlot(a,
!1)};a.prototype.r4300i_beql=function(a){this.stopCompiling=!0;return"if (("+this.helpers.RS(a)+"==="+this.helpers.RT(a)+")&&("+this.helpers.RSH(a)+"==="+this.helpers.RTH(a)+")){"+this.delaySlot(a,!0)};a.prototype.r4300i_COP1_bc1f=function(a){this.stopCompiling=!0;return"if((t.cp1Con[31]&0x00800000)===0){"+this.delaySlot(a,!1)};a.prototype.r4300i_COP1_bc1t=function(a){this.stopCompiling=!0;return"if((t.cp1Con[31]&0x00800000)!==0){"+this.delaySlot(a,!1)};a.prototype.r4300i_COP1_bc1tl=function(a){this.stopCompiling=
!0;return"if((t.cp1Con[31]&0x00800000)!==0){"+this.delaySlot(a,!0)};a.prototype.r4300i_COP1_bc1fl=function(a){this.stopCompiling=!0;return"if((t.cp1Con[31]&0x00800000)===0){"+this.delaySlot(a,!0)};a.prototype.r4300i_j=function(a){var b,e;this.stopCompiling=!0;e="{";a=this.p+c+4&4026531840|(a&67108863)<<2|0;b=this.memory.lw(this.p+c+4|0);e=a>>0===this.p+c>>0&&0===b?e+"t.m=0;":e+"t.m+=1;";e+=this[this.CPU_instruction[b>>26&63]](b,!0);return e+("t.p="+a+";return t.code."+this.getFnName(a)+"}")};a.prototype.r4300i_jal=
function(a){var b,e;this.stopCompiling=!0;e="{";a=this.p+c+4&4026531840|(a&67108863)<<2|0;b=this.memory.lw(this.p+c+4|0);e+=this[this.CPU_instruction[b>>26&63]](b,!0);b=this.p+c+8|0;return e+"t.m+=1;"+("t.p="+a+";r[31]="+b+";h[31]="+(b>>31)+";return t.code."+this.getFnName(a)+"}")};a.prototype.r4300i_jalr=function(a){var b,e;this.stopCompiling=!0;e="{var temp="+this.helpers.RS(a)+";";b=this.p+c+8>>0;e+=this.helpers.tRD(a)+"="+b+";"+this.helpers.tRDH(a)+"="+(b>>31)+";";a=this.memory.lw(this.p+c+4|
0);a=this[this.CPU_instruction[a>>26&63]](a,!0);e=e+a+"t.m+=1;";return e+="t.p=temp;return t.code[t.getFnName(temp)]}"};a.prototype.r4300i_jr=function(a){var b;this.stopCompiling=!0;a="{var temp="+this.helpers.RS(a)+";";b=this.memory.lw(this.p+c+4|0);b=this[this.CPU_instruction[b>>26&63]](b,!0);a=a+b+"t.m+=1;";return a+"t.p=temp;return t.code[t.getFnName(temp)]}"};a.prototype.UNUSED=function(a){this.log("warning: UNUSED");return""};a.prototype.r4300i_COP0_eret=function(a){this.stopCompiling=!0;a=
"{if((t.cp0["+b.STATUS+"]&"+b.ERL+')!==0){alert("error epc");t.p=t.cp0['+b.ERROREPC+"];";a+="t.cp0["+b.STATUS+"]&=~"+b.ERL+"}else{t.p=t.cp0["+b.EPC+"];t.cp0["+b.STATUS+"]&=~"+b.EXL+"}";return a+"t.LLbit=0;return t.code[t.getFnName(t.p)]}"};a.prototype.r4300i_COP0_mtc0=function(a,b){var e,d;!0===b?(d=this.p+c+4|0,e="true"):(d=this.p+c|0,e="false");return"t.helpers.inter_mtc0(r,"+this.helpers.fs(a)+","+this.helpers.rt(a)+","+e+","+d+",t.cp0,t.interrupts);"};a.prototype.r4300i_sll=function(a){return 0===
(a&2097151)?"":"{"+this.helpers.tRD(a)+"="+this.helpers.RT(a)+"<<"+this.helpers.sa(a)+";"+this.helpers.tRDH(a)+"="+this.helpers.RD(a)+">>31}"};a.prototype.r4300i_srl=function(a){return"{"+this.helpers.tRD(a)+"="+this.helpers.RT(a)+">>>"+this.helpers.sa(a)+";"+this.helpers.tRDH(a)+"="+this.helpers.RD(a)+">>31}"};a.prototype.r4300i_ori=function(a){return"{"+this.helpers.tRT(a)+"="+this.helpers.RS(a)+"|"+this.helpers.offset_imm(a)+";"+this.helpers.tRTH(a)+"="+this.helpers.RSH(a)+"}"};a.prototype.r4300i_xori=
function(a){return"{"+this.helpers.tRT(a)+"="+this.helpers.RS(a)+"^"+this.helpers.offset_imm(a)+";"+this.helpers.tRTH(a)+"="+this.helpers.RSH(a)+"^0}"};a.prototype.r4300i_andi=function(a){return"{"+this.helpers.tRT(a)+"="+this.helpers.RS(a)+"&"+this.helpers.offset_imm(a)+";"+this.helpers.tRTH(a)+"=0}"};a.prototype.r4300i_addi=function(a){return"{"+this.helpers.tRT(a)+"="+this.helpers.RS(a)+"+"+this.helpers.soffset_imm(a)+";"+this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_addiu=
function(a){return"{"+this.helpers.tRT(a)+"="+this.helpers.RS(a)+"+"+this.helpers.soffset_imm(a)+";"+this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_slt=function(a){return"{if("+this.helpers.RSH(a)+">"+this.helpers.RTH(a)+")"+this.helpers.tRD(a)+"=0;else if("+this.helpers.RSH(a)+"<"+this.helpers.RTH(a)+")"+this.helpers.tRD(a)+"=1;else if("+this.helpers.uRS(a)+"<"+this.helpers.uRT(a)+")"+this.helpers.tRD(a)+"=1;else "+this.helpers.tRD(a)+"=0;"+this.helpers.tRDH(a)+"=0}"};a.prototype.r4300i_sltu=
function(a){return"{if("+this.helpers.uRSH(a)+">"+this.helpers.uRTH(a)+")"+this.helpers.tRD(a)+"=0;else if("+this.helpers.uRSH(a)+"<"+this.helpers.uRTH(a)+")"+this.helpers.tRD(a)+"=1;else if("+this.helpers.uRS(a)+"<"+this.helpers.uRT(a)+")"+this.helpers.tRD(a)+"=1;else "+this.helpers.tRD(a)+"=0;"+this.helpers.tRDH(a)+"=0}"};a.prototype.r4300i_slti=function(a){var b,e;b=this.helpers.soffset_imm(a)>>31;e=this.helpers.soffset_imm(a)>>>0;return"{if("+this.helpers.RSH(a)+">"+b+")"+this.helpers.tRT(a)+
"=0;else if("+this.helpers.RSH(a)+"<"+b+")"+this.helpers.tRT(a)+"=1;else if("+this.helpers.uRS(a)+"<"+e+")"+this.helpers.tRT(a)+"=1;else "+this.helpers.tRT(a)+"=0;"+this.helpers.tRTH(a)+"=0}"};a.prototype.r4300i_sltiu=function(a){var b,e;b=this.helpers.soffset_imm(a)>>31>>>0;e=this.helpers.soffset_imm(a)>>>0;return"{if("+this.helpers.uRSH(a)+">"+b+")"+this.helpers.tRT(a)+"=0;else if("+this.helpers.uRSH(a)+"<"+b+")"+this.helpers.tRT(a)+"=1;else if("+this.helpers.uRS(a)+"<"+e+")"+this.helpers.tRT(a)+
"=1;else "+this.helpers.tRT(a)+"=0;"+this.helpers.tRTH(a)+"=0}"};a.prototype.r4300i_cache=function(a){this.log("todo: r4300i_cache");this.stopCompiling=!0;return""};a.prototype.r4300i_multu=function(a){return"t.helpers.inter_multu(r,h,"+a+");"};a.prototype.r4300i_mult=function(a){return"t.helpers.inter_mult(r,h,"+a+");"};a.prototype.r4300i_mflo=function(a){return"{"+this.helpers.tRD(a)+"=r[32];"+this.helpers.tRDH(a)+"=h[32]}"};a.prototype.r4300i_mfhi=function(a){return"{"+this.helpers.tRD(a)+"=r[33];"+
this.helpers.tRDH(a)+"=h[33]}"};a.prototype.r4300i_mtlo=function(a){return"{r[32]="+this.helpers.RS(a)+";h[32]="+this.helpers.RSH(a)+"}"};a.prototype.r4300i_mthi=function(a){return"{r[33]="+this.helpers.RS(a)+";h[33]="+this.helpers.RSH(a)+"}"};a.prototype.r4300i_COP0_mfc0=function(a){switch(this.helpers.fs(a)){case b.RANDOM:alert("RANDOM")}return"{"+(this.helpers.tRT(a)+"=t.cp0["+this.helpers.fs(a)+"];"+this.helpers.tRTH(a)+"=t.cp0["+this.helpers.fs(a)+"]>>31}")};a.prototype.r4300i_lb=function(a){return"{"+
this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=(m.lb(vAddr)<<24)>>24;"+this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_lbu=function(a){return"{"+this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=(m.lb(vAddr))&0x000000ff;"+this.helpers.tRTH(a)+"=0}"};a.prototype.r4300i_lh=function(a){return"{"+this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=(m.lh(vAddr)<<16)>>16;"+this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_lhu=function(a){return"{"+this.helpers.setVAddr(a)+
this.helpers.tRT(a)+"=(m.lh(vAddr))&0x0000ffff;"+this.helpers.tRTH(a)+"=0}"};a.prototype.r4300i_sb=function(a){return"{"+this.helpers.setVAddr(a)+"m.sb("+this.helpers.RT(a)+",vAddr)}"};a.prototype.r4300i_sh=function(a){return"{"+this.helpers.setVAddr(a)+"m.sh("+this.helpers.RT(a)+",vAddr)}"};a.prototype.r4300i_srlv=function(a){return"{"+this.helpers.tRD(a)+"="+this.helpers.RT(a)+">>>("+this.helpers.RS(a)+"&0x1f);"+this.helpers.tRDH(a)+"="+this.helpers.RD(a)+">>31}"};a.prototype.r4300i_sllv=function(a){return"{"+
this.helpers.tRD(a)+"="+this.helpers.RT(a)+"<<("+this.helpers.RS(a)+"&0x1f);"+this.helpers.tRDH(a)+"="+this.helpers.RD(a)+">>31}"};a.prototype.r4300i_srav=function(a){return"{"+this.helpers.tRD(a)+"="+this.helpers.RT(a)+">>("+this.helpers.RS(a)+"&0x1f);"+this.helpers.tRDH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_COP1_cfc1=function(a){if(0===this.helpers.fs(a)||31===this.helpers.fs(a))return"{"+this.helpers.tRT(a)+"=t.cp1Con["+this.helpers.fs(a)+"];"+this.helpers.tRTH(a)+"=t.cp1Con["+
this.helpers.fs(a)+"]>>31}"};a.prototype.r4300i_COP1_ctc1=function(a){if(31===this.helpers.fs(a))return"t.cp1Con[31]="+this.helpers.RT(a)+";"};a.prototype.r4300i_ld=function(a){return"{"+this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=m.lw((vAddr+4)|0);"+this.helpers.tRTH(a)+"=m.lw(vAddr)}"};a.prototype.r4300i_lld=function(a){return"{"+this.helpers.setVAddr(a)+this.helpers.tRT(a)+"=m.lw((vAddr+4)|0);"+this.helpers.tRTH(a)+"=m.lw(vAddr);t.LLbit=1}"};a.prototype.r4300i_sd=function(a,b){var e,d;d="{"+
this.helpers.setVAddr(a)+"m.sw("+this.helpers.RT(a)+",(vAddr+4)|0";!0===b?(e=this.p+c+4|0,d+=", "+e+", true);"):(e=this.p+c|0,d+=", "+e+");");d+="m.sw("+this.helpers.RTH(a)+",vAddr";!0===b?(e=this.p+c+4|0,d+=", "+e+", true)}"):(e=this.p+c|0,d+=", "+e+")}");return d};a.prototype.r4300i_dmultu=function(a){return"t.helpers.inter_dmultu(r,h,"+a+");"};a.prototype.r4300i_dsll32=function(a){return"{"+this.helpers.tRDH(a)+"="+this.helpers.RT(a)+"<<"+this.helpers.sa(a)+";"+this.helpers.tRD(a)+"=0}"};a.prototype.r4300i_dsra32=
function(a){return"{"+this.helpers.tRD(a)+"="+this.helpers.RTH(a)+">>"+this.helpers.sa(a)+";"+this.helpers.tRDH(a)+"="+this.helpers.RTH(a)+">>31}"};a.prototype.r4300i_ddivu=function(a){return"t.helpers.inter_ddivu(r,h,"+a+");"};a.prototype.r4300i_ddiv=function(a){return"t.helpers.inter_ddiv(r,h,"+a+");"};a.prototype.r4300i_dadd=function(a){this.log("todo: dadd");return""};a.prototype.r4300i_break=function(a){this.log("todo: break");return""};a.prototype.r4300i_div=function(a){return"t.helpers.inter_div(r,h,"+
a+");"};a.prototype.r4300i_divu=function(a){return"t.helpers.inter_divu(r,h,"+a+");"};a.prototype.r4300i_sra=function(a){return"{"+this.helpers.tRD(a)+"="+this.helpers.RT(a)+">>"+this.helpers.sa(a)+";"+this.helpers.tRDH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_COP0_tlbwi=function(a){return"t.helpers.inter_tlbwi(t.cp0["+b.INDEX+"], t.tlb, t.cp0);"};a.prototype.r4300i_COP0_tlbp=function(a){return"t.helpers.inter_tlbp(t.tlb, t.cp0);"};a.prototype.r4300i_COP0_tlbr=function(a){return"t.helpers.inter_tlbr(t.tlb, t.cp0);"};
a.prototype.r4300i_lwl=function(a){var b;b="{"+this.helpers.setVAddr(a);b=b+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 0:"+this.helpers.tRT(a)+"=value;break;");b+="case 1:"+this.helpers.tRT(a)+"=("+this.helpers.RT(a)+"&0x000000ff)|((value<<8)>>>0);break;";b+="case 2:"+this.helpers.tRT(a)+"=("+this.helpers.RT(a)+"&0x0000ffff)|((value<<16)>>>0);break;";b+="case 3:"+this.helpers.tRT(a)+"=("+this.helpers.RT(a)+"&0x00ffffff)|((value<<24)>>>0);break;}";
return b+(this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}")};a.prototype.r4300i_lwr=function(a){var b;b="{"+this.helpers.setVAddr(a);b=b+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 3:"+this.helpers.tRT(a)+"=value;break;");b+="case 2:"+this.helpers.tRT(a)+"=("+this.helpers.RT(a)+"&0xff000000)|(value>>>8);break;";b+="case 1:"+this.helpers.tRT(a)+"=("+this.helpers.RT(a)+"&0xffff0000)|(value>>>16);break;";b+="case 0:"+this.helpers.tRT(a)+"=("+this.helpers.RT(a)+
"&0xffffff00)|(value>>>24);break;}";return b+(this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}")};a.prototype.r4300i_swl=function(a){var b;b="{"+this.helpers.setVAddr(a);b=b+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 0:value="+this.helpers.RT(a)+";break;");b+="case 1:value=((value&0xff000000)|("+this.helpers.RT(a)+">>>8));break;";b+="case 2:value=((value&0xffff0000)|("+this.helpers.RT(a)+">>>16));break;";b+="case 3:value=((value&0xffffff00)|("+this.helpers.RT(a)+
">>>24));break;}";return b+"m.sw(value,vAddrAligned,false)}"};a.prototype.r4300i_swr=function(a){var b;b="{"+this.helpers.setVAddr(a);b=b+"var vAddrAligned=(vAddr&0xfffffffc)|0;var value=m.lw(vAddrAligned);"+("switch(vAddr&3){case 3:value="+this.helpers.RT(a)+";break;");b+="case 2:value=((value & 0x000000FF)|(("+this.helpers.RT(a)+"<<8)>>>0));break;";b+="case 1:value=((value & 0x0000FFFF)|(("+this.helpers.RT(a)+"<<16)>>>0));break;";b+="case 0:value=((value & 0x00FFFFFF)|(("+this.helpers.RT(a)+"<<24)>>>0));break;}";
return b+"m.sw(value,vAddrAligned,false)}"};a.prototype.r4300i_lwc1=function(a){return"{"+this.helpers.setVAddr(a)+"t.cp1_i["+this.helpers.FT32ArrayView(a)+"]=m.lw(vAddr)}"};a.prototype.r4300i_ldc1=function(a){return"{"+this.helpers.setVAddr(a)+"t.cp1_i["+this.helpers.FT32ArrayView(a)+"]=m.lw((vAddr+4)|0);"+("t.cp1_i["+this.helpers.FT32HIArrayView(a)+"]=m.lw((vAddr)|0)}")};a.prototype.r4300i_swc1=function(a,b){var e,d;d="{"+this.helpers.setVAddr(a)+"m.sw(t.cp1_i["+this.helpers.FT32ArrayView(a)+"],vAddr";
!0===b?(e=this.p+c+4|0,d+=", "+e+", true)}"):(e=this.p+c|0,d+=", "+e+")}");return d};a.prototype.r4300i_sdc1=function(a,b){var e,d;d="{"+this.helpers.setVAddr(a)+"m.sw(t.cp1_i["+this.helpers.FT32ArrayView(a)+"],(vAddr+4)|0";!0===b?(e=this.p+c+4|0,d+=", "+e+", true);"):(e=this.p+c|0,d+=", "+e+");");d+="m.sw(t.cp1_i["+this.helpers.FT32HIArrayView(a)+"],(vAddr)|0";!0===b?(e=this.p+c+4|0,d+=", "+e+", true)}"):(e=this.p+c|0,d+=", "+e+")}");return d};a.prototype.r4300i_COP1_mtc1=function(a){return"t.cp1_i["+
this.helpers.FS32ArrayView(a)+"]="+this.helpers.RT(a)+";"};a.prototype.r4300i_COP1_mfc1=function(a){return"{"+this.helpers.tRT(a)+"=t.cp1_i["+this.helpers.FS32ArrayView(a)+"];"+this.helpers.tRTH(a)+"="+this.helpers.RT(a)+">>31}"};a.prototype.r4300i_COP1_cvts_w=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=t.cp1_i["+this.helpers.FS32ArrayView(a)+"];"};a.prototype.r4300i_COP1_cvtw_s=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+
"];"};a.prototype.r4300i_COP1_div_s=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+"]/t.cp1_f["+this.helpers.FT32ArrayView(a)+"];"};a.prototype.r4300i_COP1_div_d=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"]/t.cp1_f64["+this.helpers.FT64ArrayView(a)+"];"};a.prototype.r4300i_COP1_mul_s=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+
"]*t.cp1_f["+this.helpers.FT32ArrayView(a)+"];"};a.prototype.r4300i_COP1_mul_d=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"]*t.cp1_f64["+this.helpers.FT64ArrayView(a)+"];"};a.prototype.r4300i_COP1_mov_s=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+"]=t.cp1_i["+this.helpers.FS32ArrayView(a)+"];"};a.prototype.r4300i_COP1_mov_d=function(a){return"t.cp1_f64["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS32ArrayView(a)+
"];"};a.prototype.r4300i_COP1_add_s=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+"]+t.cp1_f["+this.helpers.FT32ArrayView(a)+"];"};a.prototype.r4300i_COP1_sub_s=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+"]-t.cp1_f["+this.helpers.FT32ArrayView(a)+"];"};a.prototype.r4300i_COP1_cvtd_s=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+
"];"};a.prototype.r4300i_COP1_cvtd_w=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+"]=t.cp1_i["+this.helpers.FS32ArrayView(a)+"];"};a.prototype.r4300i_COP1_cvts_d=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"];"};a.prototype.r4300i_COP1_cvtw_d=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"];"};a.prototype.r4300i_COP1_add_d=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+
"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"]+t.cp1_f64["+this.helpers.FT64ArrayView(a)+"];"};a.prototype.r4300i_COP1_sub_d=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"]-t.cp1_f64["+this.helpers.FT64ArrayView(a)+"];"};a.prototype.r4300i_COP1_truncw_d=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+"]=t.cp1_f64["+this.helpers.FS64ArrayView(a)+"];"};a.prototype.r4300i_COP1_truncw_s=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+
"]=t.cp1_f["+this.helpers.FS32ArrayView(a)+"];"};a.prototype.r4300i_COP1_neg_s=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+"]=t.cp1_i["+this.helpers.FS32ArrayView(a)+"]^0x80000000;"};a.prototype.r4300i_COP1_neg_d=function(a){return"t.cp1_i["+this.helpers.FD32HIArrayView(a)+"]=t.cp1_i["+this.helpers.FS32HIArrayView(a)+"]^0x80000000;"};a.prototype.r4300i_COP1_abs_s=function(a){return"t.cp1_i["+this.helpers.FD32ArrayView(a)+"]=t.cp1_i["+this.helpers.FS32ArrayView(a)+"]&0x7fffffff;"};a.prototype.r4300i_COP1_abs_d=
function(a){return"t.cp1_i["+this.helpers.FD32HIArrayView(a)+"]=t.cp1_i["+this.helpers.FS32HIArrayView(a)+"]&0x7fffffff;"};a.prototype.r4300i_COP1_sqrt_s=function(a){return"t.cp1_f["+this.helpers.FD32ArrayView(a)+"]=Math.sqrt(t.cp1_f["+this.helpers.FS32ArrayView(a)+"]);"};a.prototype.r4300i_COP1_sqrt_d=function(a){return"t.cp1_f64["+this.helpers.FD64ArrayView(a)+"]=Math.sqrt(t.cp1_f64["+this.helpers.FS64ArrayView(a)+"]);"};a.prototype.r4300i_sync=function(a){this.log("todo: sync");return""};a.prototype.r4300i_sdr=
function(a){this.log("todo: sdr");return""};a.prototype.r4300i_ldr=function(a){this.log("todo: ldr");return""};a.prototype.r4300i_sdl=function(a){this.log("todo: sdl");return""};a.prototype.r4300i_ldl=function(a){this.log("todo: ldl");return""};a.prototype.r4300i_sc=function(a){this.log("todo: sc");return""};a.prototype.r4300i_scd=function(a){this.log("todo: scd");return""};a.prototype.r4300i_daddi=function(a){return"t.helpers.inter_daddi(r,h,"+a+");"};a.prototype.r4300i_teq=function(a){this.log("todo: r4300i_teq");
return""};a.prototype.r4300i_tgeu=function(a){this.log("todo: r4300i_tgeu");return""};a.prototype.r4300i_tlt=function(a){this.log("todo: r4300i_tlt");return""};a.prototype.r4300i_tltu=function(a){this.log("todo: r4300i_tltu");return""};a.prototype.r4300i_tne=function(a){this.log("todo: r4300i_tne");return""};a.prototype.r4300i_daddiu=function(a){return"t.helpers.inter_daddiu(r,h,"+a+");"};a.prototype.r4300i_daddu=function(a){return"t.helpers.inter_daddu(r,h,"+a+");"};a.prototype.r4300i_C_F_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_UN_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_EQ_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_UEQ_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_OLT_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_ULT_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_OLE_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_ULE_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_SF_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGLE_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_SEQ_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGL_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_LT_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGE_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_LE_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_NGT_S=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_s("+
a+",t.cp1Con,t.cp1_f);"};a.prototype.r4300i_C_F_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_UN_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_EQ_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_UEQ_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_OLT_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+
a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_ULT_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_OLE_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_ULE_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_SF_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGLE_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+
a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_SEQ_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGL_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_LT_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGE_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_LE_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+
a+",t.cp1Con,t.cp1_f64);"};a.prototype.r4300i_C_NGT_D=function(a){return"t.helpers.inter_r4300i_C_cond_fmt_d("+a+",t.cp1Con,t.cp1_f64);"};return a}();e="undefined"!==typeof exports&&null!==exports?exports:this;e.C1964jsEmulator=a;e.consts=b}).call(this);(function(){var a;a="undefined"!==typeof exports&&null!==exports?exports:this;a.C1964jsHelpers=function(a,c){this.core=a;this.isLittleEndian=c;this.isBigEndian=!1===c;this.fs=function(a){return a>>11&31};this.ft=function(a){return a>>16&31};this.FS32ArrayView=function(a){return a>>11&31^this.isBigEndian};this.FS32HIArrayView=function(a){return a>>11&31^this.isLittleEndian};this.FT32ArrayView=function(a){return a>>16&31^this.isBigEndian};this.FT32HIArrayView=function(a){return a>>16&31^this.isLittleEndian};
this.FD32ArrayView=function(a){return a>>6&31^this.isBigEndian};this.FD32HIArrayView=function(a){return a>>6&31^this.isLittleEndian};this.FS64ArrayView=function(a){return(a>>11&31)>>1};this.FT64ArrayView=function(a){return(a>>16&31)>>1};this.FD64ArrayView=function(a){return(a>>6&31)>>1};this.rd=function(a){return a>>11&31};this.rs=function(a){return a>>21&31};this.RS=function(a){a=a>>21&31;return 0===a?"0":"r["+a+"]"};this.RSH=function(a){a=a>>21&31;return 0===a?"0":"h["+a+"]"};this.uRS=function(a){a=
a>>21&31;return 0===a?"0":"(r["+a+"]>>>0)"};this.uRSH=function(a){a=a>>21&31;return 0===a?"0":"(h["+a+"]>>>0)"};this.tRS=function(a){a=a>>21&31;return 0===a?"r[34]":"r["+a+"]"};this.tRSH=function(a){a=a>>21&31;return 0===a?"h[34]":"h["+a+"]"};this.tRD=function(a){a=a>>11&31;return 0===a?"r[34]":"r["+a+"]"};this.tRDH=function(a){a=a>>11&31;return 0===a?"h[34]":"h["+a+"]"};this.tRT=function(a){a=a>>16&31;return 0===a?"r[34]":"r["+a+"]"};this.tRTH=function(a){a=a>>16&31;return 0===a?"h[34]":"h["+a+"]"};
this.RD=function(a){a=a>>11&31;return 0===a?"0":"r["+a+"]"};this.RDH=function(a){a=a>>11&31;return 0===a?"0":"h["+a+"]"};this.uRD=function(a){a=a>>11&31;return 0===a?"0":"(r["+a+"]>>>0)"};this.uRDH=function(a){a=a>>11&31;return 0===a?"0":"(h["+a+"]>>>0)"};this.RT=function(a){a=a>>16&31;return 0===a?"0":"r["+a+"]"};this.RTH=function(a){a=a>>16&31;return 0===a?"0":"h["+a+"]"};this.uRT=function(a){a=a>>16&31;return 0===a?"0":"(r["+a+"]>>>0)"};this.uRTH=function(a){a=a>>16&31;return 0===a?"0":"(h["+a+
"]>>>0)"};this.rt=function(a){return a>>16&31};this.offset_imm=function(a){return a&65535};this.soffset_imm=function(a){return(a&65535)<<16>>16};this.setVAddr=function(a){return"var vAddr=("+this.RS(a)+"+"+this.soffset_imm(a)+")>>0;"};this.fn=function(a){return a&63};this.sa=function(a){return a>>6&31};this.fd=function(a){return a>>6&31};this.sLogic=function(a,b){return"{"+this.tRD(a)+"="+this.RS(a)+b+this.RT(a)+";"+this.tRDH(a)+"="+this.RD(a)+">>31}"};this.dLogic=function(a,b){return"{"+this.tRD(a)+
"="+this.RS(a)+b+this.RT(a)+";"+this.tRDH(a)+"="+this.RSH(a)+b+this.RTH(a)+"}"};this.inter_mtc0=function(a,b,c,f,h,k,m){switch(b){case consts.CAUSE:k[b]&=-769;k[b]|=a[c]&768;a[c]&768&&0!==(k[consts.CAUSE]&k[consts.STATUS]&65280)&&m.setException(consts.EXC_INT,0,h,f);break;case consts.COUNT:k[b]=a[c];break;case consts.COMPARE:k[consts.CAUSE]&=~consts.CAUSE_IP8;k[b]=a[c];break;case consts.STATUS:if(0===(a[c]&consts.EXL)&&1===(k[b]&consts.EXL)&&0!==(k[consts.CAUSE]&k[consts.STATUS]&65280)){k[b]=a[c];
m.setException(consts.EXC_INT,0,h,f);break}if(1===(a[c]&consts.IE)&&0===(k[b]&consts.IE)&&0!==(k[consts.CAUSE]&k[consts.STATUS]&65280)){k[b]=a[c];m.setException(consts.EXC_INT,0,h,f);break}k[b]=a[c];break;case consts.BADVADDR:case consts.PREVID:case consts.RANDOM:break;case consts.INDEX:k[b]=a[c]&2147483711;break;case consts.ENTRYLO0:k[b]=a[c]&1073741823;break;case consts.ENTRYLO1:k[b]=a[c]&1073741823;break;case consts.ENTRYHI:k[b]=a[c]&4294959359;break;case consts.PAGEMASK:k[b]=a[c]&33546240;break;
case consts.WIRED:k[b]=a[c]&31;k[consts.RANDOM]=31;break;default:k[b]=a[c]}};this.inter_mult=function(a,b,c){var f;f=a[this.rs(c)];c=a[this.rt(c)];f=goog.math.Long.fromBits(f,f>>31);c=goog.math.Long.fromBits(c,c>>31);f=f.multiply(c);a[32]=f.getLowBits();b[32]=a[32]>>31;a[33]=f.getHighBits();b[33]=a[33]>>31};this.inter_multu=function(a,b,c){var f;f=a[this.rs(c)];c=a[this.rt(c)];f=goog.math.Long.fromBits(f,0);c=goog.math.Long.fromBits(c,0);f=f.multiply(c);a[32]=f.getLowBits();b[32]=a[32]>>31;a[33]=
f.getHighBits();b[33]=a[33]>>31};this.inter_daddi=function(a,b,c){var f,h;h=goog.math.Long.fromBits(a[this.rs(c)],b[this.rs(c)]);f=goog.math.Long.fromBits(this.soffset_imm(c),this.soffset_imm(c)>>31);f=h.add(f);a[this.rt(c)]=f.getLowBits();b[this.rt(c)]=f.getHighBits()};this.inter_daddiu=function(a,b,c){var f,h;h=goog.math.Long.fromBits(a[this.rs(c)],b[this.rs(c)]);f=goog.math.Long.fromBits(this.soffset_imm(c),this.soffset_imm(c)>>31);f=h.add(f);a[this.rt(c)]=f.getLowBits();b[this.rt(c)]=f.getHighBits()};
this.inter_dadd=function(a,b,c){var f,h;f=goog.math.Long.fromBits(a[this.rs(c)],b[this.rs(c)]);h=goog.math.Long.fromBits(a[this.rt(c)],b[this.rt(c)]);f=f.add(h);a[this.rd(c)]=f.getLowBits();b[this.rd(c)]=f.getHighBits()};this.inter_daddu=function(a,b,c){var f,h;f=goog.math.Long.fromBits(a[this.rs(c)],b[this.rs(c)]);h=goog.math.Long.fromBits(a[this.rt(c)],b[this.rt(c)]);f=f.add(h);a[this.rd(c)]=f.getLowBits();b[this.rd(c)]=f.getHighBits()};this.inter_div=function(a,b,c){0===a[this.rt(c)]?alert("divide by zero"):
(a[32]=a[this.rs(c)]/a[this.rt(c)],b[32]=a[32]>>31,a[33]=a[this.rs(c)]%a[this.rt(c)],b[33]=a[33]>>31)};this.inter_ddiv=function(a,b,c){var f,h,k;f=a[this.rs(c)];k=a[this.rt(c)];h=b[this.rs(c)];c=b[this.rt(c)];f=goog.math.Long.fromBits(f,h);h=goog.math.Long.fromBits(k,c);0===h?alert("divide by zero"):(k=f.div(h),f=f.modulo(h),a[32]=k.getLowBits(),b[32]=k.getHighBits(),a[33]=f.getLowBits(),b[33]=f.getHighBits())};this.inter_divu=function(a,b,c){0===a[this.rt(c)]?alert("divide by zero"):(a[32]=(a[this.rs(c)]>>>
0)/(a[this.rt(c)]>>>0),b[32]=0,a[33]=(a[this.rs(c)]>>>0)%(a[this.rt(c)]>>>0),b[33]=0)};this.inter_dmult=function(a,b,c){var f;f="0x"+String(dec2hex(b[this.rs(c)]))+String(dec2hex(a[this.rs(c)]));c="0x"+String(dec2hex(b[this.rt(c)]))+String(dec2hex(a[this.rt(c)]));f=new BigInt(f);c=new BigInt(c);c=bigint_mul(f,c).toStringBase(16);"-"===c[0]&&alert("dmult:"+c);24<c.length?(f=c.length-24,b[33]="0x"+c.substr(0,f)>>>0,a[33]="0x"+c.substr(f,8)>>>0,b[32]="0x"+c.substr(f+8,8)>>>0,a[32]="0x"+c.substr(f+16,
8)>>>0):16<c.length?(f=c.length-16,b[33]=0,a[33]="0x"+c.substr(0,f)>>>0,b[32]="0x"+c.substr(f,8)>>>0,a[32]="0x"+c.substr(f+8,8)>>>0):8<c.length?(f=c.length-8,b[33]=0,a[33]=0,b[32]="0x"+c.substr(0,f)>>>0,a[32]="0x"+c.substr(f,8)>>>0):(f=c.length,b[33]=0,a[33]=0,b[32]=0,a[32]="0x"+c.substr(0,f)>>>0)};this.inter_dmultu=function(a,b,c){var f;f="0x0"+String(dec2hex(b[this.rs(c)]))+String(dec2hex(a[this.rs(c)]));c="0x0"+String(dec2hex(b[this.rt(c)]))+String(dec2hex(a[this.rt(c)]));f=new BigInt(f);c=new BigInt(c);
c=bigint_mul(f,c).toStringBase(16);"-"===c[0]&&alert("dmultu:"+c);24<c.length?(f=c.length-24,b[33]="0x"+c.substr(0,f)>>>0,a[33]="0x"+c.substr(f,8)>>>0,b[32]="0x"+c.substr(f+8,8)>>>0,a[32]="0x"+c.substr(f+16,8)>>>0):16<c.length?(f=c.length-16,b[33]=0,a[33]="0x"+c.substr(0,f)>>>0,b[32]="0x"+c.substr(f,8)>>>0,a[32]="0x"+c.substr(f+8,8)>>>0):8<c.length?(f=c.length-8,b[33]=0,a[33]=0,b[32]="0x"+c.substr(0,f)>>>0,a[32]="0x"+c.substr(f,8)>>>0):(f=c.length,b[33]=0,a[33]=0,b[32]=0,a[32]="0x"+c.substr(0,f)>>>
0)};this.inter_ddivu=function(a,b,c){var f,h,k;k="0x0"+String(dec2hex(b[this.rs(c)]))+String(dec2hex(a[this.rs(c)]));c="0x0"+String(dec2hex(b[this.rt(c)]))+String(dec2hex(a[this.rt(c)]));k=new BigInt(k);c=new BigInt(c);(f=bigint_div(k,c))?(h=f.toStringBase(16),"-"===h[0]&&alert("ddivu:"+h),8<h.length?(f=h.length-8,b[32]="0x"+h.substr(0,f)>>>0,a[32]="0x"+h.substr(f,8)>>>0):(f=h.length,b[32]=0,a[32]="0x"+h.substr(0,f)>>>0)):(a[32]=0,b[32]=0);f=bigint_mod(k,c);h=f.toStringBase(16);8<h.length?(f=h.length-
8,b[33]="0x"+h.substr(0,f)>>>0,a[33]="0x"+h.substr(f,8)>>>0):(f=h.length,b[33]=0,a[33]="0x"+h.substr(0,f)>>>0)};this.inter_r4300i_C_cond_fmt_s=function(a,b,c){var f,h,k,m,l;f=a&1;h=a>>1&1;k=a>>2&1;m=a>>3&1;l=c[this.FS32ArrayView(a)];c=c[this.FT32ArrayView(a)];if(isNaN(l)||isNaN(c)){if(l=a=!1,c=!0,0!==m)return}else a=l<c,l=l===c,c=!1;b[31]&=~consts.COP1_CONDITION_BIT;(f&&c||h&&l||k&&a)&&(b[31]|=consts.COP1_CONDITION_BIT)};this.inter_r4300i_C_cond_fmt_d=function(a,b,c){var f,h,k,m,l;f=a&1;h=a>>1&1;
k=a>>2&1;m=a>>3&1;l=c[this.FS64ArrayView(a)];c=c[this.FT64ArrayView(a)];if(isNaN(l)||isNaN(c)){if(l=a=!1,c=!0,0!==m)return}else a=l<c,l=l===c,c=!1;b[31]&=~consts.COP1_CONDITION_BIT;(f&&c||h&&l||k&&a)&&(b[31]|=consts.COP1_CONDITION_BIT)};this.writeTLBEntry=function(a,b){var c;c=b[consts.ENTRYLO0]&b[consts.ENTRYLO1]&consts.TLBLO_G;a.pageMask=b[consts.PAGEMASK]>>>0;a.entryLo1=(b[consts.ENTRYLO1]|c)>>>0;a.entryLo0=(b[consts.ENTRYLO0]|c)>>>0;a.myHiMask=(~a.pageMask>>>0&consts.TLBHI_VPN2MASK)>>>0;a.entryHi=
(b[consts.ENTRYHI]>>>0&~b[consts.PAGEMASK]>>>0)>>>0;switch(a.pageMask){case 0:a.loCompare=4096;break;case 24576:a.loCompare=16384;break;case 122880:a.loCompare=65536;break;case 516096:a.loCompare=262144;break;case 2088960:a.loCompare=1048576;break;case 8380416:a.loCompare=4194304;break;case 33546240:a.loCompare=16777216;break;default:console.log("ERROR: tlbwi - invalid page size"+a.pageMask)}this.newtlb=!0};this.buildTLBHelper=function(a,b,c,f,h){var k;k=a>>>12;b>>>=12;if(!0===h)for(;k<b;)this.core.memory.physRegion[k]=
(k&131071)>>>4,k++;else for(f=(2147483648|c<<6>>>0&f>>>1)>>>0;k<b;)c=f+(k<<12)-a&536870911,this.core.memory.physRegion[k]=c>>>16,k++};this.buildTLB=function(a,b){var c,f,h;f=(a.entryHi&4294967040)>>>0;h=f+a.loCompare>>>0;c=f+2*a.loCompare>>>0;this.buildTLBHelper(f,h,a.entryLo0,a.myHiMask,b);this.buildTLBHelper(h,c,a.entryLo1,a.myHiMask,b)};this.refreshTLB=function(a,b){1===a.valid&&this.buildTLB(a,!0);this.writeTLBEntry(a,b);a.valid=0;if(b[consts.ENTRYLO1]&consts.TLBLO_V||b[consts.ENTRYLO0]&consts.TLBLO_V)a.valid=
1;1===a.valid&&this.buildTLB(a)};this.inter_tlbwi=function(a,b,c){0>a||31<a?console.log("ERROR: tlbwi received an invalid index=%08X",a):this.refreshTLB(b[a],c)};this.inter_tlbp=function(a,b){var c;b[consts.INDEX]|=2147483648;for(c=0;31>c;){if((a[c].entryHi&a[c].myHiMask)===(b[consts.ENTRYHI]&a[c].myHiMask)&&(a[c].entryLo0&consts.TLBLO_G&a[c].entryLo1||(a[c].entryHi&consts.TLBHI_PIDMASK)===(b[consts.ENTRYHI]&consts.TLBHI_PIDMASK))){b[consts.INDEX]=c;break}c++}};this.inter_tlbr=function(a,b){var c;
c=b[consts.INDEX]&2147483647;0>c||31<c?console.log("ERROR: tlbr received an invalid index=%08X",c):(b[consts.PAGEMASK]=a[c].pageMask,b[consts.ENTRYHI]=a[c].entryHi,b[consts.ENTRYHI]&=~a[c].pageMask>>>0,b[consts.ENTRYLO1]=a[c].entryLo1,b[consts.ENTRYLO0]=a[c].entryLo0)};return this};a.dec2hex=function(a){var c;for(c="0123456789ABCDEF".substr(a&15,1);!(a>>=4,a&=268435455,c="0123456789ABCDEF".substr(a&15,1)+c,!(15<a)););return c}}).call(this);(function(){C1964jsEmulator.prototype.CPU_instruction="instr REGIMM_instr r4300i_j r4300i_jal r4300i_beq r4300i_bne r4300i_blez r4300i_bgtz r4300i_addi r4300i_addiu r4300i_slti r4300i_sltiu r4300i_andi r4300i_ori r4300i_xori r4300i_lui COP0_instr COP1_instr UNUSED UNUSED r4300i_beql r4300i_bnel r4300i_blezl r4300i_bgtzl r4300i_daddi r4300i_daddiu r4300i_ldl r4300i_ldr UNUSED UNUSED UNUSED UNUSED r4300i_lb r4300i_lh r4300i_lwl r4300i_lw r4300i_lbu r4300i_lhu r4300i_lwr r4300i_lwu r4300i_sb r4300i_sh r4300i_swl r4300i_sw r4300i_sdl r4300i_sdr r4300i_swr r4300i_cache r4300i_ll r4300i_lwc1 UNUSED UNUSED r4300i_lld r4300i_ldc1 UNUSED r4300i_ld r4300i_sc r4300i_swc1 UNUSED UNUSED r4300i_scd r4300i_sdc1 UNUSED r4300i_sd".split(" ");
C1964jsEmulator.prototype.r4300i_Instruction="r4300i_sll UNUSED r4300i_srl r4300i_sra r4300i_sllv UNUSED r4300i_srlv r4300i_srav r4300i_jr r4300i_jalr UNUSED UNUSED r4300i_syscall r4300i_break UNUSED r4300i_sync r4300i_mfhi r4300i_mthi r4300i_mflo r4300i_mtlo r4300i_dsllv UNUSED r4300i_dsrlv r4300i_dsrav r4300i_mult r4300i_multu r4300i_div r4300i_divu r4300i_dmult r4300i_dmultu r4300i_ddiv r4300i_ddivu r4300i_add r4300i_addu r4300i_sub r4300i_subu r4300i_and r4300i_or r4300i_xor r4300i_nor UNUSED UNUSED r4300i_slt r4300i_sltu r4300i_dadd r4300i_daddu r4300i_dsub r4300i_dsubu r4300i_tge r4300i_tgeu r4300i_tlt r4300i_tltu r4300i_teq UNUSED r4300i_tne UNUSED r4300i_dsll UNUSED r4300i_dsrl r4300i_dsra r4300i_dsll32 UNUSED r4300i_dsrl32 r4300i_dsra32".split(" ");
C1964jsEmulator.prototype.REGIMM_Instruction="r4300i_bltz r4300i_bgez r4300i_bltzl r4300i_bgezl UNUSED UNUSED UNUSED UNUSED r4300i_tgei r4300i_tgeiu r4300i_tlti r4300i_tltiu r4300i_teqi UNUSED r4300i_tnei UNUSED r4300i_bltzal r4300i_bgezal r4300i_bltzall r4300i_bgezall UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");C1964jsEmulator.prototype.COP0_Instruction="r4300i_COP0_mfc0 UNUSED UNUSED UNUSED r4300i_COP0_mtc0 UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED TLB_instr UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.TLB_Instruction="UNUSED r4300i_COP0_tlbr r4300i_COP0_tlbwi UNUSED UNUSED UNUSED r4300i_COP0_tlbwr UNUSED r4300i_COP0_tlbp UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP0_eret UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.COP1_Instruction="r4300i_COP1_mfc1 r4300i_COP1_dmfc1 r4300i_COP1_cfc1 UNUSED r4300i_COP1_mtc1 r4300i_COP1_dmtc1 r4300i_COP1_ctc1 UNUSED COP1_BC_instr UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED COP1_S_instr COP1_D_instr UNUSED UNUSED COP1_W_instr COP1_L_instr UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");C1964jsEmulator.prototype.COP1_BC_Instruction="r4300i_COP1_bc1f r4300i_COP1_bc1t r4300i_COP1_bc1fl r4300i_COP1_bc1tl UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.COP1_S_Instruction="r4300i_COP1_add_s r4300i_COP1_sub_s r4300i_COP1_mul_s r4300i_COP1_div_s r4300i_COP1_sqrt_s r4300i_COP1_abs_s r4300i_COP1_mov_s r4300i_COP1_neg_s r4300i_COP1_roundl_s r4300i_COP1_truncl_s r4300i_COP1_ceill_s r4300i_COP1_floorl_s r4300i_COP1_roundw_s r4300i_COP1_truncw_s r4300i_COP1_ceilw_s r4300i_COP1_floorw_s UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvtd_s UNUSED UNUSED r4300i_COP1_cvtw_s r4300i_COP1_cvtl_s UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_C_F_S r4300i_C_UN_S r4300i_C_EQ_S r4300i_C_UEQ_S r4300i_C_OLT_S r4300i_C_ULT_S r4300i_C_OLE_S r4300i_C_ULE_S r4300i_C_SF_S r4300i_C_NGLE_S r4300i_C_SEQ_S r4300i_C_NGL_S r4300i_C_LT_S r4300i_C_NGE_S r4300i_C_LE_S r4300i_C_NGT_S".split(" ");
C1964jsEmulator.prototype.COP1_D_Instruction="r4300i_COP1_add_d r4300i_COP1_sub_d r4300i_COP1_mul_d r4300i_COP1_div_d r4300i_COP1_sqrt_d r4300i_COP1_abs_d r4300i_COP1_mov_d r4300i_COP1_neg_d r4300i_COP1_roundl_d r4300i_COP1_truncl_d r4300i_COP1_ceill_d r4300i_COP1_floorl_d r4300i_COP1_roundw_d r4300i_COP1_truncw_d r4300i_COP1_ceilw_d r4300i_COP1_floorw_d UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvts_d UNUSED UNUSED UNUSED r4300i_COP1_cvtw_d r4300i_COP1_cvtl_d UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_C_F_D r4300i_C_UN_D r4300i_C_EQ_D r4300i_C_UEQ_D r4300i_C_OLT_D r4300i_C_ULT_D r4300i_C_OLE_D r4300i_C_ULE_D r4300i_C_SF_D r4300i_C_NGLE_D r4300i_C_SEQ_D r4300i_C_NGL_D r4300i_C_LT_D r4300i_C_NGE_D r4300i_C_LE_D r4300i_C_NGT_D".split(" ");
C1964jsEmulator.prototype.COP1_W_Instruction="UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvts_w r4300i_COP1_cvtd_w UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.COP1_L_Instruction="UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED r4300i_COP1_cvts_l r4300i_COP1_cvtd_l UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED UNUSED".split(" ");
C1964jsEmulator.prototype.instr=function(a,b){return this[this.r4300i_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.REGIMM_instr=function(a,b){return this[this.REGIMM_Instruction[this.helpers.rt(a)]](a,b)};C1964jsEmulator.prototype.COP0_instr=function(a,b){return this[this.COP0_Instruction[this.helpers.rs(a)]](a,b)};C1964jsEmulator.prototype.COP1_instr=function(a,b){return this[this.COP1_Instruction[this.helpers.rs(a)]](a,b)};C1964jsEmulator.prototype.TLB_instr=function(a,b){return this[this.TLB_Instruction[this.helpers.fn(a)]](a,
b)};C1964jsEmulator.prototype.COP1_BC_instr=function(a,b){return this[this.COP1_BC_Instruction[this.helpers.rt(a)]](a,b)};C1964jsEmulator.prototype.COP1_S_instr=function(a,b){return this[this.COP1_S_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.COP1_D_instr=function(a,b){return this[this.COP1_D_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.COP1_W_instr=function(a,b){return this[this.COP1_W_Instruction[this.helpers.fn(a)]](a,b)};C1964jsEmulator.prototype.COP1_L_instr=
function(a,b){return this[this.COP1_L_Instruction[this.helpers.fn(a)]](a,b)}}).call(this);(function(){C1964jsEmulator.prototype.getTVSystem=function(a){switch(a){case 0:a=this.TV_SYSTEM_NTSC;break;case 55:a=this.TV_SYSTEM_NTSC;break;case 65:a=this.TV_SYSTEM_NTSC;break;case 68:a=this.TV_SYSTEM_PAL;break;case 69:a=this.TV_SYSTEM_NTSC;break;case 70:a=this.TV_SYSTEM_PAL;break;case "I":a=this.TV_SYSTEM_PAL;break;case 74:a=this.TV_SYSTEM_NTSC;break;case 80:a=this.TV_SYSTEM_PAL;break;case 83:a=this.TV_SYSTEM_PAL;break;case 85:a=this.TV_SYSTEM_PAL;break;case 88:a=this.TV_SYSTEM_PAL;break;case 89:a=
this.TV_SYSTEM_PAL;break;case 32:case 33:case 56:case 112:a=this.TV_SYSTEM_PAL;break;default:a=this.TV_SYSTEM_PAL}return a};C1964jsEmulator.prototype.getCIC=function(){var a,b;for(b=a=0;4032>b;)a+=this.memory.romUint8Array[64+b],b+=1;switch(a){case 211495:case 213534:this.log("Using CIC-NUS-6101 for starfox\n");a=63;break;case 213060:this.log("Using CIC-NUS-6102 for mario\n");a=63;break;case 219088:this.log("Using CIC-NUS-6103 for Banjo\n");a=120;break;case 293505:this.log("Using CIC-NUS-6105 for Zelda\n");
a=145;break;case 225740:this.log("Using CIC-NUS-6106 for F-Zero/Yoshi Story\n");a=133;break;case 213961:this.log("Using Boot Code for F1 World Grand Prix\n");a=133;break;default:this.log("Unknown boot code, using Mario boot code instead"),a=63}return a}}).call(this);goog.math={};goog.math.Long=function(a,b){this.low_=a|0;this.high_=b|0};goog.math.Long.IntCache_={};goog.math.Long.fromInt=function(a){if(-128<=a&&128>a){var b=goog.math.Long.IntCache_[a];if(b)return b}b=new goog.math.Long(a|0,0>a?-1:0);-128<=a&&128>a&&(goog.math.Long.IntCache_[a]=b);return b};
goog.math.Long.fromNumber=function(a){return isNaN(a)||!isFinite(a)?goog.math.Long.ZERO:a<=-goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MIN_VALUE:a+1>=goog.math.Long.TWO_PWR_63_DBL_?goog.math.Long.MAX_VALUE:0>a?goog.math.Long.fromNumber(-a).negate():new goog.math.Long(a%goog.math.Long.TWO_PWR_32_DBL_|0,a/goog.math.Long.TWO_PWR_32_DBL_|0)};goog.math.Long.fromBits=function(a,b){return new goog.math.Long(a,b)};
goog.math.Long.fromString=function(a,b){if(0==a.length)throw Error("number format error: empty string");var c=b||10;if(2>c||36<c)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return goog.math.Long.fromString(a.substring(1),c).negate();if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character: '+a);for(var e=goog.math.Long.fromNumber(Math.pow(c,8)),d=goog.math.Long.ZERO,g=0;g<a.length;g+=8){var f=Math.min(8,a.length-g),h=parseInt(a.substring(g,g+f),c);8>f?(f=goog.math.Long.fromNumber(Math.pow(c,
f)),d=d.multiply(f).add(goog.math.Long.fromNumber(h))):(d=d.multiply(e),d=d.add(goog.math.Long.fromNumber(h)))}return d};goog.math.Long.TWO_PWR_16_DBL_=65536;goog.math.Long.TWO_PWR_24_DBL_=16777216;goog.math.Long.TWO_PWR_32_DBL_=goog.math.Long.TWO_PWR_16_DBL_*goog.math.Long.TWO_PWR_16_DBL_;goog.math.Long.TWO_PWR_31_DBL_=goog.math.Long.TWO_PWR_32_DBL_/2;goog.math.Long.TWO_PWR_48_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_16_DBL_;
goog.math.Long.TWO_PWR_64_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_32_DBL_;goog.math.Long.TWO_PWR_63_DBL_=goog.math.Long.TWO_PWR_64_DBL_/2;goog.math.Long.ZERO=goog.math.Long.fromInt(0);goog.math.Long.ONE=goog.math.Long.fromInt(1);goog.math.Long.NEG_ONE=goog.math.Long.fromInt(-1);goog.math.Long.MAX_VALUE=goog.math.Long.fromBits(-1,2147483647);goog.math.Long.MIN_VALUE=goog.math.Long.fromBits(0,-2147483648);goog.math.Long.TWO_PWR_24_=goog.math.Long.fromInt(16777216);
goog.math.Long.prototype.toInt=function(){return this.low_};goog.math.Long.prototype.toNumber=function(){return this.high_*goog.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()};
goog.math.Long.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(goog.math.Long.MIN_VALUE)){var b=goog.math.Long.fromNumber(a),c=this.div(b),b=c.multiply(b).subtract(this);return c.toString(a)+b.toInt().toString(a)}return"-"+this.negate().toString(a)}for(var c=goog.math.Long.fromNumber(Math.pow(a,6)),b=this,e="";;){var d=b.div(c),g=b.subtract(d.multiply(c)).toInt().toString(a),b=d;if(b.isZero())return g+
e;for(;6>g.length;)g="0"+g;e=""+g+e}};goog.math.Long.prototype.getHighBits=function(){return this.high_};goog.math.Long.prototype.getLowBits=function(){return this.low_};goog.math.Long.prototype.getLowBitsUnsigned=function(){return 0<=this.low_?this.low_:goog.math.Long.TWO_PWR_32_DBL_+this.low_};
goog.math.Long.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(goog.math.Long.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high_?this.high_:this.low_,b=31;0<b&&0==(a&1<<b);b--);return 0!=this.high_?b+33:b+1};goog.math.Long.prototype.isZero=function(){return 0==this.high_&&0==this.low_};goog.math.Long.prototype.isNegative=function(){return 0>this.high_};goog.math.Long.prototype.isOdd=function(){return 1==(this.low_&1)};
goog.math.Long.prototype.equals=function(a){return this.high_==a.high_&&this.low_==a.low_};goog.math.Long.prototype.notEquals=function(a){return this.high_!=a.high_||this.low_!=a.low_};goog.math.Long.prototype.lessThan=function(a){return 0>this.compare(a)};goog.math.Long.prototype.lessThanOrEqual=function(a){return 0>=this.compare(a)};goog.math.Long.prototype.greaterThan=function(a){return 0<this.compare(a)};goog.math.Long.prototype.greaterThanOrEqual=function(a){return 0<=this.compare(a)};
goog.math.Long.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.subtract(a).isNegative()?-1:1};goog.math.Long.prototype.negate=function(){return this.equals(goog.math.Long.MIN_VALUE)?goog.math.Long.MIN_VALUE:this.not().add(goog.math.Long.ONE)};
goog.math.Long.prototype.add=function(a){var b=this.high_>>>16,c=this.high_&65535,e=this.low_>>>16,d=a.high_>>>16,g=a.high_&65535,f=a.low_>>>16,h;h=0+((this.low_&65535)+(a.low_&65535));a=0+(h>>>16);a+=e+f;e=0+(a>>>16);e+=c+g;c=0+(e>>>16);c=c+(b+d)&65535;return goog.math.Long.fromBits((a&65535)<<16|h&65535,c<<16|e&65535)};goog.math.Long.prototype.subtract=function(a){return this.add(a.negate())};
goog.math.Long.prototype.multiply=function(a){if(this.isZero()||a.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE))return a.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(a.equals(goog.math.Long.MIN_VALUE))return this.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(goog.math.Long.TWO_PWR_24_)&&
a.lessThan(goog.math.Long.TWO_PWR_24_))return goog.math.Long.fromNumber(this.toNumber()*a.toNumber());var b=this.high_>>>16,c=this.high_&65535,e=this.low_>>>16,d=this.low_&65535,g=a.high_>>>16,f=a.high_&65535,h=a.low_>>>16;a=a.low_&65535;var k,m,l,n;n=0+d*a;l=0+(n>>>16);l+=e*a;m=0+(l>>>16);l=(l&65535)+d*h;m+=l>>>16;l&=65535;m+=c*a;k=0+(m>>>16);m=(m&65535)+e*h;k+=m>>>16;m&=65535;m+=d*f;k+=m>>>16;m&=65535;k=k+(b*a+c*h+e*f+d*g)&65535;return goog.math.Long.fromBits(l<<16|n&65535,k<<16|m)};
goog.math.Long.prototype.div=function(a){if(a.isZero())throw Error("division by zero");if(this.isZero())return goog.math.Long.ZERO;if(this.equals(goog.math.Long.MIN_VALUE)){if(a.equals(goog.math.Long.ONE)||a.equals(goog.math.Long.NEG_ONE))return goog.math.Long.MIN_VALUE;if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ONE;var b=this.shiftRight(1).div(a).shiftLeft(1);if(b.equals(goog.math.Long.ZERO))return a.isNegative()?goog.math.Long.ONE:goog.math.Long.NEG_ONE;var c=this.subtract(a.multiply(b));
return b.add(c.div(a))}if(a.equals(goog.math.Long.MIN_VALUE))return goog.math.Long.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(var e=goog.math.Long.ZERO,c=this;c.greaterThanOrEqual(a);){for(var b=Math.max(1,Math.floor(c.toNumber()/a.toNumber())),d=Math.ceil(Math.log(b)/Math.LN2),d=48>=d?1:Math.pow(2,d-48),g=goog.math.Long.fromNumber(b),f=g.multiply(a);f.isNegative()||f.greaterThan(c);)b-=
d,g=goog.math.Long.fromNumber(b),f=g.multiply(a);g.isZero()&&(g=goog.math.Long.ONE);e=e.add(g);c=c.subtract(f)}return e};goog.math.Long.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))};goog.math.Long.prototype.not=function(){return goog.math.Long.fromBits(~this.low_,~this.high_)};goog.math.Long.prototype.and=function(a){return goog.math.Long.fromBits(this.low_&a.low_,this.high_&a.high_)};
goog.math.Long.prototype.or=function(a){return goog.math.Long.fromBits(this.low_|a.low_,this.high_|a.high_)};goog.math.Long.prototype.xor=function(a){return goog.math.Long.fromBits(this.low_^a.low_,this.high_^a.high_)};goog.math.Long.prototype.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.low_;return 32>a?goog.math.Long.fromBits(b<<a,this.high_<<a|b>>>32-a):goog.math.Long.fromBits(0,b<<a-32)};
goog.math.Long.prototype.shiftRight=function(a){a&=63;if(0==a)return this;var b=this.high_;return 32>a?goog.math.Long.fromBits(this.low_>>>a|b<<32-a,b>>a):goog.math.Long.fromBits(b>>a-32,0<=b?0:-1)};goog.math.Long.prototype.shiftRightUnsigned=function(a){a&=63;if(0==a)return this;var b=this.high_;return 32>a?goog.math.Long.fromBits(this.low_>>>a|b<<32-a,b>>>a):32==a?goog.math.Long.fromBits(b,0):goog.math.Long.fromBits(b>>>a-32,0)};(function(){var a;a=function(){function a(b){this.pifUint8Array=b;this.eepromStatusByte=128;this.controlsPresent=Array(4);this.eeprom=new Uint8Array(4096);this.controlsPresent[0]=!0;this.controlsPresent[1]=!1;this.controlsPresent[2]=!1;this.controlsPresent[3]=!1;this.g1964buttons=0;window.onkeydown=this.onKeyDown.bind(this);window.onkeyup=this.onKeyUp.bind(this)}a.prototype.processPif=function(){var a,b,d,g;d=0;g=consts.MEMORY_START_PIF_RAM-consts.MEMORY_START_PIF;if(255===this.pifUint8Array[g]&&
255===this.pifUint8Array[g+1]&&255===this.pifUint8Array[g+2]&&255===this.pifUint8Array[g+3])throw Error("todo: decrypt");for(b=0;64>b;){a=this.pifUint8Array[g+b];if(254===a)break;else if(255!==a&&253!==a&&180!==a&&86!==a&&184!==a)if(0===a)d+=1;else if(4===d){this.processEeprom(g,b);break}else if(4>d){if(!1===this.processController(b,d,g))break;d+=1;b+=a+(this.pifUint8Array[g+b+1]&63)+1}else{log("Device > 4. Device = "+d);break}b+=1}this.pifUint8Array[g+63]=0};a.prototype.processEeprom=function(a,
b){switch(this.pifUint8Array[a+b+2]){case 255:case 0:this.pifUint8Array[a+b+3]=0;this.pifUint8Array[a+b+4]=this.eepromStatusByte;this.pifUint8Array[a+b+5]=0;break;case 4:this.readEeprom(a,b+4,8*this.pifUint8Array[a+b+3]);break;case 5:this.writeEeprom(a,b+4,8*this.pifUint8Array[a+b+3])}return!1};a.prototype.readEeprom=function(a,b,d){this.pifUint8Array[a+b]=this.eeprom[d];this.pifUint8Array[a+b+1]=this.eeprom[d+1];this.pifUint8Array[a+b+2]=this.eeprom[d+2];this.pifUint8Array[a+b+3]=this.eeprom[d+3];
this.pifUint8Array[a+b+4]=this.eeprom[d+4];this.pifUint8Array[a+b+5]=this.eeprom[d+5];this.pifUint8Array[a+b+6]=this.eeprom[d+6];this.pifUint8Array[a+b+7]=this.eeprom[d+7]};a.prototype.writeEeprom=function(a,b,d){this.eeprom[d]=this.pifUint8Array[a+b];this.eeprom[d+1]=this.pifUint8Array[a+b+1];this.eeprom[d+2]=this.pifUint8Array[a+b+2];this.eeprom[d+3]=this.pifUint8Array[a+b+3];this.eeprom[d+4]=this.pifUint8Array[a+b+4];this.eeprom[d+5]=this.pifUint8Array[a+b+5];this.eeprom[d+6]=this.pifUint8Array[a+
b+6];this.eeprom[d+7]=this.pifUint8Array[a+b+7]};a.prototype.processController=function(a,b,d){if(!1===this.controlsPresent[b])return this.pifUint8Array[d+a+1]|=128,this.pifUint8Array[d+a+3]=0,this.pifUint8Array[d+a+4]=0,this.pifUint8Array[d+a+5]=0,!0;b=this.pifUint8Array[d+a+2];switch(b){case 255:case 0:this.pifUint8Array[d+a+3]=5;this.pifUint8Array[d+a+4]=0;this.pifUint8Array[d+a+5]=0;break;case 1:b=this.readControllerData();this.pifUint8Array[d+a+3]=b>>24;this.pifUint8Array[d+a+4]=b>>16;this.pifUint8Array[d+
a+5]=b>>8;this.pifUint8Array[d+a+6]=b;break;case 2:case 3:return log("todo: read/write controller pak"),!1;default:log("unknown controller command: "+b)}return!0};a.prototype.readControllerData=function(){return this.g1964buttons};return a}();("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsPif=a}).call(this);(function(){C1964jsPif.prototype.onKeyDown=function(a){if(a)switch(a.which){case 40:this.g1964buttons=this.g1964buttons&4294967040|128;break;case 38:this.g1964buttons=this.g1964buttons&4294967040|127;break;case 39:this.g1964buttons=this.g1964buttons&4294902015|32512;break;case 37:this.g1964buttons=this.g1964buttons&4294902015|32768;break;case 13:this.g1964buttons|=268435456;break;case 90:this.g1964buttons|=-2147483648;break;case 83:this.g1964buttons|=262144;break;case 87:this.g1964buttons|=524288;
break;case 68:this.g1964buttons|=65536;break;case 65:this.g1964buttons|=131072;break;case 88:this.g1964buttons|=1073741824;break;case 73:this.g1964buttons|=134217728;break;case 74:this.g1964buttons|=33554432;break;case 75:this.g1964buttons|=67108864;break;case 76:this.g1964buttons|=16777216;break;case 32:this.g1964buttons|=536870912;break;case 49:this.g1964buttons|=8388608;break;case 48:this.g1964buttons|=4194304}};C1964jsPif.prototype.onKeyUp=function(a){if(a)switch(a.which){case 40:this.g1964buttons&=
-129;break;case 38:this.g1964buttons&=-128;break;case 39:this.g1964buttons&=-32513;break;case 37:this.g1964buttons&=-32769;break;case 13:this.g1964buttons&=-268435457;break;case 90:this.g1964buttons&=2147483647;break;case 83:this.g1964buttons&=-262145;break;case 87:this.g1964buttons&=-524289;break;case 68:this.g1964buttons&=-65537;break;case 65:this.g1964buttons&=-131073;break;case 88:this.g1964buttons&=-1073741825;break;case 73:this.g1964buttons&=-134217729;break;case 74:this.g1964buttons&=-33554433;
break;case 75:this.g1964buttons&=-67108865;break;case 76:this.g1964buttons&=-16777217;break;case 32:this.g1964buttons&=-536870913;break;case 49:this.g1964buttons&=-8388609;break;case 48:this.g1964buttons&=-4194305;break;case 27:toggleUi()}}}).call(this);(function(){var a;a=function(){function a(b){this.core=b;this.rom=this.romUint8Array=void 0;this.rdramArrayBuffer=new ArrayBuffer(8388608);this.rdramUint8Array=new Uint8Array(this.rdramArrayBuffer);this.rdramUint16Array=new Uint16Array(this.rdramArrayBuffer);this.rdramUint32Array=new Uint32Array(this.rdramArrayBuffer);this.rdramDataView=new DataView(this.rdramArrayBuffer);this.spMemUint8Array=new Uint8Array(65536);this.spReg1Uint8Array=new Uint8Array(65536);this.spReg2Uint8Array=new Uint8Array(65536);
this.dpcUint8Array=new Uint8Array(65536);this.dpsUint8Array=new Uint8Array(65536);this.miUint8Array=new Uint8Array(65536);this.viUint8Array=new Uint8Array(65536);this.aiUint8Array=new Uint8Array(65536);this.piUint8Array=new Uint8Array(65536);this.siUint8Array=new Uint8Array(65536);this.c2a1Uint8Array=new Uint8Array(65536);this.c1a1Uint8Array=new Uint8Array(65536);this.c2a2Uint8Array=new Uint8Array(65536);this.c1a3Uint8Array=new Uint8Array(65536);this.riUint8Array=new Uint8Array(65536);this.pifUint8Array=
new Uint8Array(65536);this.gioUint8Array=new Uint8Array(65536);this.ramRegs0Uint8Array=new Uint8Array(65536);this.ramRegs4Uint8Array=new Uint8Array(65536);this.ramRegs8Uint8Array=new Uint8Array(65536);this.dummyReadWriteUint8Array=new Uint8Array(65536);this.region=[];this.region16=[];this.region32=[];this.writeRegion8=[];this.writeRegion16=[];this.writeRegion32=[];this.initRegion(0,2147483648,this.readTLB8,this.writeTLB8,this.readTLB16,this.writeTLB16,this.readTLB32,this.writeTLB32);this.initRegion(2147483648,
1073741824,this.readDummy8,this.writeDummy8,this.readDummy16,this.writeDummy16,this.readDummy32,this.writeDummy32);this.initRegion(3221225472,1073741824,this.readTLB8,this.writeTLB8,this.readTLB16,this.writeTLB16,this.readTLB32,this.writeTLB32);this.initRegion(0,8388608,this.readRdram8,this.writeRdram8,this.readRdram16,this.writeRdram16,this.readRdram32,this.writeRdram32);this.initRegion(66076672,66076672,this.readRamRegs4,this.writeRamRegs4,this.readRamRegs4,this.writeRamRegs4,this.readRamRegs4,
this.writeRamRegs4);this.initRegion(67108864,65536,this.readSpMem8,this.writeSpMem8,this.readSpMem16,this.writeSpMem16,this.readSpMem32,this.writeSpMem32);this.initRegion(67371008,65536,this.readSpReg1_8,this.writeSpReg1_8,this.readSpReg1_16,this.writeSpReg1_16,this.readSpReg1_32,this.writeSpReg1_32);this.initRegion(67633152,65536,this.readSpReg2_8,this.writeSpReg2_8,this.readSpReg2_16,this.writeSpReg2_16,this.readSpReg2_32,this.writeSpReg2_32);this.initRegion(68157440,65536,this.readDpc8,this.writeDpc8,
this.readDpc16,this.writeDpc16,this.readDpc32,this.writeDpc32);this.initRegion(69206016,65536,this.readDps8,this.writeDps8,this.readDps16,this.writeDps16,this.readDps32,this.writeDps32);this.initRegion(70254592,65536,this.readMi8,this.writeMi8,this.readMi16,this.writeMi16,this.readMi32,this.writeMi32);this.initRegion(71303168,65536,this.readVi8,this.writeVi8,this.readVi16,this.writeVi16,this.readVi32,this.writeVi32);this.initRegion(72351744,65536,this.readAi8,this.writeAi8,this.readAi16,this.writeAi16,
this.readAi32,this.writeAi32);this.initRegion(73400320,65536,this.readPi8,this.writePi8,this.readPi16,this.writePi16,this.readPi32,this.writePi32);this.initRegion(75497472,65536,this.readSi8,this.writeSi8,this.readSi16,this.writeSi16,this.readSi32,this.writeSi32);this.initRegion(83886080,65536,this.readC2A1_8,this.writeC2A1_8,this.readC2A1_16,this.writeC2A1_16,this.readC2A1_32,this.writeC2A1_32);this.initRegion(100663296,65536,this.readC1A1_8,this.writeC1A1_8,this.readC1A1_16,this.writeC1A1_16,this.readC1A1_32,
this.writeC1A1_32);this.initRegion(134217728,131072,this.readC2A2_8,this.writeC2A2_8,this.readC2A2_16,this.writeC2A2_16,this.readC2A2_32,this.writeC2A2_32);this.initRegion(268435456,67108864,this.readRom8,this.writeRom8,this.readRom16,this.writeRom16,this.readRom32,this.writeRom);this.initRegion(533725184,65536,this.readC1A3_8,this.writeC1A3_8,this.readC1A3_16,this.writeC1A3_16,this.readC1A3_32,this.writeC1A3_32);this.initRegion(74448896,65536,this.readRi8,this.writeRi8,this.readRi16,this.writeRi16,
this.readRi32,this.writeRi32);this.initRegion(532676608,65536,this.readPif8,this.writePif8,this.readPif16,this.writePif16,this.readPif32,this.writePif32);this.initRegion(402653184,65536,this.readGio8,this.writeGio8,this.readGio16,this.writeGio16,this.readGio32,this.writeGio32);this.initRegion(66060288,65536,this.readRamRegs0_8,this.writeRamRegs0_8,this.readRamRegs0_16,this.writeRamRegs0_16,this.readRamRegs0_32,this.writeRamRegs0_32);this.initRegion(66584576,65536,this.readRamRegs8_8,this.writeRamRegs8_8,
this.readRamRegs8_16,this.writeRamRegs8_16,this.readRamRegs8_32,this.writeRamRegs8_32);this.physRegion=void 0}a.prototype.initRegion=function(a,b,d,g,f,h,k,m){b=a+b>>>14;for(a>>>=14;a<b;)this.region[a]=d,this.region16[a]=f,this.region32[a]=k,this.writeRegion8[a]=g,this.writeRegion16[a]=h,this.writeRegion32[a]=m,a++};a.prototype.readDummy8=function(a,b){return a.dummyReadWriteUint8Array[b&65532]};a.prototype.readDummy16=function(a,b){var d;d=b&65532;return a.dummyReadWriteUint8Array[d]<<8|a.dummyReadWriteUint8Array[d+
1]};a.prototype.readDummy32=function(a,b){var d;d=b&65532;return a.dummyReadWriteUint8Array[d]<<24|a.dummyReadWriteUint8Array[d+1]<<16|a.dummyReadWriteUint8Array[d+2]<<8|a.dummyReadWriteUint8Array[d+3]};a.prototype.readRdram8=function(a,b){return a.rdramUint8Array[b-0]};a.prototype.readRdram16=function(a,b){var d;d=b-0;return a.rdramUint8Array[d]<<8|a.rdramUint8Array[d+1]};a.prototype.readRdram32=function(a,b){var d;d=b-0;return a.rdramUint8Array[d]<<24|a.rdramUint8Array[d+1]<<16|a.rdramUint8Array[d+
2]<<8|a.rdramUint8Array[d+3]};a.prototype.readRamRegs0_8=function(a,b){return a.ramRegs0Uint8Array[b-66060288]};a.prototype.readRamRegs0_16=function(a,b){var d;d=b-66060288;return a.ramRegs0Uint8Array[d]<<8|a.ramRegs0Uint8Array[d+1]};a.prototype.readRamRegs0_32=function(a,b){var d;d=b-66060288;return a.ramRegs0Uint8Array[d]<<24|a.ramRegs0Uint8Array[d+1]<<16|a.ramRegs0Uint8Array[d+2]<<8|a.ramRegs0Uint8Array[d+3]};a.prototype.readRamRegs4_8=function(a,b){return a.ramRegs4Uint8Array[b-66076672]};a.prototype.readRamRegs4_16=
function(a,b){var d;d=b-66076672;return a.ramRegs4Uint8Array[d]<<8|a.ramRegs4Uint8Array[d+1]};a.prototype.readRamRegs4_32=function(a,b){var d;d=b-66076672;return a.ramRegs4Uint8Array[d]<<24|a.ramRegs4Uint8Array[d+1]<<16|a.ramRegs4Uint8Array[d+2]<<8|a.ramRegs4Uint8Array[d+3]};a.prototype.readRamRegs8_8=function(a,b){return a.ramRegs8Uint8Array[b-66584576]};a.prototype.readRamRegs8_16=function(a,b){var d;d=b-66584576;return a.ramRegs8Uint8Array[d]<<8|a.ramRegs8Uint8Array[d+1]};a.prototype.readRamRegs8_32=
function(a,b){var d;d=b-66584576;return a.ramRegs8Uint8Array[d]<<24|a.ramRegs8Uint8Array[d+1]<<16|a.ramRegs8Uint8Array[d+2]<<8|a.ramRegs8Uint8Array[d+3]};a.prototype.readSpMem8=function(a,b){return a.spMemUint8Array[b-67108864]};a.prototype.readSpMem16=function(a,b){var d;d=b-67108864;return a.spMemUint8Array[d]<<8|a.spMemUint8Array[d+1]};a.prototype.readSpMem32=function(a,b){var d;d=b-67108864;return a.spMemUint8Array[d]<<24|a.spMemUint8Array[d+1]<<16|a.spMemUint8Array[d+2]<<8|a.spMemUint8Array[d+
3]};a.prototype.readSpReg1_8=function(a,b){return a.core.interrupts.readSPReg1(b-67371008)};a.prototype.readSpReg1_16=function(a,b){return a.core.interrupts.readSPReg1(b-67371008)};a.prototype.readSpReg1_32=function(a,b){return a.core.interrupts.readSPReg1(b-67371008)};a.prototype.readSpReg2_8=function(a,b){return a.spReg2Uint8Array[b-67633152]};a.prototype.readSpReg2_16=function(a,b){var d;d=b-67633152;return a.spReg2Uint8Array[d]<<8|a.spReg2Uint8Array[d+1]};a.prototype.readSpReg2_32=function(a,
b){var d;d=b-67633152;return a.spReg2Uint8Array[d]<<24|a.spReg2Uint8Array[d+1]<<16|a.spReg2Uint8Array[d+2]<<8|a.spReg2Uint8Array[d+3]};a.prototype.readDpc8=function(a,b){return a.dpcUint8Array[b-68157440]};a.prototype.readDpc16=function(a,b){var d;d=b-68157440;return a.dpcUint8Array[d]<<8|a.dpcUint8Array[d+1]};a.prototype.readDpc32=function(a,b){var d;d=b-68157440;return a.dpcUint8Array[d]<<24|a.dpcUint8Array[d+1]<<16|a.dpcUint8Array[d+2]<<8|a.dpcUint8Array[d+3]};a.prototype.readDps8=function(a,b){return a.dpsUint8Array[b-
69206016]};a.prototype.readDps16=function(a,b){var d;d=b-69206016;return a.dpsUint8Array[d]<<8|a.dpsUint8Array[d+1]};a.prototype.readDps32=function(a,b){var d;d=b-69206016;return a.dpsUint8Array[d]<<24|a.dpsUint8Array[d+1]<<16|a.dpsUint8Array[d+2]<<8|a.dpsUint8Array[d+3]};a.prototype.readMi8=function(a,b){return a.miUint8Array[b-70254592]};a.prototype.readMi16=function(a,b){var d;d=b-70254592;return a.miUint8Array[d]<<8|a.miUint8Array[d+1]};a.prototype.readMi32=function(a,b){var d;d=b-70254592;return a.miUint8Array[d]<<
24|a.miUint8Array[d+1]<<16|a.miUint8Array[d+2]<<8|a.miUint8Array[d+3]};a.prototype.readVi8=function(a,b){return a.core.interrupts.readVI(b-71303168)};a.prototype.readVi16=function(a,b){return a.core.interrupts.readVI(b-71303168)};a.prototype.readVi32=function(a,b){return a.core.interrupts.readVI(b-71303168)};a.prototype.readAi8=function(a,b){return a.core.interrupts.readAI(b-72351744)};a.prototype.readAi16=function(a,b){return a.core.interrupts.readAI(b-72351744)};a.prototype.readAi32=function(a,
b){return a.core.interrupts.readAI(b-72351744)};a.prototype.readPi8=function(a,b){return a.piUint8Array[b-73400320]};a.prototype.readPi16=function(a,b){var d;d=b-73400320;return a.piUint8Array[d]<<8|a.piUint8Array[d+1]};a.prototype.readPi32=function(a,b){var d;d=b-73400320;return a.piUint8Array[d]<<24|a.piUint8Array[d+1]<<16|a.piUint8Array[d+2]<<8|a.piUint8Array[d+3]};a.prototype.readSi8=function(a,b){return a.core.interrupts.readSI(b-75497472)};a.prototype.readSi16=function(a,b){return a.core.interrupts.readSI(b-
75497472)};a.prototype.readSi32=function(a,b){return a.core.interrupts.readSI(b-75497472)};a.prototype.readC2A1_8=function(a,b){return a.c2a1Uint8Array[b-83886080]};a.prototype.readC2A1_16=function(a,b){var d;d=b-83886080;return a.c2a1Uint8Array[d]<<8|a.c2a1Uint8Array[d+1]};a.prototype.readC2A1_32=function(a,b){var d;d=b-83886080;return a.c2a1Uint8Array[d]<<24|a.c2a1Uint8Array[d+1]<<16|a.c2a1Uint8Array[d+2]<<8|a.c2a1Uint8Array[d+3]};a.prototype.readC1A1_8=function(a,b){return a.c1a1Uint8Array[b-100663296]};
a.prototype.readC1A1_16=function(a,b){var d;d=b-100663296;return a.c1a1Uint8Array[d]<<8|a.c1a1Uint8Array[d+1]};a.prototype.readC1A1_32=function(a,b){var d;d=b-100663296;return a.c1a1Uint8Array[d]<<24|a.c1a1Uint8Array[d+1]<<16|a.c1a1Uint8Array[d+2]<<8|a.c1a1Uint8Array[d+3]};a.prototype.readC2A2_8=function(a,b){return a.c2a2Uint8Array[b-134217728]};a.prototype.readC2A2_16=function(a,b){var d;d=b-134217728;return a.c2a2Uint8Array[d]<<8|a.c2a2Uint8Array[d+1]};a.prototype.readC2A2_32=function(a,b){var d;
d=b-134217728;return a.c2a2Uint8Array[d]<<24|a.c2a2Uint8Array[d+1]<<16|a.c2a2Uint8Array[d+2]<<8|a.c2a2Uint8Array[d+3]};a.prototype.readRom8=function(a,b){return a.romUint8Array[b-268435456]};a.prototype.readRom16=function(a,b){var d;d=b-268435456;return a.romUint8Array[d]<<8|a.romUint8Array[d+1]};a.prototype.readRom32=function(a,b){var d;d=b-268435456;return a.romUint8Array[d]<<24|a.romUint8Array[d+1]<<16|a.romUint8Array[d+2]<<8|a.romUint8Array[d+3]};a.prototype.readC1A3_8=function(a,b){return a.c1a3Uint8Array[b-
533725184]};a.prototype.readC1A3_16=function(a,b){var d;d=b-533725184;return a.c1a3Uint8Array[d]<<8|a.c1a3Uint8Array[d+1]};a.prototype.readC1A3_32=function(a,b){var d;d=b-533725184;return a.c1a3Uint8Array[d]<<24|a.c1a3Uint8Array[d+1]<<16|a.c1a3Uint8Array[d+2]<<8|a.c1a3Uint8Array[d+3]};a.prototype.readRi8=function(a,b){return a.riUint8Array[b-74448896]};a.prototype.readRi16=function(a,b){var d;d=b-74448896;return a.riUint8Array[d]<<8|a.riUint8Array[d+1]};a.prototype.readRi32=function(a,b){var d;d=
b-74448896;return a.riUint8Array[d]<<24|a.riUint8Array[d+1]<<16|a.riUint8Array[d+2]<<8|a.riUint8Array[d+3]};a.prototype.readPif8=function(a,b){return a.pifUint8Array[b-532676608]};a.prototype.readPif16=function(a,b){var d;d=b-532676608;return a.pifUint8Array[d]<<8|a.pifUint8Array[d+1]};a.prototype.readPif32=function(a,b){var d;d=b-532676608;return a.pifUint8Array[d]<<24|a.pifUint8Array[d+1]<<16|a.pifUint8Array[d+2]<<8|a.pifUint8Array[d+3]};a.prototype.readGio8=function(a,b){return a.gioUint8Array[b-
402653184]};a.prototype.readGio16=function(a,b){var d;d=b-402653184;return a.gioUint8Array[d]<<8|a.gioUint8Array[d+1]};a.prototype.readGio32=function(a,b){var d;d=b-402653184;return a.gioUint8Array[d]<<24|a.gioUint8Array[d+1]<<16|a.gioUint8Array[d+2]<<8|a.gioUint8Array[d+3]};a.prototype.writeRdram8=function(a,b,d){a.rdramUint8Array[d-0]=b};a.prototype.writeRdram16=function(a,b,d){d-=0;a.rdramUint8Array[d]=b>>8;a.rdramUint8Array[d+1]=b};a.prototype.writeRdram32=function(a,b,d){d-=0;a.rdramUint8Array[d]=
b>>24;a.rdramUint8Array[d+1]=b>>16;a.rdramUint8Array[d+2]=b>>8;a.rdramUint8Array[d+3]=b};a.prototype.writeSpMem8=function(a,b,d){a.spMemUint8Array[d-67108864]=b};a.prototype.writeSpMem16=function(a,b,d){d-=67108864;a.spMemUint8Array[d]=b>>8;a.spMemUint8Array[d+1]=b};a.prototype.writeSpMem32=function(a,b,d){d-=67108864;a.spMemUint8Array[d]=b>>24;a.spMemUint8Array[d+1]=b>>16;a.spMemUint8Array[d+2]=b>>8;a.spMemUint8Array[d+3]=b};a.prototype.writeRi8=function(a,b,d){a.riUint8Array[d-74448896]=b};a.prototype.writeRi16=
function(a,b,d){d-=74448896;a.riUint8Array[d]=b>>8;a.riUint8Array[d+1]=b};a.prototype.writeRi32=function(a,b,d){d-=74448896;a.riUint8Array[d]=b>>24;a.riUint8Array[d+1]=b>>16;a.riUint8Array[d+2]=b>>8;a.riUint8Array[d+3]=b};a.prototype.writeMi8=function(a,b,d,g,f){a.core.interrupts.writeMI(d-70254592,b,g,f)};a.prototype.writeMi16=function(a,b,d,g,f){a.core.interrupts.writeMI(d-70254592,b,g,f)};a.prototype.writeMi32=function(a,b,d,g,f){a.core.interrupts.writeMI(d-70254592,b,g,f)};a.prototype.writeRamRegs8_8=
function(a,b,d){a.ramRegs8Uint8Array[d-66584576]=b};a.prototype.writeRamRegs8_16=function(a,b,d){d-=66584576;a.ramRegs8Uint8Array[d]=b>>8;a.ramRegs8Uint8Array[d+1]=b};a.prototype.writeRamRegs8_32=function(a,b,d){d-=66584576;a.ramRegs8Uint8Array[d]=b>>24;a.ramRegs8Uint8Array[d+1]=b>>16;a.ramRegs8Uint8Array[d+2]=b>>8;a.ramRegs8Uint8Array[d+3]=b};a.prototype.writeRamRegs4_8=function(a,b,d){a.ramRegs4Uint8Array[d-66076672]=b};a.prototype.writeRamRegs4_16=function(a,b,d){d-=66076672;a.ramRegs4Uint8Array[d]=
b>>8;a.ramRegs4Uint8Array[d+1]=b};a.prototype.writeRamRegs4_32=function(a,b,d){d-=66076672;a.ramRegs4Uint8Array[d]=b>>24;a.ramRegs4Uint8Array[d+1]=b>>16;a.ramRegs4Uint8Array[d+2]=b>>8;a.ramRegs4Uint8Array[d+3]=b};a.prototype.writeRamRegs0_8=function(a,b,d){a.ramRegs0Uint8Array[d-66060288]=b};a.prototype.writeRamRegs0_16=function(a,b,d){d-=66060288;a.ramRegs0Uint8Array[d]=b>>8;a.ramRegs0Uint8Array[d+1]=b};a.prototype.writeRamRegs0_32=function(a,b,d){d-=66060288;a.ramRegs0Uint8Array[d]=b>>24;a.ramRegs0Uint8Array[d+
1]=b>>16;a.ramRegs0Uint8Array[d+2]=b>>8;a.ramRegs0Uint8Array[d+3]=b};a.prototype.writeSpReg1_8=function(a,b,d,g,f){a.core.interrupts.writeSPReg1(d-67371008,b,g,f)};a.prototype.writeSpReg1_16=function(a,b,d,g,f){a.core.interrupts.writeSPReg1(d-67371008,b,g,f)};a.prototype.writeSpReg1_32=function(a,b,d,g,f){a.core.interrupts.writeSPReg1(d-67371008,b,g,f)};a.prototype.writePi8=function(a,b,d,g,f){a.core.interrupts.writePI(d-73400320,b,g,f)};a.prototype.writePi16=function(a,b,d,g,f){a.core.interrupts.writePI(d-
73400320,b,g,f)};a.prototype.writePi32=function(a,b,d,g,f){a.core.interrupts.writePI(d-73400320,b,g,f)};a.prototype.writeSi8=function(a,b,d,g,f){a.core.interrupts.writeSI(d-75497472,b,g,f)};a.prototype.writeSi16=function(a,b,d,g,f){a.core.interrupts.writeSI(d-75497472,b,g,f)};a.prototype.writeSi32=function(a,b,d,g,f){a.core.interrupts.writeSI(d-75497472,b,g,f)};a.prototype.writeAi8=function(a,b,d,g,f){a.core.interrupts.writeAI(d-72351744,b,g,f)};a.prototype.writeAi16=function(a,b,d,g,f){a.core.interrupts.writeAI(d-
72351744,b,g,f)};a.prototype.writeAi32=function(a,b,d,g,f){a.core.interrupts.writeAI(d-72351744,b,g,f)};a.prototype.writeVi8=function(a,b,d,g,f){a.core.interrupts.writeVI(d-71303168,b,g,f)};a.prototype.writeVi16=function(a,b,d,g,f){a.core.interrupts.writeVI(d-71303168,b,g,f)};a.prototype.writeVi32=function(a,b,d,g,f){a.core.interrupts.writeVI(d-71303168,b,g,f)};a.prototype.writeSpReg2_8=function(a,b,d,g,f){a.core.interrupts.writeSPReg2(d-67633152,b,g,f)};a.prototype.writeSpReg2_16=function(a,b,d,
g,f){a.core.interrupts.writeSPReg2(d-67633152,b,g,f)};a.prototype.writeSpReg2_32=function(a,b,d,g,f){a.core.interrupts.writeSPReg2(d-67633152,b,g,f)};a.prototype.writeDpc8=function(a,b,d,g,f){a.core.interrupts.writeDPC(d-68157440,b,g,f)};a.prototype.writeDpc16=function(a,b,d,g,f){a.core.interrupts.writeDPC(d-68157440,b,g,f)};a.prototype.writeDpc32=function(a,b,d,g,f){a.core.interrupts.writeDPC(d-68157440,b,g,f)};a.prototype.writeDps8=function(a,b,d){a.dpsUint8Array[d-69206016]=b};a.prototype.writeDps16=
function(a,b,d){d-=69206016;a.dpsUint8Array[d]=b>>8;a.dpsUint8Array[d+1]=b};a.prototype.writeDps32=function(a,b,d){d-=69206016;a.dpsUint8Array[d]=b>>24;a.dpsUint8Array[d+1]=b>>16;a.dpsUint8Array[d+2]=b>>8;a.dpsUint8Array[d+3]=b};a.prototype.writeC2A1_8=function(a,b,d){a.c2a1Uint8Array[d-83886080]=b};a.prototype.writeC2A1_16=function(a,b,d){d-=83886080;a.c2a1Uint8Array[d]=b>>8;a.c2a1Uint8Array[d+1]=b};a.prototype.writeC2A1_32=function(a,b,d){d-=83886080;a.c2a1Uint8Array[d]=b>>24;a.c2a1Uint8Array[d+
1]=b>>16;a.c2a1Uint8Array[d+2]=b>>8;a.c2a1Uint8Array[d+3]=b};a.prototype.writeC1A1_8=function(a,b,d){a.c1a1Uint8Array[d-100663296]=b};a.prototype.writeC1A1_16=function(a,b,d){d-=100663296;a.c1a1Uint8Array[d]=b>>8;a.c1a1Uint8Array[d+1]=b};a.prototype.writeC1A1_32=function(a,b,d){d-=100663296;a.c1a1Uint8Array[d]=b>>24;a.c1a1Uint8Array[d+1]=b>>16;a.c1a1Uint8Array[d+2]=b>>8;a.c1a1Uint8Array[d+3]=b};a.prototype.writeC2A2_8=function(a,b,d){a.c2a2Uint8Array[d-134217728]=b};a.prototype.writeC2A2_16=function(a,
b,d){d-=134217728;a.c2a2Uint8Array[d]=b>>8;a.c2a2Uint8Array[d+1]=b};a.prototype.writeC2A2_32=function(a,b,d){d-=134217728;a.c2a2Uint8Array[d]=b>>24;a.c2a2Uint8Array[d+1]=b>>16;a.c2a2Uint8Array[d+2]=b>>8;a.c2a2Uint8Array[d+3]=b};a.prototype.writeRom8=function(a,b,d){alert("attempt to overwrite rom!");a.romUint8Array[d-268435456]=b};a.prototype.writeRom16=function(a,b,d){d-=268435456;a.romUint8Array[d]=b>>8;a.romUint8Array[d+1]=b};a.prototype.writeRom32=function(a,b,d){d-=268435456;a.romUint8Array[d]=
b>>24;a.romUint8Array[d+1]=b>>16;a.romUint8Array[d+2]=b>>8;a.romUint8Array[d+3]=b};a.prototype.writeC1A3_8=function(a,b,d){a.c1a3Uint8Array[d-533725184]=b};a.prototype.writeC1A3_16=function(a,b,d){d-=533725184;a.c1a3Uint8Array[d]=b>>8;a.c1a3Uint8Array[d+1]=b};a.prototype.writeC1A3_32=function(a,b,d){d-=533725184;a.c1a3Uint8Array[d]=b>>24;a.c1a3Uint8Array[d+1]=b>>16;a.c1a3Uint8Array[d+2]=b>>8;a.c1a3Uint8Array[d+3]=b};a.prototype.writePif8=function(a,b,d){a.pifUint8Array[d-532676608]=b};a.prototype.writePif16=
function(a,b,d){d-=532676608;a.pifUint8Array[d]=b>>8;a.pifUint8Array[d+1]=b};a.prototype.writePif32=function(a,b,d){d-=532676608;a.pifUint8Array[d]=b>>24;a.pifUint8Array[d+1]=b>>16;a.pifUint8Array[d+2]=b>>8;a.pifUint8Array[d+3]=b};a.prototype.writeGio8=function(a,b,d){a.gioUint8Array[d-402653184]=b};a.prototype.writeGio16=function(a,b,d){d-=402653184;a.gioUint8Array[d]=b>>8;a.gioUint8Array[d+1]=b};a.prototype.writeGio32=function(a,b,d){d-=402653184;a.gioUint8Array[d]=b>>24;a.gioUint8Array[d+1]=b>>
16;a.gioUint8Array[d+2]=b>>8;a.gioUint8Array[d+3]=b};a.prototype.writeDummy8=function(a,b,d){a.dummyReadWriteUint8Array[d&65532]=b};a.prototype.writeDummy16=function(a,b,d){d&=65532;a.dummyReadWriteUint8Array[d]=b>>8;a.dummyReadWriteUint8Array[d+1]=b};a.prototype.writeDummy32=function(a,b,d){d&=65532;a.dummyReadWriteUint8Array[d]=b>>24;a.dummyReadWriteUint8Array[d+1]=b>>16;a.dummyReadWriteUint8Array[d+2]=b>>8;a.dummyReadWriteUint8Array[d+3]=b};a.prototype.virtualToPhysical=function(a){return this.physRegion[a>>>
12]<<16|a&65535};a.prototype.readTLB8=function(a,b){var d;b=a.virtualToPhysical(b);d=a.region[b>>>14];d===a.readTLB8&&(d=a.readDummy8);return d(a,b)};a.prototype.writeTLB8=function(a,b,d,g,f){var h;d=a.virtualToPhysical(d);h=a.writeRegion8[d>>>14];h===a.writeTLB8&&(h=a.writeDummy8);h(a,b,d,g,f)};a.prototype.readTLB16=function(a,b){var d;b=a.virtualToPhysical(b);d=a.region16[b>>>14];d===a.readTLB16&&(d=a.readDummy16);return d(a,b)};a.prototype.writeTLB16=function(a,b,d,g,f){var h;d=a.virtualToPhysical(d);
h=a.writeRegion16[d>>>14];h===a.writeTLB16&&(h=a.writeDummy16);h(a,b,d,g,f)};a.prototype.readTLB32=function(a,b){var d;b=a.virtualToPhysical(b);d=a.region32[b>>>14];d===a.readTLB32&&(d=a.readDummy32);return d(a,b)};a.prototype.writeTLB32=function(a,b,d,g,f){var h;d=a.virtualToPhysical(d);h=a.writeRegion32[d>>>14];h===a.writeTLB32&&(h=a.writeDummy);h(a,b,d,g,f)};a.prototype.initPhysRegions=function(){var a;this.physRegion=new Int16Array(1048576);for(a=0;1048576>a;)this.physRegion[a]=(a&131071)>>>4,
a++};a.prototype.getInt8=function(a,b){return a[b]};a.prototype.getInt16=function(a,b){return a[b]<<8|a[b+1]};a.prototype.getInt32=function(a,b){return a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3]};a.prototype.getUint32=function(a,b){return a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3]};a.prototype.setInt8=function(a,b,d){a[b]=d};a.prototype.setInt32=function(a,b,d){a[b]=d>>24;a[b+1]=d>>16;a[b+2]=d>>8;a[b+3]=d};a.prototype.setInt16=function(a,b,d){a[b]=d>>8;a[b+1]=d};a.prototype.lb=function(a){a=this.virtualToPhysical(a);
return this.region[a>>>14](this,a)};a.prototype.lh=function(a){a=this.virtualToPhysical(a);return this.region16[a>>>14](this,a)};a.prototype.lw=function(a){a=this.virtualToPhysical(a);return this.region32[a>>>14](this,a)};a.prototype.sw=function(a,b,d,g){b=this.virtualToPhysical(b);this.writeRegion32[b>>>14](this,a,b,d,g)};a.prototype.sb=function(a,b,d,g){b=this.virtualToPhysical(b);this.writeRegion8[b>>>14](this,a,b,d,g)};a.prototype.sh=function(a,b,d,g){b=this.virtualToPhysical(b);this.writeRegion16[b>>>
14](this,a,b,d,g)};return a}();("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsMemory=a}).call(this);(function(){C1964jsEmulator.prototype.flushDynaCache=function(){var a;a=void 0;if(!1===this.writeToDom){for(a in this.code)delete this.code[a],this.code[a]&&alert("@code[pc] failed to delete.");delete this.code;this.code={}}else for(;this.kk;)this.kk-=1,this.deleteFunction(this.kk)};C1964jsEmulator.prototype.deleteFunction=function(a){var b;a=document.getElementsByTagName("script")[a];b=a.text.split("_");b=b[1].split("(");b="_"+b[0];a.parentNode.removeChild(a);eval(b+"= function (r, s, t, v){}; delete "+
b+";");window[b]=null;window[b]&&alert("window[fnName] should have been null.")}}).call(this);(function(){var a;a=function(){function a(){}a.prototype.processAudio=function(a,b,d){};return a}();("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsAudio=a}).call(this);(function(){var a,b;a=function(){function a(b,d,c){this.startTime=0;this.memory=b;this.interrupts=d;this.pif=c;this.audio=void 0}a.prototype.copyCartToDram=function(a,b){var c,f,h,k;c=this.memory.getInt32(this.memory.piUint8Array,consts.PI_WR_LEN_REG);h=this.memory.getInt32(this.memory.piUint8Array,consts.PI_DRAM_ADDR_REG);f=this.memory.getInt32(this.memory.piUint8Array,consts.PI_CART_ADDR_REG);log("pi dma write "+(c+1)+" bytes from "+dec2hex(f)+" to "+dec2hex(h));c&=16777215;h&=16777215;k=c;if(0!==
(f&268435456)){f&=268435455;for(f+c+1>this.memory.rom.byteLength&&(k=this.memory.rom.byteLength-f-1);0<=k;)this.memory.rdramUint8Array[h]=this.memory.romUint8Array[f],h++,f++,--k}else for(alert("pi reading from somewhere other than cartridge domain");0<=c--;)this.memory.rdramUint8Array[h]=this.memory.lb(f),f++,h++;this.interrupts.clrFlag(this.memory.piUint8Array,consts.PI_STATUS_REG,consts.PI_STATUS_IO_BUSY|consts.PI_STATUS_DMA_BUSY);this.interrupts.triggerPIInterrupt(a,b)};a.prototype.copySiToDram=
function(a,b){var c,f,h;c=63;h=this.memory.getInt32(this.memory.siUint8Array,consts.SI_DRAM_ADDR_REG);f=this.memory.getInt32(this.memory.siUint8Array,consts.SI_PIF_ADDR_RD64B_REG);if(532678592!==f)throw Error("Unhandled: SI_DRAM_ADDR_RD64B_REG = "+f);log("si dma write "+(c+1)+" bytes from "+dec2hex(f)+" to "+dec2hex(h));c&=16777215;h&=268435455;f&=65535;for(this.pif.processPif();0<=c;)this.memory.rdramUint8Array[h]=this.memory.pifUint8Array[f],h++,f++,--c;this.interrupts.setFlag(this.memory.siUint8Array,
consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT);this.interrupts.triggerSIInterrupt(a,b)};a.prototype.copyDramToAi=function(a,b){var c,f;f=this.memory.getInt32(this.memory.aiUint8Array,consts.AI_LEN_REG);c=this.memory.getInt32(this.memory.aiUint8Array,consts.AI_DRAM_ADDR_REG);f&=16777215;c&=268435455;void 0===this.audio&&(this.audio=new C1964jsAudio);!1===this.audio.processAudio(this.memory,c,f)&&this.interrupts.clrFlag(this.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL);this.interrupts.setFlag(this.memory.aiUint8Array,
consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL)};a.prototype.copyDramToSi=function(a,b){var c,f,h;c=63;h=this.memory.getInt32(this.memory.siUint8Array,consts.SI_PIF_ADDR_WR64B_REG);f=this.memory.getInt32(this.memory.siUint8Array,consts.SI_DRAM_ADDR_REG);if(532678592!==h)throw Error("Unhandled: SI_DRAM_ADDR_RD64B_REG = "+f);log("si dma read "+(c+1)+" bytes from "+dec2hex(f)+" to "+dec2hex(h));c&=16777215;h&=65535;for(f&=268435455;0<=c;)this.memory.pifUint8Array[h]=this.memory.rdramUint8Array[f],h++,
f++,--c;this.interrupts.setFlag(this.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT);this.interrupts.triggerSIInterrupt(a,b)};a.prototype.copySpToDram=function(a,b){alert("todo: copySpToDram")};a.prototype.copyDramToSp=function(a,b){var c,f,h;c=this.memory.getInt32(this.memory.spReg1Uint8Array,consts.SP_RD_LEN_REG);h=this.memory.getInt32(this.memory.spReg1Uint8Array,consts.SP_MEM_ADDR_REG);f=this.memory.getInt32(this.memory.spReg1Uint8Array,consts.SP_DRAM_ADDR_REG);log("sp dma read "+
(c+1)+" bytes from "+dec2hex(f)+" to "+dec2hex(h));c&=4095;h&=8191;for(f&=16777215;0<=c;)this.memory.spMemUint8Array[h]=this.memory.rdramUint8Array[f],h++,f++,--c;this.memory.setInt32(this.memory.spReg1Uint8Array,consts.SP_DMA_BUSY_REG,0);this.memory.getInt32(this.memory.spReg1Uint8Array,consts.SP_STATUS_REG)&(consts.SP_STATUS_DMA_BUSY|consts.SP_STATUS_IO_FULL|consts.SP_STATUS_DMA_FULL)&&alert("hmm..todo: an sp fp status flag is blocking from continuing");this.interrupts.clrFlag(this.memory.spReg1Uint8Array,
consts.SP_STATUS_REG,consts.SP_STATUS_DMA_BUSY);this.interrupts.setFlag(this.memory.spReg1Uint8Array,consts.SP_STATUS_REG,consts.SP_STATUS_HALT)};return a}();b="undefined"!==typeof exports&&null!==exports?exports:this;b.C1964jsDMA=a;b.log=function(a){}}).call(this);(function(){SP_STATUS_HALT=1;SP_STATUS_BROKE=2;SP_STATUS_DMA_BUSY=4;SP_STATUS_DMA_FULL=8;SP_STATUS_IO_FULL=16;SP_STATUS_SSTEP=32;SP_STATUS_INTR_BREAK=64;SP_STATUS_YIELD=128;SP_STATUS_YIELDED=256;SP_STATUS_TASKDONE=512;SP_STATUS_SIG3=1024;SP_STATUS_SIG4=2048;SP_STATUS_SIG5=4096;SP_STATUS_SIG6=8192;SP_STATUS_SIG7=16384;SP_CLR_HALT=1;SP_SET_HALT=2;SP_CLR_BROKE=4;SP_CLR_INTR=8;SP_SET_INTR=16;SP_CLR_SSTEP=32;SP_SET_SSTEP=64;SP_CLR_INTR_BREAK=128;SP_SET_INTR_BREAK=256;SP_CLR_YIELD=512;SP_SET_YIELD=1024;
SP_CLR_YIELDED=2048;SP_SET_YIELDED=4096;SP_CLR_TASKDONE=8192;SP_SET_TASKDONE=16384;SP_CLR_SIG3=32768;SP_SET_SIG3=65536;SP_CLR_SIG4=131072;SP_SET_SIG4=262144;SP_CLR_SIG5=524288;SP_SET_SIG5=1048576;SP_CLR_SIG6=2097152;SP_SET_SIG6=4194304;SP_CLR_SIG7=8388608;SP_SET_SIG7=16777216;var a;a=0;("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsInterrupts=function(b,c){this.setException=function(a,b,g,f){c[consts.CAUSE]|=a;c[consts.CAUSE]|=b};this.processException=function(a,d){if(0===(c[consts.STATUS]&
consts.IE)||0!==(c[consts.STATUS]&consts.EXL))return!1;c[consts.CAUSE]&=4294967171;c[consts.STATUS]|=consts.EXL;!0===d?(c[consts.CAUSE]|=consts.BD,c[consts.EPC]=a-4):(c[consts.CAUSE]&=~consts.BD,c[consts.EPC]=a);0===b.doOnce&&b.flushDynaCache();b.doOnce=1;b.p=2147484032;return!0};this.triggerCompareInterrupt=function(a,b){this.setException(consts.EXC_INT,consts.CAUSE_IP8,a,b)};this.triggerPIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_PI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<
24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_PI)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerSPInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_SP);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+
2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_SP)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerVIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_VI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_VI)&&this.setException(consts.EXC_INT,
consts.CAUSE_IP3,a,d)};this.triggerSIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_SI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_SI)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerAIInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,
consts.MI_INTR_AI);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_AI)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerDPInterrupt=function(a,d){this.setFlag(b.memory.miUint8Array,consts.MI_INTR_REG,consts.MI_INTR_DP);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+
1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&consts.MI_INTR_MASK_DP)&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,a,d)};this.triggerRspBreak=function(){this.setFlag(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,consts.SP_STATUS_TASKDONE|consts.SP_STATUS_BROKE|consts.SP_STATUS_HALT);0!==((b.memory.spReg1Uint8Array[consts.SP_STATUS_REG]<<24|b.memory.spReg1Uint8Array[consts.SP_STATUS_REG+1]<<16|b.memory.spReg1Uint8Array[consts.SP_STATUS_REG+
2]<<8|b.memory.spReg1Uint8Array[consts.SP_STATUS_REG+3])&consts.SP_STATUS_INTR_BREAK)&&this.triggerSPInterrupt(0,!1)};this.clearMIInterrupt=function(a){this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_REG,a);0!==((b.memory.miUint8Array[consts.MI_INTR_MASK_REG]<<24|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+1]<<16|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+2]<<8|b.memory.miUint8Array[consts.MI_INTR_MASK_REG+3])&b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG))&&(c[consts.CAUSE]&=
~consts.CAUSE_IP3)};this.readVI=function(c){switch(c){case consts.VI_CURRENT_REG:if(625===(a+=1))a=0;return(b.memory.getInt32(b.memory.viUint8Array,c)&4294967294)+a|0;default:return b.memory.getInt32(b.memory.viUint8Array,c)}};this.writeVI=function(a,d,c,f){switch(a){case consts.VI_ORIGIN_REG:b.memory.setInt32(b.memory.viUint8Array,a,d);break;case consts.VI_CURRENT_REG:this.clearMIInterrupt(consts.MI_INTR_VI);b.memory.setInt32(b.memory.viUint8Array,a,d);break;case consts.VI_INTR_REG:b.memory.setInt32(b.memory.viUint8Array,
a,d);break;default:b.memory.setInt32(b.memory.viUint8Array,a,d)}};this.writePI=function(a,d,c,f){switch(a){case consts.PI_WR_LEN_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);b.dma.copyCartToDram(c,f);break;case consts.PI_RD_LEN_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);alert("write to PI_RD_LEN_REG");b.dma.copyDramToCart(c,f);break;case consts.PI_DRAM_ADDR_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);break;case consts.PI_CART_ADDR_REG:b.memory.setInt32(b.memory.piUint8Array,a,d);break;
case consts.PI_STATUS_REG:this.writePIStatusReg(d,c,f);break;default:b.memory.setInt32(b.memory.piUint8Array,a,d)}};this.writeSI=function(a,d,c,f){switch(a){case consts.SI_DRAM_ADDR_REG:b.memory.setInt32(b.memory.siUint8Array,a,d);break;case consts.SI_STATUS_REG:this.writeSIStatusReg(d,c,f);break;case consts.SI_PIF_ADDR_RD64B_REG:b.memory.setInt32(b.memory.siUint8Array,a,d);b.dma.copySiToDram(c,f);break;case consts.SI_PIF_ADDR_WR64B_REG:b.memory.setInt32(b.memory.siUint8Array,a,d);b.dma.copyDramToSi(c,
f);break;default:b.memory.setInt32(b.memory.siUint8Array,a,d)}};this.readSI=function(a){switch(a){case consts.SI_STATUS_REG:return this.readSIStatusReg(),b.memory.getInt32(b.memory.siUint8Array,a);default:return b.memory.getInt32(b.memory.siUint8Array,a)}};this.readSIStatusReg=function(){0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_SI)?this.setFlag(b.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT):this.clrFlag(b.memory.siUint8Array,consts.SI_STATUS_REG,
consts.SI_STATUS_INTERRUPT)};this.readAI=function(a){switch(a){case consts.AI_LEN_REG:return b.kfi-=1,0===b.kfi&&(b.kfi=512,this.clrFlag(b.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL)),0;case consts.AI_STATUS_REG:return b.memory.getInt32(b.memory.aiUint8Array,a);default:return b.memory.getInt32(b.memory.aiUint8Array,a)}};this.writeAI=function(a,d,c,f){switch(a){case consts.AI_DRAM_ADDR_REG:b.memory.setInt32(b.memory.aiUint8Array,a,d);break;case consts.AI_LEN_REG:b.memory.setInt32(b.memory.aiUint8Array,
a,d);b.dma.copyDramToAi(c,f);break;case consts.AI_STATUS_REG:this.clearMIInterrupt(consts.MI_INTR_AI);break;case consts.AI_DACRATE_REG:b.memory.setInt32(b.memory.aiUint8Array,a,d);break;case consts.AI_CONTROL_REG:b.memory.setInt32(b.memory.aiUint8Array,a,d&1);break;default:b.memory.setInt32(b.memory.aiUint8Array,a,d)}};this.writeMI=function(a,d,c,f){switch(a){case consts.MI_INIT_MODE_REG:this.writeMIModeReg(d);break;case consts.MI_INTR_MASK_REG:this.writeMIIntrMaskReg(d,c,f);break;case consts.MI_VERSION_REG:case consts.MI_INTR_REG:break;
default:b.memory.setInt32(b.memory.miUint8Array,a,d)}};this.readSPReg1=function(a){var d;switch(a){case consts.SP_STATUS_REG:return b.memory.getInt32(b.memory.spReg1Uint8Array,a);case consts.SP_SEMAPHORE_REG:return d=b.memory.getInt32(b.memory.aiUint8Array,a),b.memory.setInt32(b.memory.spReg1Uint8Array,a,1),d;default:return b.memory.getInt32(b.memory.spReg1Uint8Array,a)}};this.writeSPReg1=function(a,d,c,f){switch(a){case consts.SP_STATUS_REG:this.writeSPStatusReg(d,c,f);break;case consts.SP_SEMAPHORE_REG:b.memory.setInt32(b.memory.spReg1Uint8Array,
a,0);break;case consts.SP_WR_LEN_REG:b.memory.setInt32(b.memory.spReg1Uint8Array,a,d);b.dma.copySpToDram(c,f);break;case consts.SP_RD_LEN_REG:b.memory.setInt32(b.memory.spReg1Uint8Array,a,d);b.dma.copyDramToSp(c,f);break;default:b.memory.setInt32(b.memory.spReg1Uint8Array,a,d)}};this.writeSPReg2=function(a,d,c,f){switch(a){case consts.SP_PC_REG:b.memory.setInt32(b.memory.spReg2Uint8Array,a,d&4092);break;default:b.memory.setInt32(b.memory.spReg2Uint8Array,a,d)}};this.setFlag=function(a,d,c){var f;
f=b.memory.getUint32(a,d);b.memory.setInt32(a,d,f|c)};this.clrFlag=function(a,d,c){var f;f=b.memory.getUint32(a,d);b.memory.setInt32(a,d,f&~c)};this.writeMIModeReg=function(a){a&consts.MI_SET_RDRAM?this.setFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_RDRAM):a&consts.MI_CLR_RDRAM&&this.clrFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_RDRAM);a&consts.MI_SET_INIT?this.setFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_INIT):a&consts.MI_CLR_INIT&&
this.clrFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_INIT);a&consts.MI_SET_EBUS?this.setFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_EBUS):a&consts.MI_CLR_EBUS&&this.clrFlag(b.memory.miUint8Array,consts.MI_INIT_MODE_REG,consts.MI_MODE_EBUS);a&consts.MI_CLR_DP_INTR&&this.clearMIInterrupt(consts.MI_INTR_DP)};this.writeMIIntrMaskReg=function(a,d,c){a&consts.MI_INTR_MASK_SP_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SP):a&consts.MI_INTR_MASK_SP_CLR&&
this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SP);a&consts.MI_INTR_MASK_SI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SI):a&consts.MI_INTR_MASK_SI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_SI);a&consts.MI_INTR_MASK_AI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_AI):a&consts.MI_INTR_MASK_AI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_AI);
a&consts.MI_INTR_MASK_VI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_VI):a&consts.MI_INTR_MASK_VI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_VI);a&consts.MI_INTR_MASK_PI_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_PI):a&consts.MI_INTR_MASK_PI_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_PI);a&consts.MI_INTR_MASK_DP_SET?this.setFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,
consts.MI_INTR_DP):a&consts.MI_INTR_MASK_DP_CLR&&this.clrFlag(b.memory.miUint8Array,consts.MI_INTR_MASK_REG,consts.MI_INTR_DP);0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_MASK_REG)&63&b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG))&&this.setException(consts.EXC_INT,consts.CAUSE_IP3,d,c)};this.writeSIStatusReg=function(a,d,c){this.clrFlag(b.memory.siUint8Array,consts.SI_STATUS_REG,consts.SI_STATUS_INTERRUPT)};this.writeSPStatusReg=function(a,d,c){var f;f=b.memory.getUint32(b.memory.spReg1Uint8Array,
consts.SP_STATUS_REG);a&SP_CLR_BROKE&&(f&=~consts.SP_STATUS_BROKE);a&SP_SET_INTR?this.triggerSPInterrupt(d,c):a&SP_CLR_INTR&&this.clearMIInterrupt(consts.MI_INTR_SP);a&SP_SET_SSTEP?f|=SP_STATUS_SSTEP:a&SP_CLR_SSTEP&&(f&=~SP_STATUS_SSTEP);a&SP_SET_INTR_BREAK?f|=SP_STATUS_INTR_BREAK:a&SP_CLR_INTR_BREAK&&(f&=~SP_STATUS_INTR_BREAK);a&SP_SET_YIELD?f|=SP_STATUS_YIELD:a&SP_CLR_YIELD&&(f&=~SP_STATUS_YIELD);a&SP_SET_YIELDED?f|=SP_STATUS_YIELDED:a&SP_CLR_YIELDED&&(f&=~SP_STATUS_YIELDED);a&SP_SET_TASKDONE?f|=
SP_STATUS_TASKDONE:a&SP_CLR_YIELDED&&(f&=~SP_STATUS_YIELDED);a&SP_SET_SIG3?f|=SP_STATUS_SIG3:a&SP_CLR_SIG3&&(f&=~SP_STATUS_SIG3);a&SP_SET_SIG4?f|=SP_STATUS_SIG4:a&SP_CLR_SIG4&&(f&=~SP_STATUS_SIG4);a&SP_SET_SIG5?f|=SP_STATUS_SIG5:a&SP_CLR_SIG5&&(f&=~SP_STATUS_SIG5);a&SP_SET_SIG6?f|=SP_STATUS_SIG6:a&SP_CLR_SIG6&&(f&=~SP_STATUS_SIG6);a&SP_SET_SIG7?f|=SP_STATUS_SIG7:a&SP_CLR_SIG7&&(f&=~SP_STATUS_SIG7);a&SP_SET_HALT?(f|=SP_STATUS_HALT,b.memory.setInt32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,f)):
a&SP_CLR_HALT&&(0===(f&SP_STATUS_BROKE)?(f&=~SP_STATUS_HALT,b.memory.setInt32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,f),a=b.memory.getUint32(b.memory.spMemUint8Array,consts.SP_DMEM_TASK),this.runSPTask(a)):b.memory.setInt32(b.memory.spReg1Uint8Array,consts.SP_STATUS_REG,f))};this.writeDPCStatusReg=function(a,d,c){a&consts.DPC_CLR_XBUS_DMEM_DMA&&this.clrFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_XBUS_DMEM_DMA);a&consts.DPC_SET_XBUS_DMEM_DMA&&this.setFlag(b.memory.dpcUint8Array,
consts.DPC_STATUS_REG,consts.DPC_STATUS_XBUS_DMEM_DMA);a&consts.DPC_CLR_FREEZE&&this.clrFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FREEZE);a&consts.DPC_SET_FREEZE&&this.setFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FREEZE);a&consts.DPC_CLR_FLUSH&&this.clrFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FLUSH);a&consts.DPC_SET_FLUSH&&this.setFlag(b.memory.dpcUint8Array,consts.DPC_STATUS_REG,consts.DPC_STATUS_FLUSH)};this.writeDPC=
function(a,d,c,f){switch(a){case consts.DPC_STATUS_REG:this.writeDPCStatusReg(d,c,f);break;case consts.DPC_START_REG:b.memory.setInt32(b.memory.dpcUint8Array,a,d);break;case consts.DPC_END_REG:b.memory.setInt32(b.memory.dpcUint8Array,a,d);this.processRDPList();break;case consts.DPC_CLOCK_REG:case consts.DPC_BUFBUSY_REG:case consts.DPC_PIPEBUSY_REG:case consts.DPC_TMEM_REG:break;default:b.memory.setInt32(b.memory.dpcUint8Array,a,d)}};this.writePIStatusReg=function(a,d,c){a&consts.PI_STATUS_CLR_INTR&&
this.clearMIInterrupt(consts.MI_INTR_PI);a&consts.PI_STATUS_RESET&&(b.memory.getUint32(b.memory.piUint8Array,consts.PI_STATUS_REG)&(consts.PI_STATUS_IO_BUSY|consts.PI_STATUS_DMA_BUSY)?(b.memory.setInt32(b.memory.piUint8Array,consts.PI_STATUS_REG,0),this.triggerPIInterrupt(d,c)):b.memory.setInt32(b.memory.piUint8Array,consts.PI_STATUS_REG,0))};this.runSPTask=function(a){switch(a){case consts.GFX_TASK:if(null===b.videoHLE||void 0===b.videoHLE)b.videoHLE=new C1964jsVideoHLE(b,b.webGL.gl);b.settings.wireframe=
document.getElementById("wireframe").checked;!1===b.terminate&&b.videoHLE.processDisplayList();break;case consts.SND_TASK:this.processAudioList();break;case consts.JPG_TASK:this.processJpegTask()}this.checkInterrupts();this.triggerRspBreak()};this.processAudioList=function(){this.clrFlag(b.memory.aiUint8Array,consts.AI_STATUS_REG,consts.AI_STATUS_FIFO_FULL)};this.processJpegTask=function(){};this.processRDPList=function(){};this.checkInterrupts=function(){0!==(b.memory.getUint32(b.memory.miUint8Array,
consts.MI_INTR_REG)&consts.MI_INTR_DP)&&this.triggerDPInterrupt(0,!1);0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_AI)&&this.triggerAIInterrupt(0,!1);0!==(b.memory.getUint32(b.memory.miUint8Array,consts.MI_INTR_REG)&consts.MI_INTR_SI)&&this.triggerSIInterrupt(0,!1);0!==(c[consts.CAUSE]&c[consts.STATUS]&65280)&&this.setException(consts.EXC_INT,0,b.p,!1)};return this}}).call(this);glMatrixArrayType="undefined"!=typeof Float32Array?Float32Array:"undefined"!=typeof WebGLFloatArray?WebGLFloatArray:Array;
var vec3={create:function(a){var b=new glMatrixArrayType(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},add:function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,
b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2],g=Math.sqrt(c*c+e*e+d*d);if(g){if(1==g)return b[0]=c,b[1]=e,b[2]=d,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=e*g;b[2]=d*g;return b},cross:function(a,b,c){c||(c=a);var e=a[0],d=a[1];a=a[2];var g=b[0],f=b[1];b=b[2];c[0]=d*b-a*f;c[1]=a*g-e*b;c[2]=e*f-d*g;return c},length:function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*
a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var e=a[0]-b[0],d=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(e*e+d*d+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=e*b;c[1]=d*b;c[2]=a*b;return c},lerp:function(a,b,c,e){e||(e=a);e[0]=a[0]+c*(b[0]-a[0]);e[1]=a[1]+c*(b[1]-a[1]);e[2]=a[2]+c*(b[2]-a[2]);return e},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"}},mat3={create:function(a){var b=new glMatrixArrayType(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],e=a[2],d=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=e;a[7]=d;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},
toMat4:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},mat4={create:function(a){var b=new glMatrixArrayType(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=
a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],e=a[2],d=a[3],g=a[6],f=a[7],h=a[11];a[1]=a[4];a[2]=
a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=e;a[9]=g;a[11]=a[14];a[12]=d;a[13]=f;a[14]=h;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],e=a[2],d=a[3],g=a[4],f=a[5],h=a[6],k=a[7],m=a[8],l=a[9],n=a[10],p=a[11],q=a[12],r=a[13],t=a[14];a=a[15];return q*l*h*d-m*r*h*d-q*f*n*d+g*r*n*d+m*f*t*d-g*l*t*d-q*l*e*k+m*r*e*k+
q*c*n*k-b*r*n*k-m*c*t*k+b*l*t*k+q*f*e*p-g*r*e*p-q*c*h*p+b*r*h*p+g*c*t*p-b*f*t*p-m*f*e*a+g*l*e*a+m*c*h*a-b*l*h*a-g*c*n*a+b*f*n*a},inverse:function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2],g=a[3],f=a[4],h=a[5],k=a[6],m=a[7],l=a[8],n=a[9],p=a[10],q=a[11],r=a[12],t=a[13],u=a[14],B=a[15],w=c*h-e*f,y=c*k-d*f,x=c*m-g*f,z=e*k-d*h,A=e*m-g*h,C=d*m-g*k,D=l*t-n*r,E=l*u-p*r,F=l*B-q*r,G=n*u-p*t,H=n*B-q*t,I=p*B-q*u,v=1/(w*I-y*H+x*G+z*F-A*E+C*D);b[0]=(h*I-k*H+m*G)*v;b[1]=(-e*I+d*H-g*G)*v;b[2]=(t*C-u*A+B*z)*v;b[3]=
(-n*C+p*A-q*z)*v;b[4]=(-f*I+k*F-m*E)*v;b[5]=(c*I-d*F+g*E)*v;b[6]=(-r*C+u*x-B*y)*v;b[7]=(l*C-p*x+q*y)*v;b[8]=(f*H-h*F+m*D)*v;b[9]=(-c*H+e*F-g*D)*v;b[10]=(r*A-t*x+B*w)*v;b[11]=(-l*A+n*x-q*w)*v;b[12]=(-f*G+h*E-k*D)*v;b[13]=(c*G-e*E+d*D)*v;b[14]=(-r*z+t*y-u*w)*v;b[15]=(l*z-n*y+p*w)*v;return b},toRotationMat:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},
toMat3:function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},toInverseMat3:function(a,b){var c=a[0],e=a[1],d=a[2],g=a[4],f=a[5],h=a[6],k=a[8],m=a[9],l=a[10],n=l*f-h*m,p=-l*g+h*k,q=m*g-f*k,r=c*n+e*p+d*q;if(!r)return null;r=1/r;b||(b=mat3.create());b[0]=n*r;b[1]=(-l*e+d*m)*r;b[2]=(h*e-d*f)*r;b[3]=p*r;b[4]=(l*c-d*k)*r;b[5]=(-h*c+d*g)*r;b[6]=q*r;b[7]=(-m*c+e*k)*r;b[8]=(f*c-e*g)*r;return b},multiply:function(a,b,c){c||(c=
a);var e=a[0],d=a[1],g=a[2],f=a[3],h=a[4],k=a[5],m=a[6],l=a[7],n=a[8],p=a[9],q=a[10],r=a[11],t=a[12],u=a[13],B=a[14];a=a[15];var w=b[0],y=b[1],x=b[2],z=b[3],A=b[4],C=b[5],D=b[6],E=b[7],F=b[8],G=b[9],H=b[10],I=b[11],v=b[12],J=b[13],K=b[14];b=b[15];c[0]=w*e+y*h+x*n+z*t;c[1]=w*d+y*k+x*p+z*u;c[2]=w*g+y*m+x*q+z*B;c[3]=w*f+y*l+x*r+z*a;c[4]=A*e+C*h+D*n+E*t;c[5]=A*d+C*k+D*p+E*u;c[6]=A*g+C*m+D*q+E*B;c[7]=A*f+C*l+D*r+E*a;c[8]=F*e+G*h+H*n+I*t;c[9]=F*d+G*k+H*p+I*u;c[10]=F*g+G*m+H*q+I*B;c[11]=F*f+G*l+H*r+I*a;
c[12]=v*e+J*h+K*n+b*t;c[13]=v*d+J*k+K*p+b*u;c[14]=v*g+J*m+K*q+b*B;c[15]=v*f+J*l+K*r+b*a;return c},multiplyVec3:function(a,b,c){c||(c=b);var e=b[0],d=b[1];b=b[2];c[0]=a[0]*e+a[4]*d+a[8]*b+a[12];c[1]=a[1]*e+a[5]*d+a[9]*b+a[13];c[2]=a[2]*e+a[6]*d+a[10]*b+a[14];return c},multiplyVec4:function(a,b,c){c||(c=b);var e=b[0],d=b[1],g=b[2];b=b[3];c[0]=a[0]*e+a[4]*d+a[8]*g+a[12]*b;c[1]=a[1]*e+a[5]*d+a[9]*g+a[13]*b;c[2]=a[2]*e+a[6]*d+a[10]*g+a[14]*b;c[3]=a[3]*e+a[7]*d+a[11]*g+a[15]*b;return c},translate:function(a,
b,c){var e=b[0],d=b[1];b=b[2];if(!c||a==c)return a[12]=a[0]*e+a[4]*d+a[8]*b+a[12],a[13]=a[1]*e+a[5]*d+a[9]*b+a[13],a[14]=a[2]*e+a[6]*d+a[10]*b+a[14],a[15]=a[3]*e+a[7]*d+a[11]*b+a[15],a;var g=a[0],f=a[1],h=a[2],k=a[3],m=a[4],l=a[5],n=a[6],p=a[7],q=a[8],r=a[9],t=a[10],u=a[11];c[0]=g;c[1]=f;c[2]=h;c[3]=k;c[4]=m;c[5]=l;c[6]=n;c[7]=p;c[8]=q;c[9]=r;c[10]=t;c[11]=u;c[12]=g*e+m*d+q*b+a[12];c[13]=f*e+l*d+r*b+a[13];c[14]=h*e+n*d+t*b+a[14];c[15]=k*e+p*d+u*b+a[15];return c},scale:function(a,b,c){var e=b[0],d=
b[1];b=b[2];if(!c||a==c)return a[0]*=e,a[1]*=e,a[2]*=e,a[3]*=e,a[4]*=d,a[5]*=d,a[6]*=d,a[7]*=d,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*e;c[1]=a[1]*e;c[2]=a[2]*e;c[3]=a[3]*e;c[4]=a[4]*d;c[5]=a[5]*d;c[6]=a[6]*d;c[7]=a[7]*d;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},rotate:function(a,b,c,e){var d=c[0],g=c[1];c=c[2];var f=Math.sqrt(d*d+g*g+c*c);if(!f)return null;1!=f&&(f=1/f,d*=f,g*=f,c*=f);var h=Math.sin(b),k=Math.cos(b),m=1-k;
b=a[0];var f=a[1],l=a[2],n=a[3],p=a[4],q=a[5],r=a[6],t=a[7],u=a[8],B=a[9],w=a[10],y=a[11],x=d*d*m+k,z=g*d*m+c*h,A=c*d*m-g*h,C=d*g*m-c*h,D=g*g*m+k,E=c*g*m+d*h,F=d*c*m+g*h,d=g*c*m-d*h,g=c*c*m+k;e?a!=e&&(e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15]):e=a;e[0]=b*x+p*z+u*A;e[1]=f*x+q*z+B*A;e[2]=l*x+r*z+w*A;e[3]=n*x+t*z+y*A;e[4]=b*C+p*D+u*E;e[5]=f*C+q*D+B*E;e[6]=l*C+r*D+w*E;e[7]=n*C+t*D+y*E;e[8]=b*F+p*d+u*g;e[9]=f*F+q*d+B*g;e[10]=l*F+r*d+w*g;e[11]=n*F+t*d+y*g;return e},rotateX:function(a,b,c){var e=Math.sin(b);
b=Math.cos(b);var d=a[4],g=a[5],f=a[6],h=a[7],k=a[8],m=a[9],l=a[10],n=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=d*b+k*e;c[5]=g*b+m*e;c[6]=f*b+l*e;c[7]=h*b+n*e;c[8]=d*-e+k*b;c[9]=g*-e+m*b;c[10]=f*-e+l*b;c[11]=h*-e+n*b;return c},rotateY:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=a[0],g=a[1],f=a[2],h=a[3],k=a[8],m=a[9],l=a[10],n=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],
c[15]=a[15]):c=a;c[0]=d*b+k*-e;c[1]=g*b+m*-e;c[2]=f*b+l*-e;c[3]=h*b+n*-e;c[8]=d*e+k*b;c[9]=g*e+m*b;c[10]=f*e+l*b;c[11]=h*e+n*b;return c},rotateZ:function(a,b,c){var e=Math.sin(b);b=Math.cos(b);var d=a[0],g=a[1],f=a[2],h=a[3],k=a[4],m=a[5],l=a[6],n=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=d*b+k*e;c[1]=g*b+m*e;c[2]=f*b+l*e;c[3]=h*b+n*e;c[4]=d*-e+k*b;c[5]=g*-e+m*b;c[6]=f*-e+l*b;c[7]=h*-e+n*b;return c},frustum:function(a,b,c,e,
d,g,f){f||(f=mat4.create());var h=b-a,k=e-c,m=g-d;f[0]=2*d/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*d/k;f[6]=0;f[7]=0;f[8]=(b+a)/h;f[9]=(e+c)/k;f[10]=-(g+d)/m;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(2*g*d)/m;f[15]=0;return f},perspective:function(a,b,c,e,d){a=c*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a,a,c,e,d)},ortho:function(a,b,c,e,d,g,f){f||(f=mat4.create());var h=b-a,k=e-c,m=g-d;f[0]=2/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/k;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/m;f[11]=0;f[12]=-(a+b)/h;f[13]=
-(e+c)/k;f[14]=-(g+d)/m;f[15]=1;return f},lookAt:function(a,b,c,e){e||(e=mat4.create());var d=a[0],g=a[1];a=a[2];var f=c[0],h=c[1],k=c[2];c=b[1];var m=b[2];if(d==b[0]&&g==c&&a==m)return mat4.identity(e);var l,n,p,q;c=d-b[0];m=g-b[1];b=a-b[2];q=1/Math.sqrt(c*c+m*m+b*b);c*=q;m*=q;b*=q;l=h*b-k*m;k=k*c-f*b;f=f*m-h*c;(q=Math.sqrt(l*l+k*k+f*f))?(q=1/q,l*=q,k*=q,f*=q):f=k=l=0;h=m*f-b*k;n=b*l-c*f;p=c*k-m*l;(q=Math.sqrt(h*h+n*n+p*p))?(q=1/q,h*=q,n*=q,p*=q):p=n=h=0;e[0]=l;e[1]=h;e[2]=c;e[3]=0;e[4]=k;e[5]=n;
e[6]=m;e[7]=0;e[8]=f;e[9]=p;e[10]=b;e[11]=0;e[12]=-(l*d+k*g+f*a);e[13]=-(h*d+n*g+p*a);e[14]=-(c*d+m*g+b*a);e[15]=1;return e},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}};
quat4={create:function(a){var b=new glMatrixArrayType(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},calculateW:function(a,b){var c=a[0],e=a[1],d=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-e*e-d*d)),a;b[0]=c;b[1]=e;b[2]=d;b[3]=-Math.sqrt(Math.abs(1-c*c-e*e-d*d));return b},inverse:function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b},length:function(a){var b=
a[0],c=a[1],e=a[2];a=a[3];return Math.sqrt(b*b+c*c+e*e+a*a)},normalize:function(a,b){b||(b=a);var c=a[0],e=a[1],d=a[2],g=a[3],f=Math.sqrt(c*c+e*e+d*d+g*g);if(0==f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=c*f;b[1]=e*f;b[2]=d*f;b[3]=g*f;return b},multiply:function(a,b,c){c||(c=a);var e=a[0],d=a[1],g=a[2];a=a[3];var f=b[0],h=b[1],k=b[2];b=b[3];c[0]=e*b+a*f+d*k-g*h;c[1]=d*b+a*h+g*f-e*k;c[2]=g*b+a*k+e*h-d*f;c[3]=a*b-e*f-d*h-g*k;return c},multiplyVec3:function(a,b,c){c||(c=b);var e=b[0],d=b[1],g=
b[2];b=a[0];var f=a[1],h=a[2];a=a[3];var k=a*e+f*g-h*d,m=a*d+h*e-b*g,l=a*g+b*d-f*e,e=-b*e-f*d-h*g;c[0]=k*a+e*-b+m*-h-l*-f;c[1]=m*a+e*-f+l*-b-k*-h;c[2]=l*a+e*-h+k*-f-m*-b;return c},toMat3:function(a,b){b||(b=mat3.create());var c=a[0],e=a[1],d=a[2],g=a[3],f=c+c,h=e+e,k=d+d,m=c*f,l=c*h,c=c*k,n=e*h,e=e*k,d=d*k,f=g*f,h=g*h,g=g*k;b[0]=1-(n+d);b[1]=l-g;b[2]=c+h;b[3]=l+g;b[4]=1-(m+d);b[5]=e-f;b[6]=c-h;b[7]=e+f;b[8]=1-(m+n);return b},toMat4:function(a,b){b||(b=mat4.create());var c=a[0],e=a[1],d=a[2],g=a[3],
f=c+c,h=e+e,k=d+d,m=c*f,l=c*h,c=c*k,n=e*h,e=e*k,d=d*k,f=g*f,h=g*h,g=g*k;b[0]=1-(n+d);b[1]=l-g;b[2]=c+h;b[3]=0;b[4]=l+g;b[5]=1-(m+d);b[6]=e-f;b[7]=0;b[8]=c-h;b[9]=e+f;b[10]=1-(m+n);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},slerp:function(a,b,c,e){e||(e=a);var d=c;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(d=-1*c);e[0]=1-c*a[0]+d*b[0];e[1]=1-c*a[1]+d*b[1];e[2]=1-c*a[2]+d*b[2];e[3]=1-c*a[3]+d*b[3];return e},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};WebGLUtils=function(){var a=function(a,c){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],d=null,g=0;g<e.length;++g){try{d=a.getContext(e[g],c)}catch(f){}if(d)break}return d};return{create3DContext:a,setupWebGL:function(b,c){function e(a){var d=b.parentNode;d&&(d.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+a+"</div></div></td></tr></table>")}if(!window.WebGLRenderingContext)return e('This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>'),
null;var d=a(b,c);d||e('It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>');return d}}}();window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return window.setTimeout(a,1E3/60)}}();
window.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout}();(function(){("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsRenderer=function(a,b,c){var e,d,g,f,h;this.videoHLE=g=h=f=void 0;e=[0,8,16,24,33,41,49,57,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,198,206,214,222,231,239,247,255];this.textureCache={};this.texRect=function(a,b,c,e,f,g,h,t,u,B,w){var y,x,z,A;this.videoHLE=w;x=w.pow2roundup(u.width);y=w.pow2roundup(u.height);A=u.width/x;z=u.height/y;y=f/u.height;x=g/u.width;f=(f+(c-a)*h)/u.width*A;g=(g+(e-b)*t)/u.height*
z;d((a-160)/160,-(b-120)/120,(c-160)/160,-(e-120)/120,y,x,f,g,w);this.draw(u,B,w)};this.formatTexture=function(a,b,d,c){var f,g,h,t,u;this.useTextureCache=!0;if(!0===this.useTextureCache&&(g=c*d,g=b[g]>>>0<<24|b[g+d+1]>>>0<<16|b[g+2*d+1]>>>0<<8|b[g+3*d+1]>>>0,null!=this.textureCache[g]))return this.textureCache[g];c=new ArrayBuffer(4*c*d);c=new Uint8Array(c);!0===this.useTextureCache&&(this.textureCache[g]=c);switch(a.fmt){case 0:switch(a.siz){case 2:u=a.width;for(t=0;t<a.height;){for(h=0;h<a.width;)f=
2*t*u+2*h,g=4*t*d+4*h,f=b[f]<<8|b[f+1],c[g]=e[f>>11&31],c[g+1]=e[f>>6&31],c[g+2]=e[f>>1&31],c[g+3]=f&0?0:255,h++;t++}}}return c};d=function(a,d,c,e,p,q,r,t,u){a=[c,e,0,c,d,0,a,d,0,a,e,0];f=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,f);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.DYNAMIC_DRAW);f.itemSize=3;f.numItems=4;p=[r,t,r,q,p,q,p,t];h=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,h);b.bufferData(b.ARRAY_BUFFER,new Float32Array(p),b.STATIC_DRAW);h.itemSize=2;h.numItems=4;g=b.createBuffer();
b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),b.STATIC_DRAW);g.itemSize=1;g.numItems=6};this.draw=function(d,e,l){var n,p;b.useProgram(c.shaderProgram);b.disable(b.DEPTH_TEST);b.enable(b.BLEND);b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA);b.enableVertexAttribArray(c.shaderProgram.vertexPositionAttribute);b.bindBuffer(b.ARRAY_BUFFER,f);b.vertexAttribPointer(c.shaderProgram.vertexPositionAttribute,f.itemSize,b.FLOAT,!1,0,0);b.enableVertexAttribArray(c.shaderProgram.textureCoordAttribute);
b.bindBuffer(b.ARRAY_BUFFER,h);b.vertexAttribPointer(c.shaderProgram.textureCoordAttribute,h.itemSize,b.FLOAT,!1,0,0);p=l.pow2roundup(d.width);n=l.pow2roundup(d.height);e=this.formatTexture(d,e,p,n);void 0!==e&&(d=b.createTexture(),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,d),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,p,n,0,b.RGBA,b.UNSIGNED_BYTE,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.uniform1i(c.shaderProgram.samplerUniform,
d),0<l.primColor.length&&b.uniform4fv(c.shaderProgram.uPrimColor,l.primColor),0<l.fillColor.length&&b.uniform4fv(c.shaderProgram.uFillColor,l.fillColor),0<l.blendColor.length&&b.uniform4fv(c.shaderProgram.uBlendColor,l.blendColor),0<l.envColor.length&&b.uniform4fv(c.shaderProgram.uEnvColor,l.envColor),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,g),c.setMatrixUniforms(c.shaderProgram),c.setCombineUniforms(c.shaderProgram),b.uniform1i(c.shaderProgram.wireframeUniform,a.wireframe?1:0),!0===a.wireframe?b.drawElements(b.LINE_LOOP,
g.numItems,b.UNSIGNED_SHORT,0):b.drawElements(b.TRIANGLES,g.numItems,b.UNSIGNED_SHORT,0))};return this}}).call(this);(function(){var a;a=function(a,c){var e;this.processDisplayList=this.callBind(this.processDisplayList,this);this.core=a;this.gl=c;this.RICE_MATRIX_STACK=60;this.MAX_TEXTURES=8;this.MAX_VERTICES=80;this.MAX_TILES=8;this.tmem=new Uint8Array(4096);this.activeTile=0;this.textureTile=[];this.N64VertexList=[];this.vtxTransformed=[];this.vtxNonTransformed=[];this.vecProjected=[];this.vtxProjected5=[];this.geometryMode=0;this.gRSP={};this.matToLoad=mat4.create();this.gRSPworldProject=mat4.create();this.triangleVertexColorBuffer=
this.triangleVertexPositionBuffer=void 0;this.dlistStackPointer=0;this.dlistStack=[];this.renderer=new C1964jsRenderer(this.core.settings,this.core.webGL.gl,this.core.webGL);this.texImg={};this.segments=[];this.primColor=[];this.fillColor=[];this.blendColor=[];this.envColor=[];this.triVertices=new Float32Array(16384);this.triColorVertices=new Uint8Array(16384);this.triTextureCoords=new Float32Array(16384);this.otherModeH=this.otherModeL=0;this.currentMicrocodeMap=this.microcodeMap0;for(e=0;e<this.MAX_TILES;)this.textureTile[e]=
[],e+=1;for(e=0;e<this.MAX_VERTICES;)this.N64VertexList[e]={},e+=1;for(e=0;e<consts.MAX_DL_STACK_SIZE;)this.dlistStack[e]={},e+=1;for(e=0;e<this.segments.length;)this.segments[e]=0,e+=1;this.gRSP.projectionMtxs=[];this.gRSP.modelviewMtxs=[];for(e=0;e<this.RICE_MATRIX_STACK;)this.gRSP.projectionMtxs[e]=mat4.create(),this.gRSP.modelviewMtxs[e]=mat4.create(),e+=1;this.gRSP.vertexMult=10;this.triangleVertexTextureCoordBuffer=void 0;return this};(function(){a.prototype.callBind=function(a,c){return function(){return a.call(c)}};
a.prototype.processDisplayList=function(){!0===this.core.showFB&&(this.initBuffers(),this.core.webGL.show3D(),this.core.showFB=!1,this.resetState());this.core.webGL.beginDList();this.dlParserProcess();return this.core.interrupts.triggerSPInterrupt(0,!1)};a.prototype.videoLog=function(a){};a.prototype.dlParserProcess=function(){var a,c;this.dlistStackPointer=0;this.dlistStack[this.dlistStackPointer].pc=this.core.memory.getInt32(this.core.memory.spMemUint8Array,consts.TASK_DATA_PTR);this.dlistStack[this.dlistStackPointer].countdown=
consts.MAX_DL_COUNT;for(this.renderReset();0<=this.dlistStackPointer;)c=this.dlistStack[this.dlistStackPointer].pc,a=this.getCommand(c),a=this.currentMicrocodeMap[a],this.dlistStack[this.dlistStackPointer].pc+=8,this[a](c),0<=this.dlistStackPointer&&(this.dlistStack[this.dlistStackPointer].countdown-=1,0>this.dlistStack[this.dlistStackPointer].countdown&&(this.dlistStackPointer-=1));this.videoLog("finished dlist");this.core.interrupts.triggerSPInterrupt(0,!1)};a.prototype.RDP_GFX_PopDL=function(){this.dlistStackPointer-=
1};a.prototype.RSP_RDP_Nothing=function(a){this.videoLog("RSP RDP NOTHING");this.dlistStackPointer-=1};a.prototype.RSP_GBI1_MoveMem=function(a){var c,e;e=this.getGbi1Type(a);c=this.getGbi1Length(a);a=this.getGbi1RspSegmentAddr(a);this.videoLog("movemem type="+e+", length="+c+" addr="+a)};a.prototype.RSP_GBI1_SpNoop=function(a){this.videoLog("RSP_GBI1_SpNoop")};a.prototype.RSP_GBI1_Reserved=function(a){this.videoLog("RSP_GBI1_Reserved")};a.prototype.setProjection=function(a,c,e){c?(this.gRSP.projectionMtxTop<
this.RICE_MATRIX_STACK-1&&(this.gRSP.projectionMtxTop+=1),e?mat4.set(a,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]):mat4.multiply(this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop-1],a,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop])):e?mat4.set(a,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]):mat4.multiply(this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop],a,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]);this.gRSP.bMatrixIsUpdated=!0};a.prototype.setWorldView=function(a,
c,e){!0===c?(this.gRSP.modelViewMtxTop<this.RICE_MATRIX_STACK-1&&(this.gRSP.modelViewMtxTop+=1),e?mat4.set(a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]):mat4.multiply(this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop-1],a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop])):e?mat4.set(a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]):mat4.multiply(this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop],a,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]);this.gRSP.bMatrixIsUpdated=!0};a.prototype.RSP_GBI0_Mtx=
function(a){var c;c=this.getGbi0DlistAddr(a);c=this.getRspSegmentAddr(c);this.videoLog("RSP_GBI0_Mtx addr: "+dec2hex(c));this.loadMatrix(c);this.gbi0isProjectionMatrix(a)?this.setProjection(this.matToLoad,this.gbi0PushMatrix(a),this.gbi0LoadMatrix(a)):this.setWorldView(this.matToLoad,this.gbi0PushMatrix(a),this.gbi0LoadMatrix(a))};a.prototype.loadMatrix=function(a){var c,e,d,g,f;for(d=f=0;4>d;){for(g=0;4>g;)c=a+(d<<3)+(g<<1),e=(this.core.memory.rdramUint8Array[c]<<8|this.core.memory.rdramUint8Array[c+
1])<<16>>16,c=(this.core.memory.rdramUint8Array[c+32]<<8|this.core.memory.rdramUint8Array[c+32+1])&65535,this.matToLoad[f]=(e<<16|c)/65536,f+=1,g+=1;d+=1}};a.prototype.DLParser_SetTImg=function(a){this.texImg.format=this.getTImgFormat(a);this.texImg.size=this.getTImgSize(a);this.texImg.width=this.getTImgWidth(a)+1;this.texImg.addr=this.getTImgAddr(a);this.texImg.bpl=this.texImg.width<<this.texImg.size>>1;this.texImg.changed=!0};a.prototype.RSP_GBI0_Vtx=function(a){var c,e;c=this.getGbi0NumVertices(a)+
1;e=this.getGbi0Vertex0(a);a=this.getGbi0DlistAddr(a);a=this.getRspSegmentAddr(a);80<e+c&&(c=32-e);this.processVertexData(a,e,c)};a.prototype.updateCombinedMatrix=function(){var a,c;this.gRSP.bMatrixIsUpdated&&(c=this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop],a=this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop],mat4.multiply(a,c,this.gRSPworldProject),this.gRSP.bMatrixIsUpdated=!1,this.gRSP.bCombinedMatrixIsUpdated=!0);this.gRSP.bCombinedMatrixIsUpdated=!1};a.prototype.processVertexData=function(a,
c,e){var d,g,f,h;this.updateCombinedMatrix();for(g=c;g<c+e;)d=a+16*(g-c),this.N64VertexList[g].x=this.getVertexX(d),this.N64VertexList[g].y=this.getVertexY(d),this.N64VertexList[g].z=this.getVertexZ(d),h=this.textureTile[this.activeTile].width,f=this.textureTile[this.activeTile].height,this.N64VertexList[g].s=this.getVertexS(d)/32/h,this.N64VertexList[g].t=this.getVertexT(d)/32/f,this.N64VertexList[g].r=this.getVertexColorR(d),this.N64VertexList[g].g=this.getVertexColorG(d),this.N64VertexList[g].b=
this.getVertexColorB(d),this.N64VertexList[g].a=this.getVertexAlpha(d),this.N64VertexList[g].nx=this.toSByte(this.getVertexNormalX(d)),this.N64VertexList[g].ny=this.toSByte(this.getVertexNormalY(d)),this.N64VertexList[g].nz=this.toSByte(this.getVertexNormalZ(d)),g+=1};a.prototype.DLParser_SetCImg=function(a){this.videoLog("TODO: DLParser_SetCImg")};a.prototype.RSP_GBI0_DL=function(a){var c;c=this.getGbi0DlistAddr(a);c=this.getRspSegmentAddr(c);this.videoLog("dlist address = "+dec2hex(c));this.getGbi0DlistParam(a)===
consts.RSP_DLIST_PUSH&&(this.dlistStackPointer+=1);this.dlistStack[this.dlistStackPointer].pc=c;this.dlistStack[this.dlistStackPointer].countdown=consts.MAX_DL_COUNT};a.prototype.DLParser_SetCombine=function(a){this.combineA0=this.getCombineA0(a);this.combineB0=this.getCombineB0(a);this.combineC0=this.getCombineC0(a);this.combineD0=this.getCombineD0(a);this.combineA0a=this.getCombineA0a(a);this.combineB0a=this.getCombineB0a(a);this.combineC0a=this.getCombineC0a(a);this.combineD0a=this.getCombineD0a(a);
this.combineA1=this.getCombineA1(a);this.combineB1=this.getCombineB1(a);this.combineC1=this.getCombineC1(a);this.combineD1=this.getCombineD1(a);this.combineA1a=this.getCombineA1a(a);this.combineB1a=this.getCombineB1a(a);this.combineC1a=this.getCombineC1a(a);this.combineD1a=this.getCombineD1a(a)};a.prototype.RSP_GBI1_MoveWord=function(a){var c;this.videoLog("RSP_GBI1_MoveWord");switch(this.getGbi0MoveWordType(a)){case consts.RSP_MOVE_WORD_MATRIX:this.RSP_RDP_InsertMatrix();break;case consts.RSP_MOVE_WORD_SEGMENT:c=
this.getGbi0MoveWordOffset(a)>>2&15,a=this.getGbi0MoveWordValue(a)&16777215,this.segments[c]=a}};a.prototype.renderReset=function(){this.resetMatrices();this.gRSP.numVertices=0;this.gRSP.curTile=0;this.gRSP.fTexScaleX=0.03125;this.gRSP.fTexScaleY=0.03125};a.prototype.resetMatrices=function(){this.gRSP.projectionMtxTop=0;this.gRSP.modelViewMtxTop=0;this.gRSP.projectionMtxs[0]=mat4.create();this.gRSP.modelviewMtxs[0]=mat4.create();mat4.identity(this.gRSP.modelviewMtxs[0]);mat4.identity(this.gRSP.projectionMtxs[0]);
this.gRSP.bMatrixIsUpdated=!0;this.updateCombinedMatrix()};a.prototype.RSP_RDP_InsertMatrix=function(){this.updateCombinedMatrix();this.gRSP.bMatrixIsUpdated=!1;this.gRSP.bCombinedMatrixIsUpdated=!0};a.prototype.DLParser_SetScissor=function(a){this.videoLog("TODO: DLParser_SetScissor")};a.prototype.RSP_GBI1_SetOtherModeH=function(a){this.otherModeH=this.getOtherModeH()};a.prototype.RSP_GBI1_SetOtherModeL=function(a){this.videoLog("TODO: DLParser_GBI1_SetOtherModeL");this.otherModeL=this.getOtherModeL()};
a.prototype.RSP_GBI0_Sprite2DBase=function(a){this.videoLog("TODO: RSP_GBI0_Sprite2DBase")};a.prototype.RSP_GBI0_Tri4=function(a){this.videoLog("TODO: RSP_GBI0_Tri4")};a.prototype.RSP_GBI1_RDPHalf_Cont=function(a){this.videoLog("TODO: RSP_GBI1_RDPHalf_Cont")};a.prototype.RSP_GBI1_RDPHalf_2=function(a){this.videoLog("TODO: RSP_GBI1_RDPHalf_2")};a.prototype.RSP_GBI1_RDPHalf_1=function(a){this.videoLog("TODO: RSP_GBI1_RDPHalf_1")};a.prototype.RSP_GBI1_Line3D=function(a){this.videoLog("TODO: RSP_GBI1_Line3D")};
a.prototype.RSP_GBI1_ClearGeometryMode=function(a){a=this.getClearGeometryMode(a);this.geometryMode&=~a};a.prototype.RSP_GBI1_SetGeometryMode=function(a){a=this.getSetGeometryMode(a);this.geometryMode|=a};a.prototype.RSP_GBI1_EndDL=function(a){this.videoLog("RSP_GBI1_EndDL");this.RDP_GFX_PopDL();this.drawScene(!1,7)};a.prototype.RSP_GBI1_Texture=function(a){var c;c=this.getTextureTile(a);this.textureTile[c].on=this.getTextureOn(a);this.textureTile[c].level=this.getTextureLevel(a);this.textureTile[c].scales=
this.getTextureScaleS(a)/32768;this.textureTile[c].scalet=this.getTextureScaleT(a)/32768};a.prototype.RSP_GBI1_PopMtx=function(a){this.videoLog("TODO: RSP_GBI1_PopMtx")};a.prototype.RSP_GBI1_CullDL=function(a){this.videoLog("TODO: RSP_GBI1_CullDL")};a.prototype.RSP_GBI1_Tri1=function(a){var c,e,d;c=this.getGbi0Tri1V0(a)/this.gRSP.vertexMult;e=this.getGbi0Tri1V1(a)/this.gRSP.vertexMult;d=this.getGbi0Tri1V2(a)/this.gRSP.vertexMult;this.getGbi0Tri1Flag(a);!1!==this.prepareTriangle(c,e,d)&&this.getCommand(a+
8)};a.prototype.RSP_GBI1_Noop=function(a){this.videoLog("TODO: RSP_GBI1_Noop")};a.prototype.RDP_TriFill=function(a){this.videoLog("TODO: RDP_TriFill")};a.prototype.RDP_TriFillZ=function(a){this.videoLog("RDP_TriFillZ")};a.prototype.RDP_TriTxtr=function(a){this.videoLog("TODO: RDP_TriTxtr")};a.prototype.RDP_TriTxtrZ=function(a){this.videoLog("TODO: RDP_TriTxtrZ")};a.prototype.RDP_TriShade=function(a){this.videoLog("TODO: RDP_TriShade")};a.prototype.RDP_TriShadeZ=function(a){this.videoLog("TODO: RDP_TriShadeZ")};
a.prototype.RDP_TriShadeTxtr=function(a){this.videoLog("TODO: RDP_TriShadeTxtr")};a.prototype.RDP_TriShadeTxtrZ=function(a){this.videoLog("TODO: RDP_TriShadeTxtrZ")};a.prototype.DLParser_TexRect=function(a){var c,e,d,g,f,h,k,m;f=this.getTexRectXh(a)/4;k=this.getTexRectYh(a)/4;g=this.getTexRectTileNo(a);h=this.getTexRectXl(a)/4;m=this.getTexRectYl(a)/4;e=this.getTexRectS(a)/32;d=this.getTexRectT(a)/32;c=this.getTexRectDsDx(a)/1024;a=this.getTexRectDtDy(a)/1024;this.renderer.texRect(h,m,f,k,e,d,c,a,
this.textureTile[g],this.tmem,this);this.dlistStack[this.dlistStackPointer].pc+=8;this.hasTexture=!0};a.prototype.DLParser_TexRectFlip=function(a){this.dlistStack[this.dlistStackPointer].pc+=8;this.videoLog("TODO: DLParser_TexRectFlip")};a.prototype.DLParser_RDPLoadSynch=function(a){this.videoLog("TODO: DLParser_RDPLoadSynch")};a.prototype.DLParser_RDPPipeSynch=function(a){this.videoLog("TODO: DLParser_RDPPipeSynch")};a.prototype.DLParser_RDPTileSynch=function(a){this.videoLog("TODO: DLParser_RDPTileSynch")};
a.prototype.DLParser_RDPFullSynch=function(a){this.videoLog("TODO: DLParser_RDPFullSynch");this.core.interrupts.triggerDPInterrupt(0,!1)};a.prototype.DLParser_SetKeyGB=function(a){this.videoLog("TODO: DLParser_SetKeyGB")};a.prototype.DLParser_SetKeyR=function(a){this.videoLog("TODO: DLParser_SetKeyR")};a.prototype.DLParser_SetConvert=function(a){this.videoLog("TODO: DLParser_SetConvert")};a.prototype.DLParser_SetPrimDepth=function(a){this.videoLog("TODO: DLParser_SetPrimDepth")};a.prototype.DLParser_RDPSetOtherMode=
function(a){this.videoLog("TODO: DLParser_RDPSetOtherMode")};a.prototype.DLParser_LoadTLut=function(a){this.videoLog("TODO: DLParser_LoadTLut")};a.prototype.DLParser_SetTileSize=function(a){var c;c=this.getSetTileSizeTile(a);this.textureTile[c].uls=this.getSetTileSizeUls(a);this.textureTile[c].ult=this.getSetTileSizeUlt(a);this.textureTile[c].lrs=(this.getSetTileSizeLrs(a)>>2)+1;this.textureTile[c].lrt=(this.getSetTileSizeLrt(a)>>2)+1;this.textureTile[c].width=this.textureTile[c].lrs-this.textureTile[c].uls;
this.textureTile[c].height=this.textureTile[c].lrt-this.textureTile[c].ult;this.videoLog("TODO: DLParser_SetTileSize")};a.prototype.DLParser_LoadBlock=function(a){var c,e;e=this.getLoadBlockTile(a);this.getLoadBlockUls(a);this.getLoadBlockUlt(a);c=this.getLoadBlockLrs(a)+1;this.getLoadBlockDxt(a);a=c*this.textureTile[e].siz;4096<a&&console.error("LoadBlock is making too large of a transfer. "+a+" bytes");for(c=0;c<a;)this.tmem[c]=this.core.memory.rdramUint8Array[this.texImg.addr+c],c++};a.prototype.DLParser_LoadTile=
function(a){this.videoLog("TODO: DLParser_LoadTile")};a.prototype.DLParser_SetTile=function(a){var c;this.activeTile=c=this.getSetTileTile(a);this.textureTile[c].fmt=this.getSetTileFmt(a);this.textureTile[c].siz=this.getSetTileSiz(a);this.textureTile[c].line=this.getSetTileLine(a);this.textureTile[c].tmem=this.getSetTileTmem(a);this.textureTile[c].pal=this.getSetTilePal(a);this.textureTile[c].cmt=this.getSetTileCmt(a);this.textureTile[c].cms=this.getSetTileCms(a);this.textureTile[c].maskt=this.getSetTileMaskt(a);
this.textureTile[c].masks=this.getSetTileMasks(a);this.textureTile[c].shiftt=this.getSetTileShiftt(a);this.textureTile[c].shifts=this.getSetTileShifts(a);this.videoLog("TODO: DLParser_SetTile")};a.prototype.DLParser_FillRect=function(a){this.videoLog("TODO: DLParser_FillRect")};a.prototype.DLParser_SetFillColor=function(a){this.fillColor=[];this.fillColor.push(this.getSetFillColorR(a)/255);this.fillColor.push(this.getSetFillColorG(a)/255);this.fillColor.push(this.getSetFillColorB(a)/255);this.fillColor.push(this.getSetFillColorA(a)/
255);this.videoLog("TODO: DLParser_SetFillColor")};a.prototype.DLParser_SetFogColor=function(a){this.videoLog("TODO: DLParser_SetFogColor")};a.prototype.DLParser_SetBlendColor=function(a){this.blendColor=[];this.blendColor.push(this.getSetFillColorR(a)/255);this.blendColor.push(this.getSetFillColorG(a)/255);this.blendColor.push(this.getSetFillColorB(a)/255);this.blendColor.push(this.getSetFillColorA(a)/255)};a.prototype.DLParser_SetPrimColor=function(a){this.primColor=[];this.primColor.push(this.getSetPrimColorR(a)/
255);this.primColor.push(this.getSetPrimColorG(a)/255);this.primColor.push(this.getSetPrimColorB(a)/255);this.primColor.push(this.getSetPrimColorA(a)/255);this.videoLog("TODO: DLParser_SetPrimColor")};a.prototype.DLParser_SetEnvColor=function(a){this.envColor=[];this.envColor.push(this.getSetEnvColorR(a)/255);this.envColor.push(this.getSetEnvColorG(a)/255);this.envColor.push(this.getSetEnvColorB(a)/255);this.envColor.push(this.getSetEnvColorA(a)/255);this.videoLog("TODO: DLParser_SetEnvColor")};a.prototype.DLParser_SetZImg=
function(a){this.videoLog("TODO: DLParser_SetZImg")};a.prototype.prepareTriangle=function(a,c,e){(a=this.initVertex(a,this.gRSP.numVertices,!1))&&(a=this.initVertex(c,this.gRSP.numVertices+1,!1));a&&(a=this.initVertex(e,this.gRSP.numVertices+2,!1));a&&(this.gRSP.numVertices+=3);return a};a.prototype.initVertex=function(a,c,e){if(a>=consts.MAX_VERTS)return!1;c=3*this.triangleVertexPositionBuffer.numItems;this.triVertices[c]=this.N64VertexList[a].x;this.triVertices[c+1]=this.N64VertexList[a].y;this.triVertices[c+
2]=this.N64VertexList[a].z-2;this.triangleVertexPositionBuffer.numItems+=1;c=this.triangleVertexColorBuffer.numItems<<2;this.triColorVertices[c]=this.N64VertexList[a].r|128;this.triColorVertices[c+1]=this.N64VertexList[a].g|128;this.triColorVertices[c+2]=this.N64VertexList[a].b|128;this.triColorVertices[c+3]=this.N64VertexList[a].a;this.triangleVertexColorBuffer.numItems+=1;c=this.triangleVertexTextureCoordBuffer.numItems<<1;this.triTextureCoords[c]=this.N64VertexList[a].s;this.triTextureCoords[c+
1]=this.N64VertexList[a].t;this.triangleVertexTextureCoordBuffer.numItems+=1;return!0};a.prototype.drawScene=function(a,c){var e,d,g;this.gl.useProgram(this.core.webGL.shaderProgram);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.enable(this.gl.BLEND);this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);0<this.triangleVertexPositionBuffer.numItems&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexPositionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,
this.triVertices.subarray(0,4*this.triangleVertexPositionBuffer.numItems*this.triangleVertexPositionBuffer.itemSize),this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.core.webGL.shaderProgram.vertexPositionAttribute),this.gl.vertexAttribPointer(this.core.webGL.shaderProgram.vertexPositionAttribute,this.triangleVertexPositionBuffer.itemSize,this.gl.FLOAT,!1,0,0));0<this.triangleVertexColorBuffer.numItems&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexColorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,
this.triColorVertices.subarray(0,this.triangleVertexColorBuffer.numItems*this.triangleVertexColorBuffer.itemSize),this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.core.webGL.shaderProgram.vertexColorAttribute),this.gl.vertexAttribPointer(this.core.webGL.shaderProgram.vertexColorAttribute,this.triangleVertexColorBuffer.itemSize,this.gl.UNSIGNED_BYTE,!0,0,0));0<this.triangleVertexTextureCoordBuffer.numItems&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexTextureCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,
this.triTextureCoords.subarray(0,4*this.triangleVertexTextureCoordBuffer.numItems*this.triangleVertexTextureCoordBuffer.itemSize),this.gl.STATIC_DRAW),this.gl.enableVertexAttribArray(this.core.webGL.shaderProgram.textureCoordAttribute),this.gl.vertexAttribPointer(this.core.webGL.shaderProgram.textureCoordAttribute,this.triangleVertexTextureCoordBuffer.itemSize,this.gl.FLOAT,!1,0,0),g=this.textureTile[this.activeTile],d=this.pow2roundup(g.width),e=this.pow2roundup(g.height),d=this.renderer.formatTexture(g,
this.tmem,d,e),e=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,g.width,g.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,d),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.uniform1i(this.core.webGL.shaderProgram.samplerUniform,e));0<this.primColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uPrimColor,
this.primColor);0<this.fillColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uFillColor,this.fillColor);0<this.envColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uEnvColor,this.envColor);0<this.blendColor.length&&this.gl.uniform4fv(this.core.webGL.shaderProgram.uBlendColor,this.blendColor);this.gl.uniform1i(this.core.webGL.shaderProgram.otherModeL,this.otherModeL);this.gl.uniform1i(this.core.webGL.shaderProgram.otherModeH,this.otherModeH);this.core.webGL.setCombineUniforms(this.core.webGL.shaderProgram);
this.gl.uniform1i(this.core.webGL.shaderProgram.wireframeUniform,this.core.settings.wireframe?1:0);this.gl.uniformMatrix4fv(this.core.webGL.shaderProgram.pMatrixUniform,!1,this.gRSP.projectionMtxs[this.gRSP.projectionMtxTop]);this.gl.uniformMatrix4fv(this.core.webGL.shaderProgram.mvMatrixUniform,!1,this.gRSP.modelviewMtxs[this.gRSP.modelViewMtxTop]);0<this.triangleVertexPositionBuffer.numItems&&(!0===this.core.settings.wireframe?this.gl.drawArrays(this.gl.LINES,0,this.triangleVertexPositionBuffer.numItems):
this.gl.drawArrays(this.gl.TRIANGLES,0,this.triangleVertexPositionBuffer.numItems));this.resetState()};a.prototype.resetState=function(){this.triangleVertexPositionBuffer.numItems=0;this.triangleVertexColorBuffer.numItems=0;this.triangleVertexTextureCoordBuffer.numItems=0};return a.prototype.initBuffers=function(){this.triangleVertexPositionBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexPositionBuffer);this.triangleVertexPositionBuffer.itemSize=3;this.triangleVertexPositionBuffer.numItems=
0;this.triangleVertexColorBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexColorBuffer);this.triangleVertexColorBuffer.itemSize=4;this.triangleVertexColorBuffer.numItems=0;this.triangleVertexTextureCoordBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.triangleVertexTextureCoordBuffer);this.triangleVertexTextureCoordBuffer.itemSize=2;this.triangleVertexTextureCoordBuffer.numItems=0}})();("undefined"!==typeof exports&&null!==exports?
exports:this).C1964jsVideoHLE=a}).call(this);(function(){C1964jsVideoHLE.prototype.getGbi0MoveWordType=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&255};C1964jsVideoHLE.prototype.getGbi0MoveWordOffset=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>8&65535};C1964jsVideoHLE.prototype.getGbi0MoveWordValue=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)};C1964jsVideoHLE.prototype.getGbi0DlistParam=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a)>>>16&255};C1964jsVideoHLE.prototype.getGbi0DlistAddr=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)};C1964jsVideoHLE.prototype.getCommand=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>24&255};C1964jsVideoHLE.prototype.getGbi0Tri1V2=function(a){return this.core.memory.rdramUint8Array[a+7]};C1964jsVideoHLE.prototype.getGbi0Tri1V1=function(a){return this.core.memory.rdramUint8Array[a+6]};C1964jsVideoHLE.prototype.getGbi0Tri1V0=
function(a){return this.core.memory.rdramUint8Array[a+5]};C1964jsVideoHLE.prototype.getGbi0Tri1Flag=function(a){return this.core.memory.rdramUint8Array[a+4]};C1964jsVideoHLE.prototype.getGbi0NumVertices=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>20&15};C1964jsVideoHLE.prototype.getGbi0Vertex0=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>16&15};C1964jsVideoHLE.prototype.getFiddledVertexX=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a)>>16};C1964jsVideoHLE.prototype.getFiddledVertexY=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)<<16>>16};C1964jsVideoHLE.prototype.getFiddledVertexZ=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>16};C1964jsVideoHLE.prototype.getVertexX=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>16};C1964jsVideoHLE.prototype.getVertexY=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a)<<16>>16};C1964jsVideoHLE.prototype.getVertexZ=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>16};C1964jsVideoHLE.prototype.getVertexS=function(a){return(this.core.memory.rdramUint8Array[a+8]<<8|this.core.memory.rdramUint8Array[a+9])<<16>>16};C1964jsVideoHLE.prototype.getVertexT=function(a){return(this.core.memory.rdramUint8Array[a+10]<<8|this.core.memory.rdramUint8Array[a+11])<<16>>16};C1964jsVideoHLE.prototype.getVertexColorR=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+12)>>>24};C1964jsVideoHLE.prototype.getVertexColorG=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+12)<<8>>>24};C1964jsVideoHLE.prototype.getVertexColorB=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+12)<<16>>>24};C1964jsVideoHLE.prototype.getVertexAlpha=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+12)<<24>>>24};C1964jsVideoHLE.prototype.getVertexNormalX=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+12)>>24};C1964jsVideoHLE.prototype.getVertexNormalY=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+12)>>16&255};C1964jsVideoHLE.prototype.getVertexNormalZ=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+12)>>8&255};C1964jsVideoHLE.prototype.toSByte=function(a){return 127<a?a-256:a};C1964jsVideoHLE.prototype.getTextureLevel=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>11&7};C1964jsVideoHLE.prototype.getTextureTile=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>8&7};C1964jsVideoHLE.prototype.getTextureOn=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&15};C1964jsVideoHLE.prototype.getTextureScaleS=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>16&65535};C1964jsVideoHLE.prototype.getTextureScaleT=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)&65535};C1964jsVideoHLE.prototype.getCombineA0=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>20&15};C1964jsVideoHLE.prototype.getCombineB0=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>28&15};C1964jsVideoHLE.prototype.getCombineC0=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>15&31};C1964jsVideoHLE.prototype.getCombineD0=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>15&7};C1964jsVideoHLE.prototype.getCombineA0a=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>12&7};C1964jsVideoHLE.prototype.getCombineB0a=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>12&7};C1964jsVideoHLE.prototype.getCombineC0a=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>9&7};C1964jsVideoHLE.prototype.getCombineD0a=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>9&7};C1964jsVideoHLE.prototype.getCombineA1=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>5&15};C1964jsVideoHLE.prototype.getCombineB1=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>24&15};C1964jsVideoHLE.prototype.getCombineC1=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&31};C1964jsVideoHLE.prototype.getCombineD1=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>6&7};C1964jsVideoHLE.prototype.getCombineA1a=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>21&7};C1964jsVideoHLE.prototype.getCombineB1a=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>3&7};C1964jsVideoHLE.prototype.getCombineC1a=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>18&7};C1964jsVideoHLE.prototype.getCombineD1a=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)&7};C1964jsVideoHLE.prototype.gbi0isProjectionMatrix=
function(a){return 0!==(this.core.memory.rdramUint8Array[a+1]&1)?!0:!1};C1964jsVideoHLE.prototype.gbi0LoadMatrix=function(a){return 0!==(this.core.memory.rdramUint8Array[a+1]&2)?!0:!1};C1964jsVideoHLE.prototype.gbi0PushMatrix=function(a){return 0!==(this.core.memory.rdramUint8Array[a+1]&4)?!0:!1};C1964jsVideoHLE.prototype.getTexRectXh=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>12&4095};C1964jsVideoHLE.prototype.getTexRectYh=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a)&4095};C1964jsVideoHLE.prototype.getTexRectTileNo=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>>24&7};C1964jsVideoHLE.prototype.getTexRectXl=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>>12&4095};C1964jsVideoHLE.prototype.getTexRectYl=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)&4095};C1964jsVideoHLE.prototype.getTexRectS=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+12)>>>16&65535};C1964jsVideoHLE.prototype.getTexRectT=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+12)&65535};C1964jsVideoHLE.prototype.getTexRectDsDx=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+20)>>>16&65535};C1964jsVideoHLE.prototype.getTexRectDtDy=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+20)&65535};C1964jsVideoHLE.prototype.getGbi1Type=function(a){};C1964jsVideoHLE.prototype.getGbi1Length=
function(a){};C1964jsVideoHLE.prototype.getGbi1RspSegmentAddr=function(a){};C1964jsVideoHLE.prototype.getRspSegmentAddr=function(a){return this.segments[a>>24&15]+(a&16777215)};C1964jsVideoHLE.prototype.getOtherModeL=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&255};C1964jsVideoHLE.prototype.getOtherModeH=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array+4,a)&255};C1964jsVideoHLE.prototype.getTImgWidth=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a)&4095};C1964jsVideoHLE.prototype.getTImgSize=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>19&3};C1964jsVideoHLE.prototype.getTImgFormat=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>21&7};C1964jsVideoHLE.prototype.getTImgAddr=function(a){a=this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4);return this.getRspSegmentAddr(a)};C1964jsVideoHLE.prototype.getSetTileFmt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a)>>21&7};C1964jsVideoHLE.prototype.getSetTileSiz=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>19&3};C1964jsVideoHLE.prototype.getSetTileLine=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>9&511};C1964jsVideoHLE.prototype.getSetTileTmem=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&511};C1964jsVideoHLE.prototype.getSetTileTile=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)>>24&7};C1964jsVideoHLE.prototype.getSetTilePal=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>20&15};C1964jsVideoHLE.prototype.getSetTileCmt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>18&3};C1964jsVideoHLE.prototype.getSetTileMaskt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>14&15};C1964jsVideoHLE.prototype.getSetTileShiftt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)>>10&15};C1964jsVideoHLE.prototype.getSetTileCms=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>8&3};C1964jsVideoHLE.prototype.getSetTileMasks=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>4&15};C1964jsVideoHLE.prototype.getSetTileShifts=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)&15};C1964jsVideoHLE.prototype.getLoadBlockTile=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)>>24&7};C1964jsVideoHLE.prototype.getLoadBlockUls=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>12&4095};C1964jsVideoHLE.prototype.getLoadBlockUlt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&4095};C1964jsVideoHLE.prototype.getLoadBlockLrs=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>12&4095};C1964jsVideoHLE.prototype.getLoadBlockDxt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)&4095};C1964jsVideoHLE.prototype.getSetTileSizeTile=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>24&7};C1964jsVideoHLE.prototype.getSetTileSizeUls=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>12&4095};C1964jsVideoHLE.prototype.getSetTileSizeUlt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&4095};C1964jsVideoHLE.prototype.getSetTileSizeLrs=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)>>12&4095};C1964jsVideoHLE.prototype.getSetTileSizeLrt=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)&4095};C1964jsVideoHLE.prototype.getSetPrimColorM=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)>>>8&255};C1964jsVideoHLE.prototype.getSetPrimColorL=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a)&255};C1964jsVideoHLE.prototype.getSetPrimColorR=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)>>>24};C1964jsVideoHLE.prototype.getSetPrimColorG=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<8>>>24};C1964jsVideoHLE.prototype.getSetPrimColorB=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<16>>>24};C1964jsVideoHLE.prototype.getSetPrimColorA=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<24>>>24};C1964jsVideoHLE.prototype.getSetGeometryMode=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,
a+4)};C1964jsVideoHLE.prototype.getClearGeometryMode=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)};C1964jsVideoHLE.prototype.pow2roundup=function(a){var b;for(b=1;b<a;)b<<=1;return b};C1964jsVideoHLE.prototype.getSetFillColorR=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>>24};C1964jsVideoHLE.prototype.getSetFillColorG=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<8>>>24};C1964jsVideoHLE.prototype.getSetFillColorB=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<16>>>24};C1964jsVideoHLE.prototype.getSetFillColorA=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<24>>>24};C1964jsVideoHLE.prototype.getSetEnvColorR=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)>>>24};C1964jsVideoHLE.prototype.getSetEnvColorG=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<8>>>24};C1964jsVideoHLE.prototype.getSetEnvColorB=
function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<16>>>24};C1964jsVideoHLE.prototype.getSetEnvColorA=function(a){return this.core.memory.getInt32(this.core.memory.rdramUint8Array,a+4)<<24>>>24};C1964jsVideoHLE.prototype.microcodeMap0="RSP_GBI1_SpNoop RSP_GBI0_Mtx RSP_GBI1_Reserved RSP_GBI1_MoveMem RSP_GBI0_Vtx RSP_GBI1_Reserved RSP_GBI0_DL RSP_GBI1_Reserved RSP_GBI1_Reserved RSP_GBI0_Sprite2DBase RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_GBI0_Tri4 RSP_GBI1_RDPHalf_Cont RSP_GBI1_RDPHalf_2 RSP_GBI1_RDPHalf_1 RSP_GBI1_Line3D RSP_GBI1_ClearGeometryMode RSP_GBI1_SetGeometryMode RSP_GBI1_EndDL RSP_GBI1_SetOtherModeL RSP_GBI1_SetOtherModeH RSP_GBI1_Texture RSP_GBI1_MoveWord RSP_GBI1_PopMtx RSP_GBI1_CullDL RSP_GBI1_Tri1 RSP_GBI1_Noop RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RDP_TriFill RDP_TriFillZ RDP_TriTxtr RDP_TriTxtrZ RDP_TriShade RDP_TriShadeZ RDP_TriShadeTxtr RDP_TriShadeTxtrZ RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing RSP_RDP_Nothing DLParser_TexRect DLParser_TexRectFlip DLParser_RDPLoadSynch DLParser_RDPPipeSynch DLParser_RDPTileSynch DLParser_RDPFullSynch DLParser_SetKeyGB DLParser_SetKeyR DLParser_SetConvert DLParser_SetScissor DLParser_SetPrimDepth DLParser_RDPSetOtherMode DLParser_LoadTLut RSP_RDP_Nothing DLParser_SetTileSize DLParser_LoadBlock DLParser_LoadTile DLParser_SetTile DLParser_FillRect DLParser_SetFillColor DLParser_SetFogColor DLParser_SetBlendColor DLParser_SetPrimColor DLParser_SetEnvColor DLParser_SetCombine DLParser_SetTImg DLParser_SetZImg DLParser_SetCImg".split(" ")}).call(this);(function(){var a;a=function(a,c){this.gl=void 0;this.core=a;this.webGLStart(c);return this};(function(){var b,c,e,d;c=d=e=void 0;b=mat4.create();c=[];d=mat4.create();e=mat4.create();a.prototype.initGL=function(a){try{log("canvas = "+a),log("canvas.getContext = "+a.getContext),this.gl=a.getContext("webgl")||a.getContext("moz-webgl")||a.getContext("webkit-3d")||a.getContext("experimental-webgl"),log("gl = "+this.gl),this.gl.viewportWidth=a.width,log("this.gl.viewportWidth = "+this.gl.viewportWidth),
this.gl.viewportHeight=a.height,log("this.gl.viewportHeight = "+this.gl.viewportHeight)}catch(b){}this.gl||log("Could not initialise WebGL. Your browser may not support it.")};a.prototype.loadFile=function(a,b,d,c){var e;e=new XMLHttpRequest;e.open("GET",a,!1);e.onreadystatechange=function(){4===e.readyState&&(200===e.status?d(e.responseText,b):c(a))};e.send(null)};a.prototype.loadFiles=function(a,b,d){var c,e,l,n,p;l=a.length;e=0;p=[];n=function(a,d){p[d]=a;e+=1;e===l&&b(p)};for(c=0;c<l;)this.loadFile(a[c],
c,n,d),c++};a.prototype.initShaders=function(a,b){var d,c,e,l=this;d=e=c=void 0;this.loadFiles(["shaders/"+a,"shaders/"+b],function(c){e=l.gl.createShader(l.gl.VERTEX_SHADER);d=l.gl.createShader(l.gl.FRAGMENT_SHADER);l.gl.shaderSource(d,c[0]);l.gl.shaderSource(e,c[1]);l.gl.compileShader(d);l.gl.compileShader(e);l.gl.getShaderParameter(e,l.gl.COMPILE_STATUS)||alert(b+": "+l.gl.getShaderInfoLog(e));l.gl.getShaderParameter(d,l.gl.COMPILE_STATUS)||alert(l.gl.getShaderInfoLog(a+" "+d))},function(a){alert('Failed to download "'+
a+'"')});c=this.gl.createProgram();this.gl.attachShader(c,e);this.gl.attachShader(c,d);this.gl.linkProgram(c);this.gl.getProgramParameter(c,this.gl.LINK_STATUS)||alert("Could not initialize shaders");this.gl.useProgram(c);c.vertexPositionAttribute=this.gl.getAttribLocation(c,"aVertexPosition");c.vertexColorAttribute=this.gl.getAttribLocation(c,"aVertexColor");c.pMatrixUniform=this.gl.getUniformLocation(c,"uPMatrix");c.mvMatrixUniform=this.gl.getUniformLocation(c,"uMVMatrix");c.nMatrixUniform=this.gl.getUniformLocation(c,
"uNormalMatrix");c.textureCoordAttribute=this.gl.getAttribLocation(c,"aTextureCoord");c.samplerUniform=this.gl.getUniformLocation(c,"uSampler");c.wireframeUniform=this.gl.getUniformLocation(c,"uWireframe");c.uCombineA0=this.gl.getUniformLocation(c,"uCombineA0");c.uCombineB0=this.gl.getUniformLocation(c,"uCombineB0");c.uCombineC0=this.gl.getUniformLocation(c,"uCombineC0");c.uCombineD0=this.gl.getUniformLocation(c,"uCombineD0");c.uCombineA0a=this.gl.getUniformLocation(c,"uCombineA0a");c.uCombineB0a=
this.gl.getUniformLocation(c,"uCombineB0a");c.uCombineC0a=this.gl.getUniformLocation(c,"uCombineC0a");c.uCombineD0a=this.gl.getUniformLocation(c,"uCombineD0a");c.uCombineA1=this.gl.getUniformLocation(c,"uCombineA1");c.uCombineB1=this.gl.getUniformLocation(c,"uCombineB1");c.uCombineC1=this.gl.getUniformLocation(c,"uCombineC1");c.uCombineD1=this.gl.getUniformLocation(c,"uCombineD1");c.uCombineA1a=this.gl.getUniformLocation(c,"uCombineA1a");c.uCombineB1a=this.gl.getUniformLocation(c,"uCombineB1a");c.uCombineC1a=
this.gl.getUniformLocation(c,"uCombineC1a");c.uCombineD1a=this.gl.getUniformLocation(c,"uCombineD1a");c.uPrimColor=this.gl.getUniformLocation(c,"uPrimColor");c.uFillColor=this.gl.getUniformLocation(c,"uFillColor");c.uEnvColor=this.gl.getUniformLocation(c,"uEnvColor");c.uBlendColor=this.gl.getUniformLocation(c,"uBlendColor");c.otherModeL=this.gl.getUniformLocation(c,"otherModeL");c.otherModeH=this.gl.getUniformLocation(c,"otherModeH");return c};a.prototype.setCombineUniforms=function(a){var b;b=this.core.videoHLE;
this.gl.uniform1i(a.uCombineA0,b.combineA0);this.gl.uniform1i(a.uCombineB0,b.combineB0);this.gl.uniform1i(a.uCombineC0,b.combineC0);this.gl.uniform1i(a.uCombineD0,b.combineD0);this.gl.uniform1i(a.uCombineA0a,b.combineA0a);this.gl.uniform1i(a.uCombineB0a,b.combineB0a);this.gl.uniform1i(a.uCombineC0a,b.combineC0a);this.gl.uniform1i(a.uCombineD0a,b.combineD0a);this.gl.uniform1i(a.uCombineA1,b.combineA1);this.gl.uniform1i(a.uCombineB1,b.combineB1);this.gl.uniform1i(a.uCombineC1,b.combineC1);this.gl.uniform1i(a.uCombineD1,
b.combineD1);this.gl.uniform1i(a.uCombineA1a,b.combineA1a);this.gl.uniform1i(a.uCombineB1a,b.combineB1a);this.gl.uniform1i(a.uCombineC1a,b.combineC1a);this.gl.uniform1i(a.uCombineD1a,b.combineD1a)};a.prototype.beginDList=function(){this.gl.viewport(0,0,this.gl.viewportWidth,this.gl.viewportHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);mat4.perspective(45,this.gl.viewportWidth/this.gl.viewportHeight,0.1,100,d);mat4.identity(b);mat4.translate(b,[0,0,-2.4]);mat4.set(b,e);mat4.inverse(e,
e);mat4.transpose(e);mat4.translate(b,[0,0,-1])};a.prototype.setMatrixUniforms=function(a){this.gl.uniformMatrix4fv(a.pMatrixUniform,!1,d);this.gl.uniformMatrix4fv(a.mvMatrixUniform,!1,b);this.gl.uniformMatrix4fv(a.nMatrixUniform,!1,e)};a.prototype.mvPushMatrix=function(){var a;a=mat4.create();mat4.set(b,a);c.push(a)};a.prototype.mvPopMatrix=function(){if(0===c.length)throw Error("Invalid popMatrix!");b=c.pop()};a.prototype.webGLStart=function(a){a=document.getElementById("Canvas3D");this.initGL(a);
this.shaderProgram=this.initShaders("fragment.shader","vertex.shader");this.gl&&this.gl.clearColor(0,0,0,1);a.style.visibility="hidden"};a.prototype.show3D=function(){document.getElementById("Canvas3D").style.visibility="visible"};return a.prototype.hide3D=function(){document.getElementById("Canvas3D").style.visibility="hidden"}})();("undefined"!==typeof exports&&null!==exports?exports:this).C1964jsWebGL=a}).call(this);var bitjs=bitjs||{};bitjs.io=bitjs.io||{};
(function(){bitjs.BIT=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768];var a=[0,1,3,7,15,31,63,127,255];bitjs.io.BitStream=function(a,c,e,d){if(!a||!a.toString||"[object ArrayBuffer]"!==a.toString())throw"Error! BitArray constructed with an invalid ArrayBuffer object";this.bytes=new Uint8Array(a,e||0,d||a.byteLength);this.bitPtr=this.bytePtr=0;this.peekBits=c?this.peekBits_rtl:this.peekBits_ltr};bitjs.io.BitStream.prototype.peekBits_ltr=function(b,c){if(0>=b||"number"!=typeof b)return 0;
for(var e=this.bytePtr,d=this.bitPtr,g=0,f=0,h=this.bytes;0<b;){if(e>=h.length)throw"Error!  Overflowed the bit stream! n="+b+", bytePtr="+e+", bytes.length="+h.length+", bitPtr="+d;var k=8-d;if(b>=k){var m=a[k]<<d,g=g|(h[e]&m)>>d<<f;e++;d=0;f+=k;b-=k}else m=a[b]<<d,g|=(h[e]&m)>>d<<f,d+=b,f+=b,b=0}c&&(this.bitPtr=d,this.bytePtr=e);return g};bitjs.io.BitStream.prototype.peekBits_rtl=function(b,c){if(0>=b||"number"!=typeof b)return 0;for(var e=this.bytePtr,d=this.bitPtr,g=0,f=this.bytes;0<b;){if(e>=
f.length)throw"Error!  Overflowed the bit stream! n="+b+", bytePtr="+e+", bytes.length="+f.length+", bitPtr="+d;var h=8-d;b>=h?(g<<=h,g|=a[h]&f[e],e++,d=0,b-=h):(g<<=b,g|=(f[e]&a[b]<<8-b-d)>>8-b-d,d+=b,b=0)}c&&(this.bitPtr=d,this.bytePtr=e);return g};bitjs.io.BitStream.prototype.getBits=function(){return((this.bytes[this.bytePtr]&255)<<16)+((this.bytes[this.bytePtr+1]&255)<<8)+(this.bytes[this.bytePtr+2]&255)>>>8-this.bitPtr&65535};bitjs.io.BitStream.prototype.readBits=function(a){return this.peekBits(a,
!0)};bitjs.io.BitStream.prototype.peekBytes=function(a,c){if(0>=a||"number"!=typeof a)return 0;for(;0!=this.bitPtr;)this.readBits(1);c=c||!1;var e=this.bytePtr,e=this.bytes.subarray(e,e+a);c&&(this.bytePtr+=a);return e};bitjs.io.BitStream.prototype.readBytes=function(a){return this.peekBytes(a,!0)};bitjs.io.ByteStream=function(a,c,e){this.bytes=new Uint8Array(a,c||0,e||a.byteLength);this.ptr=0};bitjs.io.ByteStream.prototype.peekNumber=function(a){if(0>=a||"number"!=typeof a)return-1;var c=0;for(a=
this.ptr+a-1;a>=this.ptr;)c<<=8,c|=this.bytes[a],--a;return c};bitjs.io.ByteStream.prototype.readNumber=function(a){var c=this.peekNumber(a);this.ptr+=a;return c};bitjs.io.ByteStream.prototype.peekBytes=function(a,c){if(0>=a||"number"!=typeof a)return 0;var e=this.bytes.subarray(this.ptr,this.ptr+a);c&&(this.ptr+=a);return e};bitjs.io.ByteStream.prototype.readBytes=function(a){return this.peekBytes(a,!0)};bitjs.io.ByteStream.prototype.peekString=function(a){if(0>=a||"number"!=typeof a)return 0;var c=
"",e=this.ptr;for(a=this.ptr+a;e<a;++e)c+=String.fromCharCode(this.bytes[e]);return c};bitjs.io.ByteStream.prototype.readString=function(a){var c=this.peekString(a);this.ptr+=a;return c};bitjs.io.ByteBuffer=function(a){if("number"!=typeof a||0>=a)throw"Error! ByteBuffer initialized with '"+a+"'";this.data=new Uint8Array(a);this.ptr=0};bitjs.io.ByteBuffer.prototype.insertByte=function(a){this.data[this.ptr++]=a};bitjs.io.ByteBuffer.prototype.insertBytes=function(a){this.data.set(a,this.ptr);this.ptr+=
a.length}})();bitjs=bitjs||{};bitjs.archive=bitjs.archive||{};
(function(){bitjs.base=function(a,b,c){var e=arguments.callee.caller;if(e.superClass_)return e.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var d=Array.prototype.slice.call(arguments,2),g=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===e)g=!0;else if(g)return f.prototype[b].apply(a,d);if(a[b]===e)return a.constructor.prototype[b].apply(a,d);throw Error("goog.base called from a method of one name to a method of a different name");};
bitjs.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};bitjs.archive.UnarchiveEvent=function(a){this.type=a};bitjs.archive.UnarchiveEvent.Type={START:"start",PROGRESS:"progress",EXTRACT:"extract",FINISH:"finish",INFO:"info",ERROR:"error"};bitjs.archive.UnarchiveInfoEvent=function(a){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.INFO);this.msg=a};bitjs.inherits(bitjs.archive.UnarchiveInfoEvent,bitjs.archive.UnarchiveEvent);
bitjs.archive.UnarchiveErrorEvent=function(a){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.ERROR);this.msg=a};bitjs.inherits(bitjs.archive.UnarchiveErrorEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveStartEvent=function(){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.START)};bitjs.inherits(bitjs.archive.UnarchiveStartEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveFinishEvent=function(){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.FINISH)};bitjs.inherits(bitjs.archive.UnarchiveFinishEvent,
bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveProgressEvent=function(a,b,c,e,d,g){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.PROGRESS);this.currentFilename=a;this.currentFileNumber=b;this.currentBytesUnarchivedInFile=c;this.totalFilesInArchive=g;this.currentBytesUnarchived=e;this.totalUncompressedBytesInArchive=d};bitjs.inherits(bitjs.archive.UnarchiveProgressEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.UnarchiveExtractEvent=function(a){bitjs.base(this,bitjs.archive.UnarchiveEvent.Type.EXTRACT);
this.unarchivedFile=a};bitjs.inherits(bitjs.archive.UnarchiveExtractEvent,bitjs.archive.UnarchiveEvent);bitjs.archive.Unarchiver=function(a,b){this.ab=a;this.pathToBitJS_=b||"";this.listeners_={};for(var c in bitjs.archive.UnarchiveEvent.Type)this.listeners_[bitjs.archive.UnarchiveEvent.Type[c]]=[]};bitjs.archive.Unarchiver.prototype.worker_=null;bitjs.archive.Unarchiver.prototype.getScriptFileName=function(){throw"Subclasses of AbstractUnarchiver must overload getScriptFileName()";};bitjs.archive.Unarchiver.prototype.addEventListener=
function(a,b){a in this.listeners_&&-1==this.listeners_[a].indexOf(b)&&this.listeners_[a].push(b)};bitjs.archive.Unarchiver.prototype.removeEventListener=function(a,b){if(a in this.listeners_){var c=this.listeners_[a].indexOf(b);-1!=c&&this.listeners_[a].splice(c,1)}};bitjs.archive.Unarchiver.prototype.handleWorkerEvent_=function(a){(a instanceof bitjs.archive.UnarchiveEvent||a.type)&&this.listeners_[a.type]instanceof Array?this.listeners_[a.type].forEach(function(b){b(a)}):console.log(a)};bitjs.archive.Unarchiver.prototype.start=
function(){var a=this,b=this.pathToBitJS_+this.getScriptFileName();b&&(this.worker_=new Worker(b),this.worker_.onerror=function(a){console.log("Worker error: message = "+a.message);throw a;},this.worker_.onmessage=function(b){"string"==typeof b.data?console.log(b.data):a.handleWorkerEvent_(b.data)},this.worker_.postMessage({file:this.ab}))};bitjs.archive.Unzipper=function(a,b){bitjs.base(this,a,b)};bitjs.inherits(bitjs.archive.Unzipper,bitjs.archive.Unarchiver);bitjs.archive.Unzipper.prototype.getScriptFileName=
function(){return"unzip.min.js"};bitjs.archive.Unrarrer=function(a,b){bitjs.base(this,a,b)};bitjs.inherits(bitjs.archive.Unrarrer,bitjs.archive.Unarchiver);bitjs.archive.Unrarrer.prototype.getScriptFileName=function(){return"unrar.js"};bitjs.archive.Untarrer=function(a,b){bitjs.base(this,a,b)};bitjs.inherits(bitjs.archive.Untarrer,bitjs.archive.Unarchiver);bitjs.archive.Untarrer.prototype.getScriptFileName=function(){return"untar.js"}})();(function(){var a,b,c,e,d,g,f,h;g=c=void 0;this.progress=document.querySelector(".percent");a="";window.File?window.FileReader?window.FileList?window.Blob||(alertMessge+=" window.Blob"):a+=" window.FileList":a+=" window.FileReader":a+=" window.File";0<a.length&&log("Unsupported in this browser: "+a);this.i1964js=void 0;e=function(){var a,b,c,d;d=[];b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(c=0;c<b.length;)a=b[c].split("="),d.push(a[0]),d[a[0]]=unescape(a[1]),
c++;return d};d=function(a){try{void 0!==this.i1964js&&null!=this.i1964js&&this.i1964js.stopEmulatorAndCleanup(),this.i1964js=new C1964jsEmulator(c),this.i1964js.init(a)}catch(b){throw void 0!==this.i1964js&&null!=this.i1964js&&(this.i1964js.terminate=!0),b;}};f=function(a,b){var c,e;"zip"!==a.split(".").pop().toLowerCase()?(c=new Uint8Array(b),this.romLength=c.byteLength,d(c)):(e=new bitjs.archive.Unzipper(b,"lib/bitjs/"),e.addEventListener(bitjs.archive.UnarchiveEvent.Type.EXTRACT,function(a){if(a.unarchivedFile)return console.log("extracted: "+
a.unarchivedFile.filename),c=new Uint8Array(a.unarchivedFile.fileData),this.romLength=c.byteLength,d(c)}),e.addEventListener(bitjs.archive.UnarchiveEvent.Type.INFO,function(a){return console.log("zip info: "+a.msg)}),e.addEventListener(bitjs.archive.UnarchiveEvent.Type.PROGRESS,function(a){}),e.addEventListener(bitjs.archive.UnarchiveEvent.Type.FINISH,function(a){return console.log("finish: "+a.msg)}),e.addEventListener(bitjs.archive.UnarchiveEvent.Type.ERROR,function(a){return console.log("ERROR: "+
a.msg)}),e.start())};this.start1964=function(a){var b,d;c=a;document.getElementById("user_panel").className="show";d=e();b=void 0;for(a=0;a<d.length;)"rom"===d[a]&&(b=d[d[a]]),a++;void 0!==b&&null!=b&&(a=new XMLHttpRequest,a.open("GET",b,!0),a.responseType="arraybuffer",a.send(),a.onload=function(a){return f(b,a.target.response)})};b=function(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case a.target.error.NOT_READABLE_ERR:alert("File is not readable");
break;case a.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}};h=function(a){a.lengthComputable&&(a=Math.round(100*(a.loaded/a.total)),100>a&&void 0!==this.progress&&(this.progress.style.width=a+"%",this.progress.textContent=a+"%"))};document.getElementById("user_panel").onmousemove=function(){return document.getElementById("user_panel").className="show"};document.getElementById("user_panel").ontouchend=function(a){document.getElementById("user_panel").className=
"show";a.cancelBubble=!0;if(a.stopPropagation)return a.stopPropagation()};document.getElementById("user_panel").onmouseup=function(a){a.cancelBubble=!0;if(a.stopPropagation)return a.stopPropagation()};document.onmouseup=function(a){return document.getElementById("user_panel").className=""===document.getElementById("user_panel").className?"show":""};document.ontouchend=function(a){return document.getElementById("user_panel").className=""===document.getElementById("user_panel").className?"show":""};
document.getElementById("files").addEventListener("change",function(a){var c;void 0===a.target.files||void 0===a.target.files[0]||(c=a.target.files[0].name,this.progressBar=document.getElementById("progress_bar"),void 0!==this.progress&&(this.progress.style.width="0%",this.progress.textContent="0%"),g=new FileReader,g.onerror=b,g.onprogress=h,g.onabort=function(a){alert("File read cancelled")},g.onloadstart=function(a){void 0!==this.progressBar&&(document.getElementById("progress_bar").className=
"loading")},g.onload=function(a){void 0!==this.progress&&(this.progress.style.width="100%",this.progress.textContent="100%");void 0!==this.progressBar&&setTimeout("document.getElementById('progress_bar').className='';document.getElementById('user_panel').className='';",1E3);f(c,g.result)},g.readAsArrayBuffer(a.target.files[0]))},!1)}).call(this);
